"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1321],{19870:(e,t,s)=>{function r(e){return t=>void 0!==t?{type:e,payload:t,async:!0}:{type:e,async:!0}}s.d(t,{K:()=>r})},54871:(e,t,s)=>{function r(e){return t=>void 0!==t?{type:e,payload:t}:{type:e}}s.d(t,{mq:()=>r})},65149:(e,t,s)=>{s.d(t,{Q:()=>r});const r=e=>({type:"USER/UPDATE_EMAIL",payload:e,async:!0})},97391:(e,t,s)=>{s.d(t,{Cy:()=>o,D_:()=>a,GW:()=>n,nc:()=>i});var r=s(54871);const a=(0,r.mq)("ANALYTICS/PAGEVIEW"),i=(0,r.mq)("ANALYTICS/TRACK_GOOGLE"),n=(0,r.mq)("ANALYTICS/SET_CONSENT_GRANTED"),o=(0,r.mq)("ANALYTICS/CHANGE_PROJECT_ID")},60068:(e,t,s)=>{s.d(t,{k:()=>a});var r=s(54871);const a=(0,r.mq)("APP/OPEN_URL");(0,r.mq)("APP/RELOAD")},28098:(e,t,s)=>{s.d(t,{z:()=>r.z});var r=s(27414)},46584:(e,t,s)=>{s.d(t,{Dz:()=>a,I5:()=>n,py:()=>i});var r=s(19870);const a=(0,r.K)("ENTITY/FETCH_PROFILE_NO_TYPE"),i=(0,r.K)("ENTITY/FETCH_MULTIPLE"),n=(0,r.K)("ENTITY/FETCH_BY_POINT")},39310:(e,t,s)=>{s.d(t,{B:()=>r});const r=(0,s(19870).K)("REVIEW/FETCH_REVIEWS")},97099:(e,t,s)=>{s.d(t,{o:()=>r});const r=e=>({type:"ENTITY/FETCH_VIDEO_DATA",payload:e,async:!0})},48363:(e,t,s)=>{s.d(t,{Hu:()=>o,K6:()=>n,am:()=>i,fA:()=>a,nV:()=>d,we:()=>c});var r=s(19870);const a=e=>({type:"FEEDBACK/SEND",payload:e,async:!0}),i=(0,r.K)("FEEDBACK/REVIEW_COMPLAINT"),n=e=>({type:"FEEDBACK/PHOTO_COMPLAINT",payload:e,async:!0}),o=e=>({type:"FEEDBACK/SEND_TYPED",payload:e,async:!0}),c=e=>({type:"FEEDBACK/FETCH_USER_FEEDBACKS",payload:e,async:!0}),d=e=>({type:"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT",payload:e,async:!0})},87150:(e,t,s)=>{s.d(t,{O8:()=>r,OE:()=>a,lO:()=>i});const r=e=>({type:"HISTORY/PUSH",payload:e,history:!0}),a=()=>({type:"HISTORY/BACK",history:!0}),i=e=>({type:"HISTORY/REPLACE_STATE",payload:e,history:!0})},28335:(e,t,s)=>{s.d(t,{MX:()=>i,RQ:()=>d,V1:()=>o,X:()=>n,mt:()=>c});var r=s(19870),a=s(54871);const i=(0,r.K)("MARKET/FETCH_PRODUCT_BY_ID"),n=(0,r.K)("MARKET/FETCH_CATEGORIES_BY_BRANCH"),o=(0,r.K)("MARKET/FETCH_BRANCH_PRODUCTS"),c=((0,r.K)("MARKET/FETCH_OFFERS"),(0,r.K)("MARKET/FETCH_SUGGESTIONS")),d=(0,a.mq)("MARKET/DROP_SUGGESTIONS")},61246:(e,t,s)=>{s.d(t,{E:()=>r});const r=(0,s(19870).K)("SEARCH_HISTORY/CLEAR_SEARCH_HISTORY")},8469:(e,t,s)=>{s.d(t,{HV:()=>n,R:()=>i,TU:()=>a,k8:()=>o});var r=s(54871);const a=e=>({type:"REGION/FETCH",payload:e,async:!0}),i=e=>({type:"REGION/DETECT",payload:e,async:!0}),n=()=>({type:"REGION/CLEAR_DETECTOR"}),o=(0,r.mq)("REGION/SET_DETECTOR")},33044:(e,t,s)=>{s.d(t,{I:()=>r});const r=e=>({type:"SEARCH/FETCH_PROVIDERS",payload:e,async:!0})},9685:(e,t,s)=>{s.d(t,{I:()=>a,Y:()=>r});const r=e=>({type:"SEARCH/FETCH_FILIALS",payload:e,async:!0}),a=e=>({type:"SEARCH/FETCH_FILIALS_FILTERS",payload:e,async:!0})},25394:(e,t,s)=>{s.d(t,{Z:()=>a,a:()=>i});var r=s(19870);const a=(0,r.K)("SEARCH/BY_BUILDING_ID"),i=(0,r.K)("SEARCH/IN_BUILDING_BY_QUERY")},1109:(e,t,s)=>{s.d(t,{r:()=>r});const r=e=>({type:"SEARCH/FETCH_MAINTAINERS",payload:e,async:!0})},24024:(e,t,s)=>{s.d(t,{Hq:()=>r,a$:()=>n,fE:()=>i,l1:()=>a});const r=(0,s(19870).K)("SEARCH/FETCH_QUERY"),a=e=>({type:"SEARCH/FETCH_RUBRIC",payload:e,async:!0}),i=e=>({type:"SEARCH/FETCH_ATTRIBUTE",payload:e,async:!0}),n=e=>({type:"SEARCH/FETCH_FILTERS",payload:e,async:!0})},99788:(e,t,s)=>{s.d(t,{DF:()=>r,ej:()=>a});const r=(0,s(19870).K)("SEARCH/FETCH_OBJECT_SUGGESTIONS"),a=()=>({type:"SEARCH/CROP_SUGGESTION"})},54947:(e,t,s)=>{s.d(t,{T:()=>i});var r=s(19870),a=s(54871);(0,r.K)("SEO_STORE/FETCH");const i=(0,a.mq)("SEO_STORE/CLEAR_MINI_TEXT")},16098:(e,t,s)=>{s.d(t,{Tj:()=>c,hL:()=>i,l6:()=>n,nc:()=>o,wI:()=>a});var r=s(54871);const a=e=>({type:"USER/SET_PARAMS",payload:e}),i=e=>({type:"USER/FOLLOW_LOCATION",payload:e}),n=e=>({type:"USER/SET_LOCATION",payload:e}),o=e=>({type:"USER/SET_WINDOW_SIZE",payload:e}),c=((0,r.mq)("USER/SET_STAT_HASH"),(0,r.mq)("USER/SET_3D_MAP_ENABLED_STATUS"))},78444:(e,t,s)=>{s.d(t,{mn:()=>i,q_:()=>a,zA:()=>n});var r=s(54871);const a=(0,r.mq)("TIME/SET"),i=(0,r.mq)("TIME/SET_DELTA"),n=(0,r.mq)("TIME/SET_TIMEZONE")},67368:(e,t,s)=>{s.d(t,{EC:()=>i,Fd:()=>h,Hg:()=>o,Wj:()=>d,cE:()=>n,cZ:()=>p,ck:()=>g,kR:()=>u,ks:()=>l,tF:()=>c});var r=s(19870),a=s(54871);const i=e=>({type:"USER/CONFIRM_REGISTRATION",payload:e,async:!0}),n=e=>({type:"USER/FETCH_REVIEWS",payload:e,async:!0}),o=(0,r.K)("USER/DELETE_REVIEW"),c=(0,a.mq)("USER/ADD_HISTORY_OBJECT"),d=(0,a.mq)("USER/ADD_HISTORY_SEARCH"),u=(0,r.K)("USER/SAVE_HISTORY"),l=(0,r.K)("USER/LOAD_HISTORY"),p=(0,r.K)("USER/CLEAR_HISTORY"),h=(0,a.mq)("USER/ACTIVATE_MY_GEOLOCATION"),g=(0,a.mq)("USER/DEACTIVATE_MY_GEOLOCATION");(0,a.mq)("USER/CLEAR_DEVICES")},51113:(e,t,s)=>{s.d(t,{$c:()=>l,KM:()=>u,f3:()=>d,wN:()=>c});var r=s(51665),a=s(42833),i=s(38361),n=(s(15057),s(86993)),o=s(45537);function c(e,t){return(0,o.xJ)((s=>{const a=(0,r.wj)({state:s,entityId:e.entityId,searchId:e.searchId});return t(a,s)}))}function d(e,t){return(0,o.xJ)((s=>{const r=(0,a.Tt)({state:s,id:e});return t(r,s)}))}function u(e,t){return(0,o.xJ)((s=>{const r=(0,i.h)({state:s,id:e});return t(r,s)}))}function l(e,t){return(0,o.xJ)((s=>{const r=(0,n.m)({state:s,statusId:e});return t(r)}))}},759:(e,t,s)=>{s.d(t,{Qt:()=>r});const r={unclassified:0,recovery:1,discovery:2,geo:3,transport:7,orgExtension:9,discovery_without_rubric:9,fictive:19};var a,i;!function(e){e[e.Bc=1]="Bc",e[e.Imp=2]="Imp",e[e.Search=3]="Search",e[e.Launch=5]="Launch",e[e.Video=9]="Video",e[e.Commercial=14]="Commercial"}(a||(a={})),function(e){e.Start="start",e.Replay="replay",e.Finish="finish",e.Close="close"}(i||(i={}))},88240:(e,t,s)=>{s.d(t,{GM:()=>r,u9:()=>i,zc:()=>n,zs:()=>a});const r=e=>({type:"BSS/TRACK_SHOW",payload:e,bssV3:!0}),a=e=>({type:"BSS/TRACK_ACTION",payload:e,bssV3:!0}),i=e=>({type:"BSS/TRACK_AUDIENCE_COUNTER",payload:e,bssV3:!0}),n=e=>({type:"BSS/DEFER_EVENT_ORDINAL",payload:e,bssV3:!0})},43323:(e,t,s)=>{s.d(t,{D:()=>o});var r=s(15057),a=s(96788),i=s(82603),n=s(25627);function o(e){const{apikey:t,commitIsoDate:s,state:o,eventParams:c,enhancedAttrs:d,deviceLocale:u,tabId:l,abTest:p,clientId:h,isMobileDevice:g,sendPrivacyData:m}=e,f=(0,r.bG)(o);return Object.assign(Object.assign({common:{formatVersion:3,appVersion:(0,n.n)(s),product:h,apikey:t,apikeyStatus:1,deviceLocale:u,user:m?o.session.userId:null,ip:m?o.session.ip:(0,i.d4)(o.session.ip),sessionId:o.session.sessionId,userAgent:o.session.userAgent,authUser:f&&f.data&&f.data.user_id,deviceType:g?"mobile":"desktop",personalDataCollectionAllowed:m},map:d.map,utcOffset:(0,a.k)(o.session.timezone),tabId:l||o.session.tabId,timestamp:(b=o.session.timeDelta,Date.now()+b)},c),{abTest:p&&p.length>0?p:void 0});var b}},26354:(e,t,s)=>{s.d(t,{z:()=>p});var r=s(52322),a=s(2784),i=s(88240),n=s(82603),o=s(93108),c=s(402),d=s(58688),u=s(45537),l=s(27215);function p(e,t,s){return function(p){class h extends a.PureComponent{constructor(t){super(t),this.state={showEventOrdinal:void 0},this.wasMounted=!1,this.refEl=null,this.generateShowEventBssParams=()=>{if(!e)return;const t=(0,n.by)(),s=e(this.props,this.context.store.getState());return s?Object.assign({showEventKey:t},s):void 0},this.enhancedDispatch=t=>{const r=this.context.store.dispatch;if(!e||s&&s.trackActionsRegardlessOfShow)return r(t);if(void 0!==this.state.showEventOrdinal)return r(t);const a=this.generateShowEventBssParams();return a?r((0,u.vP)((0,i.GM)(Object.assign(Object.assign({},a),{autoEvent:!0})),t)):(0,u.ZT)()},this.sendShowEvent=()=>{const e=this.generateShowEventBssParams();e&&this.context.store.dispatch((0,u.vP)((0,i.GM)(e),(0,u.PQ)((()=>{const t=(0,c.JL)(e.showEventKey);return this.wasMounted&&this.setState({showEventOrdinal:t}),(0,u.ZT)()}))))},this.componentRef=e=>{e&&(this.refEl=e,this.initObserver(e))}}componentDidUpdate(e){const t=s&&s.forceSendShowIfPropsChanged;if(t){t.some((t=>this.props[t]!==e[t]))&&this.refEl&&!this.observer&&this.initObserver(this.refEl)}}componentDidMount(){this.wasMounted=!0}componentWillUnmount(){this.destroyObserver(),this.wasMounted=!1}render(){const e=Object.assign(Object.assign({},this.props),{showEventOrdinal:this.state.showEventOrdinal}),s=t?t(this.enhancedDispatch,e):void 0;return(0,r.jsx)(p,Object.assign({},e,s,{bssRef:this.componentRef,sendShowEvent:this.sendShowEvent}))}initObserver(t){if(!this.context.store||!e)return;if(s&&s.forcedIntersection)return void this.sendShowEvent();const r=s&&void 0!==s.threshold?s.threshold:0;this.observer=(0,o.A)(t,{threshold:r},(e=>{e.some((e=>e.isIntersecting||void 0===e.isIntersecting))&&(this.sendShowEvent(),this.destroyObserver())}))}destroyObserver(){this.observer&&(this.observer.disconnect(),this.observer=void 0)}}h.displayName=`WithBss(${p.displayName||p.name||"Unnamed"})`,h.contextType=l.ET;return e=>(0,r.jsx)(d.j.Consumer,{children:t=>(0,r.jsx)(h,Object.assign({ownerFrameId:t.frameId},e))})}}},58688:(e,t,s)=>{s.d(t,{j:()=>r});const r=s(2784).createContext({frameId:""})},74215:(e,t,s)=>{s.d(t,{T:()=>p});var r=s(2784),a=s(58688),i=s(27215),n=s(82603),o=s(93108),c=s(45537),d=s(88240),u=s(402);const l="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect;function p(e,t){const s=(0,r.useContext)(a.j),n=(0,i.oR)(),[p,g]=(0,r.useState)(void 0),m=(0,r.useRef)(!1),f=(0,r.useRef)(!1),b=(0,r.useRef)(),_=(0,r.useRef)(null),y=(0,r.useRef)((()=>{})),E=(0,r.useRef)(void 0);l((()=>{y.current=t=>{if(!e&&t)return void n.dispatch(t);if(!0===f.current)return;E.current=h(e,s,n.getState());const r=E.current;r&&(f.current=!0,n.dispatch((0,c.vP)((0,d.GM)(Object.assign({autoEvent:!!t||void 0},r)),(0,c.PQ)((()=>{const e=(0,u.JL)(r.showEventKey);return m.current&&g(e),(0,c.ZT)()})),t||(0,c.ZT)())))}}),[s,e]),(0,r.useEffect)((()=>(m.current=!0,()=>{m.current=!1})),[]),(0,r.useEffect)((()=>{t&&t.forceSendShowIfParamsChanged&&f.current&&(f.current=!1)}),t&&t.forceSendShowIfParamsChanged?t&&t.forceSendShowIfParamsChanged:[]),(0,r.useEffect)((()=>{if(!e||!_.current||f.current)return;if(t&&t.forcedIntersection)return void y.current();const s=t&&void 0!==t.threshold?t.threshold:0;return b.current=(0,o.A)(_.current,{threshold:s},(e=>{var t;e.some((e=>e.isIntersecting||void 0===e.isIntersecting))&&(y.current(),null===(t=b.current)||void 0===t||t.disconnect(),b.current=void 0)})),()=>{var e;null===(e=b.current)||void 0===e||e.disconnect(),b.current=void 0}}),[e]);return{showEventOrdinal:p,bssRef:_,sendShowEvent:y,useBssHandler:(t,a)=>{const i=(0,r.useRef)(a),o=(0,r.useCallback)((r=>{f.current||(E.current=h(e,s,n.getState()));const a={frameId:s.frameId,showEventParams:E.current},o=t(i.current)(a,n.getState(),r);if(!o)return;const c=(0,d.zs)(o);!f.current&&E.current?(y.current(c),b.current&&(b.current.disconnect(),b.current=void 0)):n.dispatch(c)}),[t,s.frameId]);return l((()=>{i.current=a})),o}}}function h(e,t,s){if(!e)return;const r=(0,n.by)(),a=e(t,s);return a?Object.assign({showEventKey:r},a):void 0}},22696:(e,t,s)=>{s.d(t,{X:()=>n});var r=s(88240),a=s(45537);function i(e,t){const[s,r]=e.split("?"),a=r&&r.split("&").filter((e=>e.split("=")[0]!==t)).join("&");return a?[s,a].join("?"):s}const n=(0,a.gQ)("trackInitialBssEvents",(e=>(0,a.vP)((0,r.zs)({uiElement:{name:"application"},payload:{launch:{link:i(e.link,"stat"),referrer:e.refererHost,utm:e.utm,crossTab:e.crossTab?{parentTabId:e.crossTab.parentTabId,forkEventOrdinal:e.crossTab.forkEventOrdinal,uiElement:e.crossTab.uiElement}:void 0},placeItem:e.crossTab?e.crossTab.placeItem:void 0,searchResultsList:e.crossTab?e.crossTab.searchResultsList:void 0},action:"launch"}),(0,r.u9)({payload:{audienceCounter:{counterType:"launch",link:i(e.link,"stat"),segmentInfo:{segmentId:e.overlapRegionId,baseLocale:e.dataLocale},referrer:e.refererUrl,utm:e.utm}}}),(()=>{if(!e.searchFrameParams)return!1;const{query:t,rubricId:s}=e.searchFrameParams,a={uiElement:{name:"searchStart",ownerName:"application"},payload:{searchRequest:{text:t,entities:s?[{id:s,type:"rubric"}]:void 0}},autoEvent:!0,action:"tap"};return(0,r.zs)(a)})())))},36053:(e,t,s)=>{s.d(t,{n:()=>I});var r=s(5163),a=s(82603);function i(e,t){switch(e.type){case"BSS/TRACK_ACTION":return s=Object.assign(Object.assign({},e.payload),{eventOrdinal:t}),{type:211,eventType:"action",eventId:(0,a.by)(),actionType:s.action,eventOrdinal:s.eventOrdinal,uiElement:s.uiElement,autoEvent:s.autoEvent,payload:s.payload};case"BSS/TRACK_SHOW":return function(e){return{type:212,eventType:"view",eventId:(0,a.by)(),eventOrdinal:e.eventOrdinal,uiElement:e.uiElement,autoEvent:e.autoEvent,payload:"payload"in e?e.payload:void 0}}(Object.assign(Object.assign({},e.payload),{eventOrdinal:t}));case"BSS/TRACK_AUDIENCE_COUNTER":return function(e){return{type:205,eventType:"audienceCounter",eventId:(0,a.by)(),payload:"payload"in e?e.payload:void 0}}(e.payload);default:return}var s}var n=s(43323),o=s(402);function c(){let e=()=>{},t=!1;return{promise:new Promise((t=>{e=t})).then((()=>{t=!0})),resolve:e,isResolved:()=>t}}var d=s(83466);const u=500,l=2047;function p(e,t){let s=0;const{whenFrameShowTracked:u,resolveFrameShowTracked:l,isFrameShowTracked:p}=function(){const e={};return{isFrameShowTracked:t=>e[t]&&e[t].isResolved(),whenFrameShowTracked:t=>(e[t]||(e[t]=c()),e[t].promise),resolveFrameShowTracked:t=>{e[t]||(e[t]=c()),e[t].resolve()}}}();return c=>g=>m=>m.bssV3?"BSS/DEFER_EVENT_ORDINAL"===m.type?(s+=1,c.dispatch(m.payload(s-1))):(function(c,g){(0,r.mG)(this,void 0,void 0,(function*(){const r="dangerouslyForcedEventOrdinal"in g.payload?g.payload.dangerouslyForcedEventOrdinal:void 0,m=null!=r?r:s;if(c.session.isSearchBot)return;if("BSS/TRACK_ACTION"===g.type&&"frameUuid"in g.payload.uiElement){const e=g.payload.uiElement.frameUuid;p(e)||(yield u(e))}const f=t.paramsEnhancer(c),b=i(g,m),_=b?(0,n.D)({apikey:t.apikey,commitIsoDate:t.commitIsoDate,deviceLocale:c.session.browserLocale,state:c,eventParams:b,enhancedAttrs:f,abTest:t.abTest,clientId:t.clientId,isMobileDevice:t.isMobileDevice,sendPrivacyData:t.sendPrivacyData}):void 0;if(!_)return void(0,d.H)({message:"bssTracker error: Не удалось сформировать события для bss-экшена",level:"error",id:"fkkw3",payload:{type:"debug",subtype:"BssTrackerV3",data:JSON.stringify(g)}});const y=_.payload,E=Object.assign(Object.assign({},_),{payload:h(y)});"BSS/TRACK_SHOW"===g.type&&((0,o.H4)(g.payload.showEventKey,s),"type"in g.payload.uiElement&&"frame"===g.payload.uiElement.type&&l(g.payload.uiElement.uuid)),(0,a.uv)(E),e(E),"BSS/TRACK_AUDIENCE_COUNTER"!==g.type&&m===s&&(s+=1)}))}(c.getState(),m),g(m)):g(m)}function h(e){var t;return e&&"searchRequest"in e&&e.searchRequest&&"text"in e.searchRequest?Object.assign(Object.assign({},e),{searchRequest:Object.assign(Object.assign({},e.searchRequest),{text:null===(t=e.searchRequest.text)||void 0===t?void 0:t.substr(0,u)})}):e&&"audienceCounter"in e?Object.assign(Object.assign({},e),{audienceCounter:Object.assign(Object.assign({},e.audienceCounter),{link:e.audienceCounter.link.substr(0,l)})}):e&&"launch"in e?Object.assign(Object.assign({},e),{launch:Object.assign(Object.assign({},e.launch),{link:e.launch.link.substr(0,l)})}):e}function g(e){Array.isArray(e)?e.forEach((e=>{b(e,{withStyles:true})})):b(e,{withStyles:true})}const m="font-size: 14px; line-height: 20px;",f=m+"font-weight: bold;";function b(e,t){if("audienceCounter"!==e.eventType&&(t.withStyles?console.log(`%c Номер события: %c${e.eventOrdinal} `,m,f):console.log(`Номер события: ${e.eventOrdinal} `)),"audienceCounter"===e.eventType)t.withStyles?console.log("%c Тип события:   %caudienceCounter 🔢 ",m,f):console.log("Тип события:   audienceCounter 🔢 ");else switch(e.eventType){case"action":if("textInput"===e.actionType){_(e,"🎹",t);break}_(e,"🎬",t);break;case"view":_(e,"👀",t);break;default:_(e,"🤔",t)}!function(e){const t=JSON.parse(JSON.stringify(e));function s(e){const t=JSON.parse(JSON.stringify(e));if(delete t.common,delete t.tabId,delete t.eventId,t&&"object"==typeof t){t.__proto__=null;for(const e in t)null!==t[e]&&void 0!==t[e]&&(t[e]=s(t[e]))}return t}delete t.type,delete t.timestamp,delete t.utcOffset,console.log.apply(console,[s(t)])}(e),console.log("%c ________________________________________\n",f)}function _(e,t,s){const r=`${e.uiElement&&e.uiElement.name||"unknown"} ${t}`,a=e.actionType?`- ${e.actionType}`:"",i=function(e,t){switch(e){case"action":return"textInput"===t?"185,182,73":"41,148,0";case"view":return"0,114,206";default:return"225,0,0"}}(e.eventType,e.actionType),n=`background: rgba(${i}, .1)`;s.withStyles?console.log(`%c Имя элемента:  %c${r} ${a} `,`${m} ${n}`,f+`color: rgb(${i}); ${n}`):console.log(`Имя элемента:   ${r} ${a}`)}function y(e){const t=window;t.testHandles=t.testHandles||{},t.testHandles.bssRawLog=t.testHandles.bssRawLog||{},t.testHandles.bssRawLog.request=t.testHandles.bssRawLog.request||[],t.testHandles.bssRawLog.clear=()=>{t.testHandles.bssRawLog.request=[]},t.testHandles.bssRawLog.request.push(e)}const E=2e3;function O(e,t){let s=[],r=!1;const i=function(e){const t=window,s=void 0!==t.bssV3Extention?t.bssV3Extention():a.ZT,r=e.bssdbgmd?g:a.ZT,i=e.analyticsBssEnableTestHandles?y:a.ZT;return e=>{s(e),i(e),r(e)}}(t);return t=>{i(t),s.push(t),r||(r=!0,setTimeout((()=>{e.track(s),s=[],r=!1}),E))}}var v=s(38091);class j{constructor(){this.requests=[]}setRequest(e){2===e.params.data.v&&this.requests.push(e)}getRequests(){return this.requests}clear(){this.requests=[]}}class R{constructor(e,t){this.queue=[],this.canRetry=!0,this.isOffline=!1,this.baseUrl=t.analyticsBssUrl,this.noDelay=t.noDelay,this.url=this.getRegEventUrl(),this.request=e,this.delayTime=250,this.clientTimeout=3e4,this.bssDbgMode=t.bssDbgMode,t.enableTestHandles&&(this.testHandles=function(){if("undefined"==typeof window)return;const e=window;return e.testHandles=e.testHandles||{},e.testHandles.bssErrors=e.testHandles.bssErrors||[],e.testHandles.bssLog=new j,e.testHandles.setQueueState=t=>e.testHandles.isQueueEmpty=t,e.testHandles.setBssValidationError=t=>{e.testHandles.bssErrors.push(...t.map((e=>({message:JSON.stringify(e.message,void 0,2),validation_error:JSON.stringify(e.validation_error,void 0,2)}))))},e.testHandles}())}changeOnlineStatus(e){this.isOffline=e,e||this.startQueue()}track(e){this.url&&this.addToQueue(this.url,e)}getEvents(){return[]}addToQueue(e,t){this.queue.push({url:e,params:{data:t}}),this.startQueue(),this.testHandles&&this.testHandles.setQueueState(!1)}startQueue(){this.currentRequestData||this.isOffline||(this.currentRequestData=this.queue.shift(),this.currentRequestData&&this.doRequest(this.currentRequestData))}doRequest(e){const t={timeout:this.clientTimeout,method:"post",data:e.params.data};return this.request(e.url,t).then((e=>{if(202===e.status&&e.data){const s=e.data.checks.filter((e=>!e.valid));this.testHandles&&this.testHandles.setBssValidationError(s),this.bssDbgMode&&(t=s,console.group("bssv3 validation error"),t.forEach(((e,t)=>{console.group("Message "+t),console.groupCollapsed("message"),console.log(JSON.stringify(e.message,void 0,2)),console.groupEnd(),console.group("error"),console.log(JSON.stringify(e.validation_error,void 0,2)),console.groupEnd(),console.groupEnd()})),console.groupEnd())}var t;this.successHandler()})).catch((t=>{if(this.isOffline)return this.queue.unshift(this.currentRequestData),void(this.currentRequestData=void 0);let s;s=t instanceof v.d7?t.details.message:t.message||"Unknown error",this.errorHandler(e,s)}))}successHandler(){this.canRetry=!0,this.logRequest(),this.currentRequestData=this.queue.shift(),this.currentRequestData?this.delayRequest(this.currentRequestData):this.testHandles&&this.testHandles.setQueueState(!0)}errorHandler(e,t){if("0"!==t&&this.canRetry)return this.canRetry=!1,void this.delayRequest(e);(0,d.H)({message:`apiTracker error: ${t}`,level:"warn",id:"aibu0",payload:{type:"network",subtype:"BssTrackerV3",request_url:this.url,request_params:JSON.stringify(e)}}),this.successHandler()}delayRequest(e){this.noDelay?this.doRequest(e):setTimeout((()=>{this.doRequest(e)}),this.delayTime)}getRegEventUrl(){return this.baseUrl}logRequest(){this.testHandles&&this.testHandles.bssLog.setRequest(this.currentRequestData)}}function I(e,t){if("none"===e.bssSendingMode)return e=>t=>s=>s.bssV3?"BSS/DEFER_EVENT_ORDINAL"===s.type?e.dispatch(s.payload(0)):void 0:t(s);const s=(0,v.hG)(e,{GDPRAllowedServiceHosts:"none"!==e.bssSendingMode?[e.bssV3Url]:[]});return p(O(new R(s,{analyticsBssUrl:e.bssV3Url,enableTestHandles:e.analyticsBssEnableTestHandles,bssDbgMode:e.bssdbgmd}),e),{apikey:e.webApiKey,commitIsoDate:e.commitIsoDate,paramsEnhancer:t,abTest:e.experiments,clientId:Number(e.clientId),isMobileDevice:e.isMobileDevice,sendPrivacyData:"full"===e.bssSendingMode})}},402:(e,t,s)=>{s.d(t,{H4:()=>a,JL:()=>i});let r={};function a(e,t){r[e]=t}function i(e){return r[e]}setInterval((function(){r={}}),18e5)},36841:(e,t,s)=>{s.d(t,{v:()=>r});const r={clientId:"",webApiUrl:"https://catalog.api.2gis.ru/2.0/",webApi3Url:"https://catalog.api.2gis.ru/3.0/",webApiKey:"rurbbn3446",excludeTypesFromSearch:"",ppnotApiUrl:"https://routing.api.2gis.com/ctx/2.0",ppnotTypesApiUrl:"https://routing.api.2gis.com/ctx",ppnaApiUrl:"https://routing.api.2gis.com/carrouting/6.0.0",ppngApiUrl:"https://routing.api.2gis.com/truck/6.0.0",pedestrianApiUrl:"https://routing.api.2gis.com/pedestrian/4.0.0",isochronesApiUrl:"https://routing.api.2gis.com/get_hull",trafficApiUrl:"https://jam.api.2gis.com/$regionCode/meta/score/0/",photoApiUrl:"https://api.photo.2gis.com/",photoApiKeyProfile:"Cugh6ahW",photosPerPage:20,feedbackApiUrl:"https://feedback.api.2gis.ru",feedbacksPerPage:12,dataFeedbackApiUrl:"https://datafeedback.api.2gis.ru/1.0/",dataFeedbackSource:"",reviewApiUrl:"https://public-api.reviews.2gis.com/2.0/",reviewApiKey:"37c04fe6-a560-4549-b459-02309cf643ad",discountsApiUrl:"https://discounts.api.2gis.ru/2.0/",achievesApiUrl:"https://achieves.2gis.com/1.0/",aggregatorUrl:"https://aggregator.api.2gis.ru",photosPerPageInUserProfile:20,profileApiUrl:"https://profile.api.2gis.ru/api/1.0",profilePrivacyApiUrl:"https://profile-privacy.api.2gis.ru/api/1.0",shortonizerUrl:"https://go.2gis.com/add/",sberDecoderApiUrl:"https://sberdecoder.api.2gis.ru/sberdecoder/api/1.0/address/decode",taxaApiUrl:"https://taksa.api.2gis.ru/taksa/api/1.0/",videoServiceVersion:"?api-version=1.1",authUrl:"https://api.auth.2gis.com/2.1/",appUrl:"",marketApiUrl:"https://market-backend.api.2gis.ru/5.0/",marketGeoApiUrl:"https://realty.api.2gis.ru/api/1.1/",favoritesApiUrl:"https://favorites.api.2gis.ru/2.0/",messengerSrcUrl:"https://messenger.2gis.com/clientapi.js",messengerApiUrl:"https://api.messenger.2gis.com/1.1/",messengerPlatform:"",checkinApiUrl:"https://checkin.2gis.com/",userActivityApiUrl:"https://useractivity.2gis.com/",bssV3Url:"https://s1.bss.2gis.com/bss-ext/3",bssV3LinkEndpoint:"https://s1.bss.2gis.com/bss/3",bssV3Link:"https://link.2gis.ru/",analyticsBssUrl:"https://stat.api.2gis.ru/",analyticsBssEnableTestHandles:!1,commitIsoDate:"unknown_date",bssKey:"",captchaUrl:"https://captcha.2gis.ru/",pusherApiUrl:"https://pusher.api.2gis.ru/1.0/",tugcApiUrl:"https://tugc.2gis.com/1.0/",contestApiUrl:"https://contest.2gis.com/",congestionApiUrl:"https://congestion.api.2gis.ru/api/1.0/",chronologyPlacesApiUrl:"https://myplaces.api.2gis.ru/api/1.0/",socialGraphApiUrl:"https://social-graph.2gis.com/",networkTimeout:1e4,analyticsAutoTrackPageview:!1,enableProxy:!1,proxyHost:"localhost",proxyPort:9090,debugLogActions:"",srchdbgmd:!1,bssdbgmd:!1,mapdbgmd:!1,paymentsApiUrl:"https://payments.2gis.ru/",etaApiUrl:"https://eta.api.2gis.ru/v2",rasterTileServerUrl:"https://tile0.maps.2gis.com",cityImagesUrl:"https://disk.2gis.com/online_cityimages",tabId:"",sessionId:"",userId:"",photoApiKey:"",experiments:[],availableExperiments:[],requestId:"",ip:"",userAgent:"",geoIpCountryCode:"",startURL:"",hostname:"",xAuthOnline:"",isCountryRedirectsEnabled:!0,featureReadOnly:!1,searchDeviceType:"desktop",searchUserHash:"",isMobileDevice:!1,featureFullCoveragePPNG:!1,bssSendingMode:"full",featurePersonalDataAgreement:!1,featureReduceUGCForSeo:!1,isHumanFromSeo:!1,featurePhone:!1,featurePhoneLaw:!1,featureChronologyPlaces:!0,featureSocialGraph:!1,featureNewYear:!1,feature2gisAwards2022:!1}},25278:(e,t,s)=>{s.d(t,{Dn:()=>u,Iv:()=>h,LZ:()=>a,Mt:()=>n,Nu:()=>i,bw:()=>d,k8:()=>c,oV:()=>g,pA:()=>l,uR:()=>p,wp:()=>o,zO:()=>r});const r=["__empty","undefined"],a=[],i={},n="DEFAULT_SEARCH_ID",o={ru:"ru",kz:"kz",ua:"ua",ae:"ae",cy:"com.cy",cz:"cz",it:"it",cl:"cl",kg:"kg",uz:"uz",az:"az",sa:"com",iq:"com",om:"com",qa:"qa",bh:"bh",eg:"com",kw:"com",by:"by"},c="__empty",d="65536",u="porch",l="transport",p=["bus","trolleybus","tram","shuttle_bus","metro","suburban_train","funicular_railway","monorail","river_transport","cable_car","light_rail","premetro","light_metro","aeroexpress","pedestrian","mcc","mcd"],h="default",g="174"},14866:(e,t,s)=>{s.d(t,{z:()=>n});var r=s(52034),a=s(25278),i=s(69454);const n=e=>{const t=i.Q[e],s=r.get(t.name);if(s&&!a.zO.includes(s))return s}},45502:(e,t,s)=>{s(25278),s(69454)},69454:(e,t,s)=>{s.d(t,{Q:()=>i});const r=7665,a=void 0,i={lang:{name:"dg5_lang",expires:r},pos:{name:"dg5_pos",expires:r},userId:{name:"_2gis_webapi_user",expires:r,shared:!0},mobileAppPromoBannerShowCount:{name:"dg5_banner_show_count",expires:r},sessionId:{name:"_2gis_webapi_session",expires:a,shared:!0},is3dDisabled:{name:"is3dDisabled",expires:r},bssDebugMode:{name:"dg5_bssdbgmd",expires:r},searchDebugMode:{name:"dg5_srchdbgmd",expires:r},mapDebugMode:{name:"dg5_mapdbgmd",expires:r},_searchbot:{name:"_searchbot",expires:r},overrideConfig:{name:"dg5_override_config",expires:a},jurisdiction:{name:"dg5_jur",expires:r},museumAccept:{name:"dg5_museum_accept",expires:r},project:{name:"project",expires:r},flags:{name:"dg5_flags",expires:r},monlineFlags:{name:"flags",expires:r},mobilePromoClosed:{name:"dg5_mblprmclsd",expires:30}}},52792:(e,t,s)=>{s.d(t,{J:()=>n});var r=s(52034),a=s(69454);function i(e){const[t,s,r]=e.split(".").reverse();return s?"cy"===t&&"com"===s?`.${r}.${s}.${t}`:`.${s}.${t}`:e}const n=(e,t,s)=>{const n=a.Q[e],o={expires:n.expires?n.expires:void 0,domain:n.shared?i(window.location.hostname):void 0};if(t)return r.set(n.name,t,o),s?s(n.name,t,o):void 0;r.remove(n.name,o)}},56828:(e,t,s)=>{s.d(t,{C:()=>a,W:()=>r});const r=["new","in_progress","ready_for_delivery","delivery"],a=["sent_to_company","canceled","returned","done"]},94844:(e,t,s)=>{s.d(t,{v:()=>r});const r=["656x340","328x170","232x232","176x176","116x116","88x88"]},56541:(e,t,s)=>{s.d(t,{$O:()=>a,Wz:()=>r.W});var r=s(56828);const a=e=>"real_object_type"in e;s(3385)},24302:(e,t,s)=>{s.d(t,{H:()=>a});var r=s(5163);const a=(0,s(37647).G)("fetchUserAchievements",(({locale:e})=>({achievesApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();return t.getUserAchievements({locale:e,accessToken:r})}))))},5070:(e,t,s)=>{s.d(t,{F:()=>c});var r=s(5163),a=s(37647),i=s(84768),n=s(14677);const o="default",c=(0,a.G)("fetchUserActivity",(()=>({userActivityApi:e,credentialsApi:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(!s)throw new Error("accessToken is missing");return e.getUserActivity({accessToken:s})}))),(0,i.r)("user",{start:e=>Object.assign(Object.assign({},e),{activities:{[o]:Object.assign(Object.assign({},e.activities[o]),{meta:n.qV})}}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{activities:{[o]:{data:null==t?void 0:t.activities,meta:n.YR}}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{activities:{[o]:Object.assign(Object.assign({},e.activities[o]),{meta:(0,n.UL)(t)})}})}))},20194:(e,t,s)=>{s.d(t,{V:()=>d,n:()=>c});var r=s(5163),a=s(37647),i=s(64656),n=s(34291);const o="default",c=(0,a.G)("fetchUserFriendsActivity",(e=>({userActivityApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{maxFriendsPerObject:r,objectsIds:a}=e,i=yield s.getToken();if(!i)throw new Error("accessToken is missing");return t.getUserFriendsActivityByObjects({accessToken:i,maxFriendsPerObject:r,objectsIds:a})})))),d=(0,n.KX)("fetchUserFriendsActivity",{start:e=>(0,i.Av)(e,o),success(e,{params:t,result:s}){var r,a;const n=t.objectsIds.reduce(((e,t)=>(e[t]=void 0,e)),{}),c=s.activities.reduce(((e,t)=>(e[t.object_id]=t,e)),{}),d=Object.assign(Object.assign(Object.assign({},n),null===(a=null===(r=e[o])||void 0===r?void 0:r.data)||void 0===a?void 0:a.items),c);return(0,i.Cj)(e,o,{items:d})},error:(e,{error:t})=>(0,i.VJ)(e,o,t)})},88428:(e,t,s)=>{s.d(t,{e:()=>a});var r=s(5163);const a=(0,s(37647).G)("fetchApartments",(e=>({webApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();if(!r)throw new Error("There is no access token in fetchApartments");return t.fetchApartments({id:e.id,locale:e.locale,accessToken:r})}))))},33558:(e,t,s)=>{s.d(t,{M:()=>r,d:()=>a});const r="default",a="cart2gis"},32753:(e,t,s)=>{s.d(t,{Bk:()=>u,Fw:()=>l,HN:()=>d});var r=s(5163),a=s(37647),i=s(34291),n=s(64656),o=s(64841),c=s(33558);const d={orders:[],showCartButton:!1,customer:{}},u=(0,a.G)("createCart",(()=>()=>(0,r.mG)(void 0,void 0,void 0,(function*(){const e=JSON.parse(o.tO.local.getItem(c.d));return e&&e.orders?e:d})))),l=(0,i.Rs)("createCart","cart",{start:e=>(0,n.Av)(e,c.M),success:(e,{result:t})=>(0,n.Cj)(e,c.M,t),error:(e,{error:t})=>(0,n.VJ)(e,c.M,t)})},53541:(e,t,s)=>{s.d(t,{N:()=>d,y:()=>u});var r=s(5163),a=s(37647),i=s(34291),n=s(64656),o=s(64841),c=s(33558);const d=(0,a.G)("removeCart",(e=>()=>(0,r.mG)(void 0,void 0,void 0,(function*(){const t=o.tO.local.getItem(c.d),s=JSON.parse(t),r=Object.assign(Object.assign({},s),{orders:s.orders.filter((t=>t.orgId!==e.orgId))});return o.tO.local.setItem(c.d,JSON.stringify(r)),r})))),u=(0,i.Rs)("removeCart","cart",{start:e=>(0,n.Av)(e,c.M),success:(e,{result:t})=>(0,n.Cj)(e,c.M,t),error:(e,{error:t})=>(0,n.VJ)(e,c.M,t)})},50216:(e,t,s)=>{s.d(t,{j:()=>d,m:()=>u});var r=s(5163),a=s(37647),i=s(34291),n=s(64656),o=s(64841),c=s(33558);const d=(0,a.G)("replaceCart",(e=>()=>(0,r.mG)(void 0,void 0,void 0,(function*(){return{cart:e}})))),u=(0,i.Rs)("replaceCart","cart",{success(e,{result:t}){const s=t.cart;return o.tO.local.setItem(c.d,JSON.stringify(s)),(0,n.Cj)(e,c.M,s)}})},37543:(e,t,s)=>{s.d(t,{F:()=>d});var r=s(5163),a=s(37647),i=s(34291),n=s(64656),o=s(64841),c=s(33558);const d=(0,a.G)("saveCart",(e=>()=>(0,r.mG)(void 0,void 0,void 0,(function*(){var t;return{cart:null===(t=e.cartState[e.cartId])||void 0===t?void 0:t.data}}))));(0,i.Rs)("saveCart","cart",{success(e,{result:t}){const s=t.cart;return s?(o.tO.local.setItem(c.d,JSON.stringify(s)),(0,n.Cj)(e,c.M,s)):e}})},62545:(e,t,s)=>{s.d(t,{x:()=>g,p:()=>m});var r=s(5163),a=s(37647),i=s(34291),n=s(64656),o=s(64841),c=s(33558),d=s(9701),u=s(19888);function l(e,t){if(0===e.length)return[t];const[,s]=(0,d.U)(e,t);return-1===s?0===t.qty?e:[...e,t]:(0,u.g)(e,t,s)}var p=s(32753),h=s(59597);const g=(0,a.G)("updateCart",(e=>()=>(0,r.mG)(void 0,void 0,void 0,(function*(){return{item:e.item}})))),m=(0,i.Rs)("updateCart","cart",{start:e=>(0,n.Av)(e,c.M),success(e,{result:t}){var s;const r=(null===(s=e[c.M])||void 0===s?void 0:s.data)||p.HN,a=t.item.orgId,i=(0,h.F)(Object.assign(Object.assign({},r),{showCartButton:!0}),a,(e=>Object.assign(Object.assign({},e),{items:l(e.items,t.item)})));return o.tO.local.setItem(c.d,JSON.stringify(i)),(0,n.Cj)(e,c.M,i)},error:(e,{error:t})=>(0,n.VJ)(e,c.M,t)})},9701:(e,t,s)=>{s.d(t,{U:()=>i,k:()=>a});var r=s(90466);function a(e,t){const s=(0,r.L)(e.orders,t.orgId);return i((null==s?void 0:s.items)||[],t)}function i(e,t){const s=e.findIndex((e=>e.orgId===t.orgId&&e.productId===t.productId));return-1===s?[void 0,s]:[e[s],s]}},9224:(e,t,s)=>{s.d(t,{I:()=>c});var r=s(5163),a=s(37647),i=s(84768),n=s(14677);const o="default",c=(0,a.G)("fetchUserChronologyPlaces",(()=>({chronologyPlacesApi:e,credentialsApi:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();return e.getUserChronologyPlaces({accessToken:s})}))),(0,i.r)("user",{start:e=>Object.assign(Object.assign({},e),{chronologyPlaces:{[o]:Object.assign(Object.assign({},e.chronologyPlaces[o]),{meta:n.qV})}}),success(e,{result:t}){var s;if(!(null===(s=t.results)||void 0===s?void 0:s.length))return Object.assign(Object.assign({},e),{chronologyPlaces:{[o]:Object.assign(Object.assign({},e.chronologyPlaces[o]),{meta:(0,n.Mq)()})}});const r=t.results.map((e=>e.id));return Object.assign(Object.assign({},e),{chronologyPlaces:{[o]:{data:{items:t.items.reduce(((e,t)=>(e[t.id]=t,e)),{}),resultsIds:r,total:r.length},meta:n.YR}}})},error:(e,{error:t})=>Object.assign(Object.assign({},e),{chronologyPlaces:{[o]:Object.assign(Object.assign({},e.chronologyPlaces),{meta:(0,n.UL)(t)})}})}))},82830:(e,t,s)=>{s.d(t,{f:()=>c});var r=s(5163),a=s(37647),i=s(84768),n=s(14677);const o="default",c=(0,a.G)("fetchUserChronologyPlacesByObject",(e=>({chronologyPlacesApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();return t.getUserChronologyPlacesByObjects({ids:e.ids,accessToken:r})}))),(0,i.r)("user",{start:e=>Object.assign(Object.assign({},e),{chronologyPlaces:{[o]:Object.assign(Object.assign({},e.chronologyPlaces[o]),{meta:n.qV})}}),success(e,{result:t}){var s,r;const a=t.items.reduce(((e,t)=>(e[t.id]=t,e)),{}),i=e.chronologyPlaces[o];return(null==i?void 0:i.data)?Object.assign(Object.assign({},e),{chronologyPlaces:{[o]:{data:Object.assign(Object.assign({},i.data),{items:Object.assign(Object.assign({},null===(r=null===(s=e.chronologyPlaces[o])||void 0===s?void 0:s.data)||void 0===r?void 0:r.items),a)}),meta:n.YR}}}):e},error:(e,{error:t})=>Object.assign(Object.assign({},e),{chronologyPlaces:{[o]:Object.assign(Object.assign({},e.chronologyPlaces[o]),{meta:(0,n.UL)(t)})}})}))},9335:(e,t,s)=>{s.d(t,{B:()=>o,F:()=>c});var r=s(5163),a=s(37647),i=s(34291),n=s(64656);const o=(0,a.G)("fetchUserContestStatusByContestId",(({contestId:e})=>({contestApi:t,contextApi:s,credentialsApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){var r;const i=yield a.getToken(),n=null!==(r=yield s.get("locale"))&&void 0!==r?r:"ru_RU";return t.getUserContestStatus({locale:n,accessToken:i,contestId:e})})))),c=(0,i.Rs)("fetchUserContestStatusByContestId","contests",{start:(e,{params:t})=>(0,n.Av)(e,t.contestId),success:(e,{result:t,params:s})=>(0,n.Cj)(e,s.contestId,t),error:(e,{error:t,params:s})=>(0,n.VJ)(e,s.contestId,t)})},47531:(e,t,s)=>{s.d(t,{f:()=>o,r:()=>c});var r=s(5163),a=s(37647),i=s(34291),n=s(64656);const o=(0,a.G)("joinUserInContest",(({locale:e,contestId:t})=>({contestApi:s,credentialsApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield a.getToken();return s.joinUser({locale:e,accessToken:r,contestId:t})})))),c=(0,i.Rs)("joinUserInContest","contests",{start:(e,{params:t})=>(0,n.Av)(e,t.contestId),success:(e,{result:t,params:s})=>(0,n.Cj)(e,s.contestId,t),error:(e,{error:t,params:s})=>(0,n.VJ)(e,s.contestId,t)})},63595:(e,t,s)=>{s.d(t,{k:()=>a});var r=s(5163);const a=(0,s(37647).G)("deleteCookie",(e=>({cookieApi:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{name:s}=e;yield t.setStrict(s,void 0)}))))},22836:(e,t,s)=>{s.d(t,{d:()=>a});var r=s(5163);const a=(0,s(37647).G)("setCookie",(e=>({cookieApi:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{name:s,value:r}=e;yield t.setStrict(s,r)}))))},22298:(e,t,s)=>{s.d(t,{U:()=>o});var r=s(37647),a=s(44390),i=s(84768),n=s(14677);const o=(0,r.G)("pedestrian",(({locale:e,projectCode:t,points:s,viewpoint:r,zoom:i})=>({directionsApi:n})=>{if(s.length<a.Kr){const e={name:"ParamsError",code:400,message:`Недостаточно точек для построения пешего маршрута. Нужно по крайней мере ${a.Kr}`};return Promise.reject(e)}if(!t){const e={name:"ParamsError",code:400,message:"Для поиска пеших маршрутов необходим код проекта"};return Promise.reject(e)}return n.pedestrian({projectCode:t,points:s,locale:e,viewpoint:r,zoom:i})}),(0,i.r)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:n.qV}}),success:(e,{params:t,result:s})=>s.items.length&&t.projectCode?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"pedestrian",items:s.items,total:s.total,projectCode:t.projectCode},meta:n.YR}}):Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,n.Mq)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,n.UL)(s)})})}))},1388:(e,t,s)=>{s.d(t,{b:()=>o});var r=s(37647),a=s(44390),i=s(84768),n=s(14677);const o=(0,r.G)("ppna",(({locale:e,points:t,viewpoint:s,zoom:r})=>({directionsApi:i})=>{if(t.length<a.Kr){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${a.Kr}`};return Promise.reject(e)}return i.ppna({points:t,locale:e,viewpoint:s,zoom:r})}),(0,i.r)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:n.qV}}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"ppna",items:s.items,total:s.total},meta:n.YR}}):Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,n.Mq)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,n.UL)(s)})})}))},41510:(e,t,s)=>{s.d(t,{Y:()=>d});var r=s(5163),a=s(37647),i=s(44390),n=s(14677),o=s(84768),c=s(64656);const d=(0,a.G)("ppng",(({locale:e,points:t,viewpoint:s,zoom:a,filterValues:o})=>({directionsApi:c})=>(0,r.mG)(void 0,void 0,void 0,(function*(){if(t.length<i.Kr){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${i.Kr}`};return Promise.reject(e)}const r=yield c.ppng({points:t,locale:e,viewpoint:s,zoom:a,filterValues:o});if(0===r.items.length)throw n.fD;const d=r.items.filter((e=>{var t;return"no"!==(null===(t=e.features)||void 0===t?void 0:t.truck)}));if(d.length!==r.items.length){if(0===d.length)throw Object.assign(Object.assign({},n.fD),{name:"PpngNotFoundButPpnaFound"});return Object.assign(Object.assign({},r),{items:d,total:d.length})}return r}))),(0,o.r)("directions",{start:(e,{params:t})=>(0,c.Av)(e,t.searchId),success:(e,{params:t,result:{items:s,total:r}})=>(0,c.Cj)(e,t.searchId,{type:"ppng",items:s,total:r}),error:(e,{params:t,error:s})=>(0,c.VJ)(e,t.searchId,s)}))},51291:(e,t,s)=>{s.d(t,{i:()=>o});var r=s(37647),a=s(44390),i=s(84768),n=s(14677);const o=(0,r.G)("ppnot",(({locale:e,projectCode:t,points:s,viewpoint:r,zoom:i,filterValues:n})=>({directionsApi:o})=>{if(s.length<a.Kr){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${a.Kr}`};return Promise.reject(e)}if(!t){const e={name:"ParamsError",code:400,message:"Для ППНОТ необходим код проекта"};return Promise.reject(e)}return o.ppnot({projectCode:t,points:s,locale:e,viewpoint:r,zoom:i,filterValues:n})}),(0,i.r)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:n.qV}}),success:(e,{params:t,result:s})=>s.items.length&&t.projectCode?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"ppnot",items:s.items,total:s.total,projectCode:t.projectCode},meta:n.YR}}):Object.assign(Object.assign({},e),{[t.searchId]:{data:t.projectCode?{type:"ppnot",items:[],total:0,projectCode:t.projectCode}:void 0,meta:(0,n.Mq)()}}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,n.UL)(s)})})}))},14995:(e,t,s)=>{s.d(t,{y:()=>n});var r=s(37647),a=s(84768),i=s(14677);const n=(0,r.G)("ppnotTypes",(({projectCode:e})=>({directionsApi:t})=>{if(!e){const e={name:"ParamsError",code:400,message:"Для получения ППНОТ типов необходим код проекта"};return Promise.reject(e)}return t.ppnotTypes({projectCode:e})}),(0,a.r)("directionsPpnotTypes",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.projectCode]:{meta:i.qV}}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.projectCode]:{data:s.items,meta:i.YR}}):Object.assign(Object.assign({},e),{[t.projectCode]:Object.assign(Object.assign({},e[t.projectCode]),{meta:(0,i.Mq)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.projectCode]:Object.assign(Object.assign({},e[t.projectCode]),{meta:(0,i.UL)(s)})})}))},27414:(e,t,s)=>{s.d(t,{b:()=>o,z:()=>n});var r=s(37647),a=s(34291),i=s(14677);const n=(0,r.G)("fetchEntityDiscounts",(e=>({discountsApi:t})=>t.getDiscounts({id:e.id}))),o=(0,a.KX)("fetchEntityDiscounts",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:i.qV})}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.id]:{data:{items:s.items,total:s.total},meta:i.YR}}):Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:(0,i.Mq)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:(0,i.UL)(s)})})})},9889:(e,t,s)=>{s.d(t,{FG:()=>u,qA:()=>p,y8:()=>d,zb:()=>l});var r=s(37647),a=s(34291),i=s(41560),n=s(8919),o=s(82603),c=s(50022);const d=(0,r.G)("fetchEntityByEntrance",(e=>({webApi:t})=>t.getItemByEntrance({id:e.id}))),u=(0,a.xr)("fetchEntityByEntrance",{},{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.id]:{data:void 0,meta:i.qV}}),success:(e,{params:t,result:s})=>200!==s.code?e:Object.assign(Object.assign({},e),{[t.id]:{data:{id:s.items[0].id},meta:i.YR}}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.id]:{data:void 0,meta:(0,i.UL)(s)}})}),l=(0,a.KX)("fetchEntityByEntrance",{success(e,{result:t}){if(200!==t.code)return e;const s=t.items[0];if(!("id"in s))return e;const r=e[s.id],a=(0,o.$K)(r)&&(0,o.$K)(r.data)?r.data:{};return Object.assign(Object.assign({},e),{[s.id]:{data:Object.assign(Object.assign({},a),(0,c.Eb)(s)),meta:i.YR}})}}),p=e=>t=>t.data.entity.entrance[e]||n.Y},2828:(e,t,s)=>{s.d(t,{gM:()=>u});var r=s(5163),a=s(37647),i=s(82603),n=s(27087),o=s(60506),c=s(12452),d=s(23984);const u=(0,a.G)("syncPublicFavorites",(e=>({favoritesApi:t,favoritesStorage:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{projectId:r,countryCode:a,sync:u}=e,l=yield s.getPublic(),p=yield t.syncPublicFavorites({filter:{attribute_name:"project_id",values:{[r]:l.sync.lastSyncAttr.project_id[r]||null}}}),h=(0,c.x)(l,p,{projectId:r});if(yield s.setPublic(h),!(0,o.u)(u,l.sync)||!(0,i.xb)(p.id_changes))return{sync:h.sync,objects:(0,d.x1)(h.objects,a,r),replace:!0};const g=Object.keys(p.objects),m=(0,i.Q8)((0,n.ei)(h.objects,g),d.Xy);return{sync:h.sync,objects:m,replace:!1}}))));s(29127),s(16005),s(43234),s(334)},16005:(e,t,s)=>{s.d(t,{D:()=>d});var r=s(5163),a=s(37647),i=s(16539),n=s(82603),o=s(60506),c=s(23984);const d=(0,a.G)("modifyPersonalFavorites",(e=>({favoritesStorage:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getPersonal(),r=(0,i.M)({stored:s,modification:e.objects,time:String(Date.now())});return yield t.setPersonal(r),(0,o.u)(e.sync,s.sync)?{replace:!1,sync:r.sync,objects:e.objects}:{replace:!0,sync:r.sync,objects:(0,n.Q8)(r.objects,c.bq)}}))))},334:(e,t,s)=>{s.d(t,{f:()=>d});var r=s(5163),a=s(37647),i=s(16539),n=s(82603),o=s(60506),c=s(23984);const d=(0,a.G)("modifyPlaces",(e=>({favoritesStorage:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getPlaces(),r=(0,i.M)({stored:s,modification:e.objects,time:String(Date.now())});return yield t.setPlaces(r),(0,o.u)(e.sync,s.sync)?{replace:!1,sync:r.sync,objects:e.objects}:{replace:!0,sync:r.sync,objects:(0,n.Q8)(r.objects,c.O2)}}))))},29127:(e,t,s)=>{s.d(t,{K:()=>u});var r=s(5163),a=s(37647),i=s(82603),n=s(27087),o=s(60506),c=s(12452),d=s(23984);s(16005);const u=(0,a.G)("syncPersonalFavorites",(e=>({favoritesApi:t,favoritesStorage:s,credentialsApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getPersonal();const u=yield a.getToken();if(!u)throw new Error("There is no access_token");const l=yield t.syncPersonalFavorites({last_sync:r.sync.lastSync,objects:r.changes,access_token:u}),p=(0,c.x)(r,l);if(yield s.setPersonal(p),!(0,o.u)(e.sync,r.sync)||!(0,i.xb)(l.id_changes))return{sync:p.sync,objects:(0,i.Q8)(p.objects,d.bq),replace:!0};const h=Object.keys(l.objects),g=(0,i.Q8)((0,n.ei)(p.objects,h),d.bq);return{sync:p.sync,objects:g,replace:!1}}))))},43234:(e,t,s)=>{s.d(t,{s:()=>u});var r=s(5163),a=s(37647),i=s(82603),n=s(27087),o=s(60506),c=s(12452),d=s(23984);const u=(0,a.G)("syncPlaces",(e=>({favoritesApi:t,favoritesStorage:s,credentialsApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getPlaces(),u=yield a.getToken();if(!u)throw new Error("There is no access_token");const l=yield t.syncPlaces({last_sync:r.sync.lastSync,objects:r.changes,access_token:u}),p=(0,c.x)(r,l);if(yield s.setPlaces(p),!(0,o.u)(e.sync,r.sync)||!(0,i.xb)(l.id_changes))return{sync:p.sync,objects:(0,i.Q8)(p.objects,d.O2),replace:!0};const h=Object.keys(l.objects),g=(0,i.Q8)((0,n.ei)(p.objects,h),d.O2);return{sync:p.sync,objects:g,replace:!1}}))))},12452:(e,t,s)=>{s.d(t,{x:()=>i});var r=s(82603);function a(e,t){if(0===Object.keys(t).length)return e;const s=(0,r.Q8)(t,((t,s)=>{if(!t||!t.system_is_deleted||"true"!==t.system_is_deleted[0])return Object.assign(Object.assign({},e[s]),t)}));return Object.assign(Object.assign({},e),s)}function i(e,t,s){const i=(n=e.objects,!(o=t.id_changes)||(0,r.xb)(o)?n:Object.keys(n).reduce(((e,t)=>{const s=o[t]?o[t]:t;return Object.assign(Object.assign({},e),{[s]:n[t]})}),{}));var n,o;return{sync:{lastSync:t.curr_sync,lastSyncAttr:s?{project_id:Object.assign(Object.assign({},e.sync.lastSyncAttr.project_id),{[s.projectId]:t.curr_sync})}:e.sync.lastSyncAttr},objects:a(i,t.objects),changes:{}}}},16539:(e,t,s)=>{s.d(t,{M:()=>c});var r=s(82603),a=s(64301),i=s(85388);var n=s(79207);function o(e,t,s){const r=[...Object.keys(e),...Object.keys(t)],a={};for(const i of r)a.hasOwnProperty(i)||(a[i]=s(e[i],t[i]));return a}function c(e){const{stored:t,modification:s,time:n}=e,o=(0,r.Q8)(s,(e=>function(e){if(!e||!Object.keys(e).length)return;const t=(0,r.Q8)(e,((e,t)=>{if(null!=e){if(Array.isArray(e))return e.map((e=>String(e)));if((0,i.S)(e))return[(0,a.DF)(e)];if((0,r.Kn)(e))try{return[JSON.stringify(e)]}catch(e){throw new Error(`invalid ${t}. Can't make json from object`)}return[String(e)]}}));return delete t.id,t}(e)));return Object.assign(Object.assign({},t),{objects:Object.assign(Object.assign({},t.objects),o),changes:d(t.objects,t.changes,o,n)})}function d(e,t,s,a){return o(t,(0,n.Y)((0,r.Q8)(s,((t,s)=>{const r=e[s];if(void 0===t){if(void 0===r)return;return{system_is_deleted:{time:a,value:["true"]}}}return u(void 0===r?{}:r,t,a)}))),((e,t)=>e&&t?function(e,t){if(l(t))return t;if(l(e))return t;const s=Object.assign({},e);for(const r in t)if(t.hasOwnProperty(r)){const a=e[r],i=t[r];if(!i)continue;if(!a){s[r]=t[r];continue}p(a.value,i.value)||(s[r]=t[r])}if(0===Object.keys(s).length)return;return s}(e,t):t||e))}function u(e,t,s){const r=(0,n.Y)(o(e,t,((e,t)=>{if(e||t){if(!e)return{time:s,value:t||null};if(!p(e,t))return{time:s,value:t||null}}})));if(0!==Object.keys(r).length)return r}function l(e){return!(!e.system_is_deleted||!e.system_is_deleted.value||"true"!==e.system_is_deleted.value[0])}function p(e,t){if(!e||!t)return!e==!t;if(e.length!==t.length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}},23984:(e,t,s)=>{s.d(t,{x1:()=>u,O2:()=>d,bq:()=>p,Xy:()=>l});var r=s(35367),a=s(82603),i=s(64301);var n=s(25278);function o(e,t){if(!e||!e.type||!e.type.length)return;const s=(0,a.Q8)(e,((e,t)=>{let s=e&&e[0];if(null==e)s=void 0;else if(function(e,t){return!!e&&e.hasOwnProperty(t)}(r.NY,t))switch(r.NY[t]){case"boolean":s="true"===e[0].toLowerCase();break;case"number":s=Number(e[0]);break;case"lonlat":s=(0,i.rx)(e[0]);break;case"array":s=[...e];break;case"object":try{s=JSON.parse(e[0])}catch(e){s=void 0}}return s}));return s.id=t,s}const c=["interesting","guidebook","awards2019","shared_collections"];function d(e,t){const s=o(e,t);return s&&"place"===s.type?s:void 0}function u(e,t,s){const r={},a={},i=t=>{const s=l(e[t],t);s&&(r[t]=s)};for(const o in e){const d=e[o];if(d)switch(d.type&&d.type[0]){case"theme":if(d.code&&c.includes(d.code[0])){if("guidebook"===d.code[0]&&"ru"!==t&&s===n.oV)break;i(o),d.collections&&d.collections.forEach((e=>{i(e);const t=a[e];t&&t.forEach((e=>{i(e)}))}))}break;case"favorite":{const e=d.collection_id&&d.collection_id[0];if(e)if(r[e])i(o);else{(a[e]||(a[e]=[])).push(o)}break}}}return r}function l(e,t){const s=o(e,t);if(s&&("favorite"===s.type||"collection"===s.type||"theme"===s.type))return"favorite"===s.type&&delete s.source_data,s}function p(e,t){const s=o(e,t);if(s&&("favorite"===s.type||"collection"===s.type))return s}},7537:(e,t,s)=>{s.d(t,{G:()=>n});var r=s(85388),a=s(82603),i=s(35367);function n(e,t){const s="point"===t.object_type&&void 0===e.object_id||e.object_id===t.object_id;if("point"===t.object_type&&!(0,r.S)(t.point))return!1;if(!s||!i.vT.includes(t.object_type))return s;const n=e.point||e.source_point;return(0,r.S)(n)||(0,r.S)(t.point)?!(!(0,r.S)(n)||!(0,r.S)(t.point))&&((0,a.G9)(n.lon,t.point.lon)&&(0,a.G9)(n.lat,t.point.lat)):s}},60506:(e,t,s)=>{function r(e,t){if(e.lastSync!==t.lastSync)return!1;if(Object.keys(e.lastSyncAttr.project_id).length!==Object.keys(t.lastSyncAttr.project_id).length)return!1;for(const s in e.lastSyncAttr.project_id)if(e.lastSyncAttr.project_id[s]!==t.lastSyncAttr.project_id[s])return!1;return!0}s.d(t,{u:()=>r})},62104:(e,t,s)=>{s.d(t,{e:()=>a});var r=s(84768);const a=(0,s(37647).G)("fetchDashboardGTA",(e=>({webApi:t})=>t.getDashboardAds(e)),(0,r.r)("gta",{success(e,{params:t,result:s}){const r=t.gtaId;return s&&200===s.code?Object.assign(Object.assign({},e),{[r]:{banners:s.banners}}):e},error(e,{params:t}){const s=t.gtaId,r=Object.assign({},e);return delete r[s],r}}))},40411:(e,t,s)=>{s.d(t,{k:()=>o});var r=s(5163),a=s(41560),i=s(76448),n=s(84768);const o=(0,s(37647).G)("fetchUserHistory",(({userId:e,authId:t})=>({webApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){return s.getProfile({userId:e,authId:t})}))),(0,n.r)("profile",{start:e=>Object.assign(Object.assign({},e),{meta:a.qV}),success(e,{result:t}){if(!t||200!==t.code)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{suggestLastObjects:[]}),meta:a.YR});const{last_objects:s,history_objects:r,home_work_objects:i}=t;return{data:{historyObjects:r,homeWorkObjects:i,suggestLastObjects:s},meta:a.YR}},error:(e,{error:t})=>Object.assign(Object.assign({},e),{meta:(0,a.UL)(t)})}),(0,n.r)("history",{start:e=>Object.assign(Object.assign({},e),{meta:a.qV}),success(e,{result:t}){if(!t||200!==t.code)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{suggestLastObjects:[]}),meta:a.YR});const s=(0,i.Jk)(t),r=(0,i.NI)(e.data,s);return{data:{searches:r.searches,suggestLastObjects:r.suggestLastObjects},meta:a.YR}},error:(e,{error:t})=>Object.assign(Object.assign({},e),{meta:(0,a.UL)(t)})}))},37647:(e,t,s)=>{s.d(t,{G:()=>a});var r=s(34291);function a(e,t,...s){return(0,r.GW)(e,t,...s)}},20146:(e,t,s)=>{s.d(t,{m:()=>d});var r=s(5163),a=s(37647),i=s(82603);const n=";",o=e=>{if(!e)return{};const t=(0,i.oA)(e.split(n)),s={};for(const e of t)e&&(s[e]=!0);return s};var c=s(64841);const d=(0,a.G)("setFlag",(e=>({cookieApi:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{name:s,value:r}=e,a=t.getStrict("flags"),d=c.tO.local.getItem("flags"),u=d||a;if(a&&!d&&(c.tO.local.setItem("flags",a),t.delete("dg5_flags")),!s)return o(u);const l=((e,t,s)=>{if(!e)return!1===s?void 0:t;const r=(0,i.oA)(e.split(n));if(!s){const e=r.filter((e=>e!==t));if(!e.length)return;return e.join(n)}return r.includes(t)?r.join(n):[...r,t].join(n)})(u,s,r);return yield c.tO.local.setItem("flags",l),o(l)}))))},83447:(e,t,s)=>{s.d(t,{C:()=>o,O:()=>c});var r=s(5163),a=s(37647),i=s(34291),n=s(14677);const o=(0,a.G)("fetchClusteredMarkers",(e=>({webApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();return t.clusteredMarkersQuery(Object.assign(Object.assign({},e),{accessToken:r}))})))),c=(0,i.KX)("fetchClusteredMarkers",{start(e,{params:t}){const{searchId:s}=t,r=e[s];return{[s]:{data:r&&r.data,meta:n.qV}}},success(e,{params:t,result:s}){const r=t.searchId;return e[r]&&s?200!==s.code?{[r]:{data:void 0,meta:(0,n.L3)(s.code)}}:Object.assign(Object.assign({},e),{[r]:{data:s,meta:n.YR}}):e},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:{data:void 0,meta:(0,n.UL)(s)}})})},41738:(e,t,s)=>{s.d(t,{U:()=>a});var r=s(37647);const a=(0,r.G)("fetchProductOffersGroupedByOrg",(e=>({marketApi:t})=>t.getOffersGroupedByOrg(e)));(0,r.G)("fetchProjecMarketCategories",(e=>({marketApi:t})=>t.getProjectCategories(e)))},31504:(e,t,s)=>{s.d(t,{H:()=>o,q:()=>c});var r=s(37647),a=s(34291),i=s(64656),n=s(49918);const o=(0,r.G)("fetchProductOffersWithItems",(e=>({marketApi:t,contextApi:s})=>t.getProductOfferWithItems(Object.assign(Object.assign({},e),{locale:s.get("locale")})))),c=(0,a.Rs)("fetchProductOffersWithItems","market",{start(e,{params:t}){const{branchId:s,productIds:r}=t;let a={},o={};return r.forEach((t=>{const r=e.products[t];(null==r?void 0:r.data)||(a=(0,i.Av)(a,t));const c=(0,n.l)(t,s),d=e.offers[c];(null==d?void 0:d.data)||(o=(0,i.Av)(o,c))})),Object.keys(a).length||Object.keys(o).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(a).length&&{products:Object.assign(Object.assign({},e.products),a)}),Object.keys(o).length&&{offers:Object.assign(Object.assign({},e.offers),o)}):e},success(e,{params:t,result:s}){const{branchId:r,productIds:a}=t;let o={},c={};const{items:d,dicts:u}=s;return a.forEach((t=>{var s,a;const l=(0,n.l)(t,r),p=null===(s=e.offers[l])||void 0===s?void 0:s.data,h=null===(a=e.products[t])||void 0===a?void 0:a.data,g=d.find((e=>e.product.id===t));if(!g)return h||(o[t]=void 0),void(p||(c=(0,i.VJ)(c,l,{code:404,name:"NotFound",message:"offer not found"})));const{product:m,offer:f}=g;if(h||(o=(0,i.Cj)(o,t,{product:m,dicts:u})),!p){const e={productId:t,branchId:r,price:f.price,price_value:f.price_value,currency:f.currency,buttons:null==f?void 0:f.buttons,market_item_actions:f.market_item_actions};c=(0,i.Cj)(c,l,e)}})),Object.keys(o).length||Object.keys(c).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(o).length&&{products:Object.assign(Object.assign({},e.products),o)}),Object.keys(c).length&&{offers:Object.assign(Object.assign({},e.offers),c)}):e},error(e,{params:t,error:s}){const{branchId:r,productIds:a}=t;let o={},c={};return a.forEach((t=>{const a=e.products[t];(null==a?void 0:a.data)||(o=(0,i.VJ)(o,t,s));const d=(0,n.l)(t,r),u=e.offers[d];(null==u?void 0:u.data)||(c=(0,i.VJ)(c,d,s))})),Object.keys(o).length||Object.keys(c).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(o).length&&{products:Object.assign(Object.assign({},e.products),o)}),Object.keys(c).length&&{offers:Object.assign(Object.assign({},e.offers),c)}):e}})},36593:(e,t,s)=>{s.d(t,{a:()=>o});var r=s(5163),a=s(37647),i=s(84768),n=s(41560);const o=(0,a.G)("postBroadcast",(({branchIds:e,text:t})=>({messengerApi:s,credentialsApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield a.getToken();if(!r)throw new Error("No access token");return s.postBroadcast({branchIds:e,text:t,accessToken:r})}))),(0,i.r)("user",{start:(e,t)=>Object.assign(Object.assign({},e),{broadcast:Object.assign(Object.assign({},e.broadcast),{[t.params.searchId]:{meta:n.qV}})}),success:(e,t)=>Object.assign(Object.assign({},e),{broadcast:Object.assign(Object.assign({},e.broadcast),{[t.params.searchId]:{meta:n.YR,data:t.result}})}),error:(e,t)=>Object.assign(Object.assign({},e),{broadcast:Object.assign(Object.assign({},e.broadcast),{[t.params.searchId]:{meta:(0,n.UL)(t.error)}})})}))},95683:(e,t,s)=>{s.d(t,{l:()=>o,s:()=>n});var r=s(5163),a=s(37647),i=s(71372);const n=(0,a.G)("cancelOrder",(e=>({paymentsApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{orderId:r}=e,i=yield s.getToken();if(!i)throw new Error("There is no access_token");return yield t.cancelOrder({locale:a.get("locale"),orderId:r,accessToken:i})})))),o=(0,i.R)("cancelOrder","ordersHistory",{success(e,{params:t}){var s;if(!e.default)return e;const r=((null===(s=e.default.data)||void 0===s?void 0:s.orders)||[]).map((e=>e.id===t.orderId?Object.assign(Object.assign({},e),{status:Object.assign(Object.assign({},e.status),{type:"canceled",flags:{canBeCanceled:!1}})}):e));return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},e.default),{data:{total:r.length,orders:r}})})}})},6135:(e,t,s)=>{s.d(t,{D:()=>c,b:()=>o});var r=s(5163),a=s(64656),i=s(37647),n=s(34291);const o=(0,i.G)("checkoutDelivery",(e=>({paymentsApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();if(!r)throw new Error("There is no access_token");return yield t.checkoutDelivery(Object.assign(Object.assign({},e),{accessToken:r,locale:a.get("locale")}))})))),c=(0,n.Rs)("checkoutDelivery","deliveryOrder",{start:(e,{params:t})=>(0,a.Av)(e,t.idempotencyKey),success:(e,{params:t,result:s})=>(0,a.Cj)(e,t.idempotencyKey,s.result),error:(e,{params:t,error:s})=>(0,a.VJ)(e,t.idempotencyKey,s)})},81305:(e,t,s)=>{s.d(t,{F:()=>d,O:()=>u});var r=s(5163),a=s(37647),i=s(34291),n=s(33558),o=s(59597),c=s(41560);const d=(0,a.G)("fetchDeliveryCalculation",(e=>({paymentsApi:t,contextApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){return yield t.getDeliveryCalculation(Object.assign(Object.assign({},e),{locale:s.get("locale")}))})))),u=(0,i.Rs)("fetchDeliveryCalculation","cart",{start:(e,{params:t})=>l(e,t,{meta:c.qV}),success:(e,{params:t,result:s})=>l(e,t,{data:s,meta:c.YR}),error:(e,{params:t,error:s})=>l(e,t,{meta:(0,c.UL)(s)})}),l=(e,t,s)=>{const r=e[n.M];return(null==r?void 0:r.data)?Object.assign(Object.assign({},e),{[n.M]:Object.assign(Object.assign({},r),{data:(0,o.F)(r.data,t.orgId,(e=>Object.assign(Object.assign({},e),{deliveryTimestamp:+new Date,deliveryBuildingId:t.delivery.address.buildingId,delivery:s})))})}):e}},8196:(e,t,s)=>{s.d(t,{$:()=>d,D:()=>o});var r=s(5163),a=s(37647),i=s(34291),n=s(64656);const o=(0,a.G)("fetchOrdersHistory",(()=>({paymentsApi:e,credentialsApi:t,contextApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield t.getToken();if(!r)throw new Error("There is no access_token");return yield e.getOrders({accessToken:r,locale:s.get("locale")})})))),c="default",d=(0,i.Rs)("fetchOrdersHistory","ordersHistory",{start:e=>(0,n.Av)(e,c),success:(e,{result:t})=>(0,n.Cj)(e,c,t),error:(e,{error:t})=>(0,n.VJ)(e,c,t)})},93095:(e,t,s)=>{s.d(t,{e:()=>c,o:()=>o});var r=s(5163),a=s(37647),i=s(34291),n=s(41560);const o=(0,a.G)("fetchOrdersShort",(()=>({paymentsApi:e,credentialsApi:t,contextApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield t.getToken();if(!r)throw new Error("There is no access_token");return yield e.getOrdersShort({accessToken:r,locale:s.get("locale"),type:"active"})})))),c=(0,i.Rs)("fetchOrdersShort","user",{start:e=>Object.assign(Object.assign({},e),{shortOrders:Object.assign(Object.assign({},e.shortOrders),{meta:n.qV})}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{shortOrders:{data:t.orders,meta:n.YR}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{shortOrders:Object.assign(Object.assign({},e.shortOrders),{meta:(0,n.UL)(t)})})})},1220:(e,t,s)=>{s.d(t,{B:()=>o,R:()=>c});var r=s(5163),a=s(37647),i=s(34291),n=s(64656);const o=(0,a.G)("checkoutOrder",(e=>({paymentsApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();return yield t.checkoutOrder(Object.assign(Object.assign({},e),{accessToken:r,locale:a.get("locale")}))})))),c=(0,i.Rs)("checkoutOrder","order",{start:(e,{params:t})=>(0,n.Av)(e,t.idempotencyKey),success:(e,{params:t,result:s})=>(0,n.Cj)(e,t.idempotencyKey,s.items[0]),error:(e,{params:t,error:s})=>(0,n.VJ)(e,t.idempotencyKey,s)})},89305:(e,t,s)=>{s.d(t,{d:()=>n,z:()=>o});var r=s(97698),a=s(31683),i=s(56541);const n=e=>e.data.user.shortOrders.data,o=(0,r.P1)([n,(e,t)=>t.orgId],((e,t)=>(0,a.o)({orders:e||[],filterByStatus:i.Wz}).filter((e=>e.firm.orgId===t))))},31683:(e,t,s)=>{function r(e){const{orders:t,filterByStatus:s=[]}=e;return t.length?s.length?t.filter((e=>s.includes(e.status.type))):t:[]}s.d(t,{o:()=>r})},90560:(e,t,s)=>{s.d(t,{F:()=>o,h:()=>c});var r=s(5163),a=s(84768),i=s(37647),n=s(14677);const o="confirm_phone",c=(0,i.G)("confirmPhone",(e=>({credentialsApi:t,authApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield t.getToken();if(!r)throw new Error("User is not authorized");return s.confirmPhone(Object.assign(Object.assign({},e),{accessToken:r,locale:a.get("locale")}))}))),(0,a.r)("user",{start:e=>Object.assign(Object.assign({},e),{phone:{[o]:n.qV}}),success:e=>Object.assign(Object.assign({},e),{phone:{[o]:n.YR}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{phone:{[o]:(0,n.UL)(t)}})}))},65164:(e,t,s)=>{s.d(t,{$:()=>a.$,h:()=>r.h});var r=s(90560),a=s(47057)},47057:(e,t,s)=>{s.d(t,{$:()=>c,F:()=>o});var r=s(5163),a=s(84768),i=s(37647),n=s(41560);const o="request_code",c=(0,i.G)("requestConfirmationCode",(e=>({credentialsApi:t,authApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield t.getToken();if(!r)throw new Error("User is not authorized");return s.getPhoneConfirmationCode(Object.assign(Object.assign({},e),{segmentId:e.segmentId||"65573",action:"phone_update",accessToken:r,locale:a.get("locale")}))}))),(0,a.r)("user",{start:e=>Object.assign(Object.assign({},e),{phone:{[o]:n.qV}}),success:e=>Object.assign(Object.assign({},e),{phone:{[o]:n.YR}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{phone:{[o]:(0,n.UL)(t)}})}))},19302:(e,t,s)=>{s.d(t,{z:()=>n});var r=s(5163),a=s(84768),i=s(14677);const n=(0,s(37647).G)("ENTITY/DELETE_PHOTO",(e=>({photoApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{entityId:r,entityType:a,photoId:i}=e,n=yield s.getToken();if(!n)throw new Error("User is not authorized");return t.deletePhoto({objectId:r,objectType:a,photoId:i,accessToken:n})}))),(0,a.r)("photo",{start(e,{params:t}){if(!e[t.photoId])return e;const s=e[t.photoId];if(!s)return e;const r={data:s.data,meta:Object.assign(Object.assign({},s.meta),{crud:"deleting"})};return Object.assign(Object.assign({},e),{[t.photoId]:r})},success(e,{params:t}){if(!e[t.photoId])return e;const s={};for(const r in e)r!==t.photoId&&(s[r]=e[r]);return s},error(e,{params:t}){if(!e[t.photoId])return e;const s=e[t.photoId];if(!s)return e;const r={data:s.data,meta:i.YR};return Object.assign(Object.assign({},e),{[t.photoId]:r})}}),(0,a.r)("entity",{success(e,{params:t,result:s}){if(200!==s.items[0].code)return e;const r=e.photos[t.entityId];if(!r||!r.data)return e;const a=r.data.items;return a.length?Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.entityId]:{meta:r.meta,data:Object.assign(Object.assign({},r.data),{total:r.data.total-1,items:a.filter((e=>e!==t.photoId))})}})}):e}}),(0,a.r)("entity",{success(e,{params:t,result:s}){if(200!==s.items[0].code||!t.userId)return e;const r=e.photos[t.userId];if(!r||!r.data)return e;const a=r.data.items;return a.length?Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.userId]:{meta:r.meta,data:Object.assign(Object.assign({},r.data),{total:r.data.total-1,items:a.filter((e=>e!==t.photoId))})}})}):e}}))},63295:(e,t,s)=>{s.d(t,{k:()=>d});var r=s(5163),a=s(84768),i=s(14677),n=s(37647),o=s(64656);const c={start:(e,{params:t})=>Object.assign(Object.assign({},e),{photos:(0,o.Av)(e.photos,t.id)}),success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{photos:(0,o.Cj)(e.photos,t.id,{items:s.items.map((e=>e.id)),pagesLoaded:t.page||1,total:s.total})}),error(e,{params:t,error:s}){var r;return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.id]:{data:null===(r=e.photos[t.id])||void 0===r?void 0:r.data,meta:(0,i.UL)(s)}})})}},d=(0,n.G)("ENTITY/FETCH_PHOTOS",(e=>({photoApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{id:r,type:i,page:n,pageSize:o}=e,c=yield s.getToken(),d=a.get("locale")||"ru",u="branch"===i?"branch":"geo";return yield t.getPhotos({objectId:r,objectType:u,page:n,locale:d,pageSize:o,accessToken:c})}))),(0,a.r)("entity",c),(0,a.r)("photo",{success(e,{params:t,result:s}){if(!s.items.length)return e;const r=s.items.reduce(((s,r)=>{var a;const i=null===(a=e[r.id])||void 0===a?void 0:a.data,n=r.views_count||i&&"views_count"in i&&i.views_count||void 0,c=!r.is_visible&&i&&"status"in i&&i.status?i.status:r.status;return(0,o.Cj)(s,r.id,Object.assign(Object.assign({},r),{views_count:n,status:c,object:{id:t.id,type:t.type}}))}),{});return Object.assign(Object.assign({},e),r)}}))},48162:(e,t,s)=>{s.d(t,{y:()=>n});var r=s(5163),a=s(84768),i=s(14677);const n=(0,s(37647).G)("fetchUserPhotos",(e=>({photoApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();if(!r)throw new Error("No access token");return t.getUserPhotos(Object.assign(Object.assign({},e),{accessToken:r}))}))),(0,a.r)("photo",{success(e,{params:t,result:s}){if(!s.items.length)return e;const r=s.items.reduce(((e,s)=>{const r=Object.assign(Object.assign({},s),{owner:{id:t.userId}});return e[s.id]={data:Object.assign(Object.assign({},r),{object:r.object?{id:r.object.id_str,type:r.object.type}:void 0}),meta:i.YR},e}),{});return Object.assign(Object.assign({},e),r)}}),(0,a.r)("user",{success(e,{params:t,result:s}){const r=t.userId,a=e.photos[r],n=s.items.reduce(((e,t)=>(e.includes(t.id)||e.push(t.id),e)),[]),o=(null==a?void 0:a.data)?a.data.items:[],c=n.filter((e=>-1===o.indexOf(e))),d=1===t.page?[...c,...o]:[...o,...c];return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[r]:{data:{items:d,total:s.total,pagesLoaded:t.page},meta:i.YR}})})},error(e,{params:t,error:s}){const r=t.userId,a=e.photos[r];return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[r]:{data:a&&a.data,meta:(0,i.UL)(s)}})})}}))},8970:(e,t,s)=>{s.d(t,{t:()=>d});var r=s(5163),a=s(84768),i=s(77386),n=s(14677),o=s(37647),c=s(64656);const d=(0,o.G)("ENTITY/UPLOAD_PHOTO",(e=>({photoApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{objectId:r,objectType:a,temporaryId:i,file:n,locale:o,regionId:c,albumCode:d,isReplaced:u,isMenuPhoto:l}=e,p=yield s.getToken();if(!p)throw new Error("User is not authorized");const h=(yield t.addPhoto({uid:i,objectId:r,objectType:a,albumCode:d,locale:o,regionId:c,accessToken:p,isReplaced:u,isMenuPhoto:l})).items[0];if(!h.hash||!h.id||h.error)throw{name:h.error&&h.error.type,message:h.error&&h.error.message};return t.uploadPhoto({id:h.id,hash:h.hash,file:n,accessToken:p,objectType:a})}))),(0,a.r)("photo",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.temporaryId]:{data:{uid:t.temporaryId,file:t.file,temporary:!0},meta:n.qV}}),success(e,{params:t,result:s}){const r=s.items[0];if(200!==r.code){const s=r.error;return Object.assign(Object.assign({},e),{[t.temporaryId]:Object.assign(Object.assign({},e[t.temporaryId]),{meta:(0,n.UL)({name:s.type,message:s.message})})})}return Object.assign(Object.assign({},e),{[t.temporaryId]:{data:Object.assign(Object.assign({},r),{tempId:t.temporaryId}),meta:n.YR},[r.id]:{data:Object.assign(Object.assign({},r),{object:{id:t.objectId,type:t.objectType}}),meta:n.YR}})},error:(e,{params:t,error:s})=>(0,c.VJ)(e,t.temporaryId,s)}),(0,a.r)("entity",{success(e,{params:t,result:s}){const r=s.items[0];if(200!==r.code||"profile"===t.objectType)return e;const a=e.photos[t.objectId];if(!a||!a.data)return Object.assign(Object.assign({},e),{photos:(0,c.Cj)(e.photos,t.objectId,{items:[r.id],total:1,pagesLoaded:0})});const i=a.data.items;return Object.assign(Object.assign({},e),{photos:(0,c.Cj)(e.photos,t.objectId,Object.assign(Object.assign({},a.data),{total:a.data.total+1,items:[r.id,...i]}))})}}),(0,a.r)("photo",{success(e,{params:t,result:s}){const r=s.items[0];if(200!==r.code||"profile"===t.objectType)return e;const a=(0,i.R)(r,{objectType:t.objectType,user:t.user});return t.onSubmitSuccessCallback&&a&&t.onSubmitSuccessCallback({photo:a}),e}}))},84240:(e,t,s)=>{s.d(t,{L:()=>i,h:()=>n});var r=s(5163),a=s(37647);const i=(0,a.G)("fetchDevices",(()=>({pusherApi:e,credentialsApi:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(!s)throw new Error("There is no access_token");return e.fetchDevices({authToken:s})})))),n=(0,a.G)("pushNotification",(e=>({pusherApi:t,credentialsApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken(),{deviceId:a,title:i,body:n,url:o}=e;if(!r)throw new Error("There is no access_token");const c={authToken:r,deviceId:a,title:i,body:n,url:o};return t.messageMe(c)}))))},20592:(e,t,s)=>{s.d(t,{F:()=>c});var r=s(84768),a=s(37647),i=s(27087),n=s(64656);const o={supermarket:["12127","101979","611","350","373","544","558","363"],education:["683","21044","15287","684","21040","245","15761","687"],kindergarten:["237","110405"],hospital:["201","224","225","203","229","25075","4521","23765","18410","56893","661","12211","4517","16863","226","222","20857","4537","4529","16870"],pharmacy:["207"],sport:["261","267","268","51256","110498"],culture:["193","189","199","200","190","11647","13787","168","51001","10887","51207"],bar:["159"]},c=(0,a.G)("fetchInfrastructure",(e=>({webApi:t,contextApi:s})=>{const{center:r}=e,a=[...o.supermarket,...o.education,...o.kindergarten,...o.hospital,...o.pharmacy,...o.sport,...o.culture,...o.bar];return t.getInfrastructure({center:r,locale:s.get("locale")||"ru_RU",radius:750,rubrIds:a,screen})}),(0,r.r)("realty",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{infrastructure:(0,n.Av)(e.infrastructure,t.buildingId)}),success(e,{params:t,result:s}){const r=("items"in s&&s.items||[]).reduce(((e,t)=>{const s=(0,i.uc)(o).find((e=>!!t.rubr&&o[e].includes(t.rubr)));return s&&e[s].push(t),e}),{supermarket:[],education:[],kindergarten:[],hospital:[],pharmacy:[],sport:[],culture:[],bar:[]});return Object.assign(Object.assign({},e),{infrastructure:(0,n.Cj)(e.infrastructure,t.buildingId,r)})},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{infrastructure:(0,n.VJ)(e.infrastructure,t.buildingId,s)})}))},39738:(e,t,s)=>{s.d(t,{q:()=>c});var r=s(37647),a=s(84768),i=s(64656),n=s(14677);function o(e){const t=Object.assign({},e);return t.on_map&&delete t.on_map,t}const c=(0,r.G)("fetchRealtyMarkers",(e=>({marketApi:t,contextApi:s})=>{const{categoryId:r,viewpoint:a,filters:i,entityId:n}=e;return t.getRealtyMarkers({category_ids:r,viewpoint:a,locale:s.get("locale")||"ru_RU",filters:o(i),geo_id:n})}),(0,a.r)("realty",{start:(e,{uuid:t})=>Object.assign(Object.assign({},e),{markers:(0,i.Av)(e.markers,"default",t),hashmap:(0,i.Av)(e.hashmap,"default",t)}),success(e,{result:t,uuid:s}){if(!t)return e;if(200!==t.code)return 404===t.code?Object.assign(Object.assign({},e),{markers:(0,i.Cj)(e.markers,"default",[],s),hashmap:(0,i.Cj)(e.hashmap,"default",{},s)}):Object.assign(Object.assign({},e),{markers:(0,i.VJ)(e.markers,"default",new Error(`Api have responded with ${t.code}`),s),hashmap:(0,i.VJ)(e.hashmap,"default",new Error(`Api have responded with ${t.code}`),s)});const r=t.items.reduce(((e,t,s)=>(e[t.building_id]=s,e)),{});return Object.assign(Object.assign({},e),{markers:(0,i.Cj)(e.markers,"default",t.items,s),hashmap:(0,i.Cj)(e.hashmap,"default",r,s)})},error(e,{error:t,uuid:s}){const r={default:{data:[],meta:(0,n.UL)(t)}},a={default:{data:{},meta:(0,n.UL)(t)}};return Object.assign(Object.assign({},e),{markers:(0,i.VJ)(r,"default",t,s),hashmap:(0,i.VJ)(a,"default",t,s)})}}))},3300:(e,t,s)=>{s.d(t,{F:()=>n});var r=s(37647),a=s(84768),i=s(64656);const n=(0,r.G)("fetchWalkDistance",(e=>({diskApi:t})=>t.getWalkDistanceData({regionId:e.regionId})),(0,a.r)("walkDistance",{start:(e,{params:t})=>(0,i.Av)(e,t.regionId),success:(e,{result:t,params:s})=>(0,i.Cj)(e,s.regionId,t.features),error:(e,{params:t,error:s})=>(0,i.VJ)(e,t.regionId,s)}))},69937:(e,t,s)=>{s.d(t,{VM:()=>o,fT:()=>i,g7:()=>n});var r=s(5163),a=s(37647);const i=(0,a.G)("fetchReviewComments",(e=>({reviewsApi:t,contextApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){return t.getReviewComments(Object.assign(Object.assign({},e),{locale:s.get("locale")||""}))})))),n=(0,a.G)("sendReviewCommentAnswer",(e=>({reviewsApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();if(!r)throw new Error("No access token");return t.sendReviewCommentAnswer(Object.assign(Object.assign({},e),{accessToken:r,locale:a.get("locale")||""}))})))),o=(0,a.G)("removeReviewComment",(e=>({reviewsApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();if(!r)throw new Error("No access token");return t.deleteComment(Object.assign(Object.assign({},e),{accessToken:r,locale:a.get("locale")||""}))}))))},69838:(e,t,s)=>{s.d(t,{J:()=>r});const r=(0,s(37647).G)("fetchReviewsFacts",(e=>({reviewsApi:t,contextApi:s})=>t.getFacts(Object.assign(Object.assign({},e),{locale:s.get("locale")||""}))))},47915:(e,t,s)=>{s.d(t,{X:()=>o});var r=s(5163),a=s(41560),i=s(87325),n=s(84768);const o=(0,s(37647).G)("CreateReview",(e=>({reviewsApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{entityId:r,entityType:n,rating:o,text:c,reviewSourceId:d,photos:u,skipValidation:l}=e,p=yield s.getToken();if(!p)throw new Error("There is no access_token");if(c.length>0&&!l){const{bad_words_warning:e}=yield t.validateReview({text:c,locale:a.get("locale")||""});if(e)throw(0,i.fe)("Отзыв содержит оскорбления или слова, употребление которых может грозить автору ответственностью",e)}return t.createReview({id:r,type:"branch"===n?"branch":"geo",rating:o,text:c,accessToken:p,sourceId:d,photos:u,locale:a.get("locale")||""})}))),(0,n.r)("review",{start(e,{params:t}){const{temporaryId:s,rating:r,text:i}=t,n={data:{id:s,text:i,rating:r,temporary:!0},meta:a.qV};return Object.assign(Object.assign({},e),{[s]:n})},success(e,{params:t,result:s}){const{temporaryId:r}=t,i=s.items[0];return i?Object.assign(Object.assign({},e),{[r]:{data:i,meta:a.YR},[i.id]:{data:i,meta:a.YR}}):e},error(e,{params:t,error:s}){const{temporaryId:r}=t,i=e[r];return i&&i.data?Object.assign(Object.assign({},e),{[r]:{data:i.data,meta:(0,a.UL)(s)}}):e}}),(0,n.r)("reviewSearch",{success(e,{params:t,result:s}){const{reviewSearchId:r}=t;if(!r)return e;const a=r,i=e[r],n=s.items[0]&&s.items[0].id;if(!i)return e;const o=i.data;if(!o)return e;const c=i.data&&i.data.items||[];return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},i),{data:Object.assign(Object.assign({},o),{items:[n].concat(c),total:o.total+1})})})}}))},51002:(e,t,s)=>{s.d(t,{k:()=>o});var r=s(5163),a=s(87325),i=s(64656),n=s(84768);const o=(0,s(37647).G)("EditReview",(e=>({reviewsApi:t,credentialsApi:s,contextApi:i})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{text:r,skipValidation:n}=e,o=yield s.getToken();if(!o)throw new Error("There is no access_token");if(r.length>0&&!n){const{bad_words_warning:e}=yield t.validateReview({text:r,locale:i.get("locale")||""});if(e)throw(0,a.fe)("Отзыв содержит оскорбления или слова, употребление которых может грозить автору ответственностью",e)}return t.editReview(Object.assign(Object.assign({},e),{accessToken:o,locale:i.get("locale")||""}))}))),(0,n.r)("review",{start:(e,{params:t})=>(0,i.Av)(e,t.id),success(e,{result:t,params:s}){var r;const a=t.items[0],n=(null===(r=e[s.id])||void 0===r?void 0:r.data)||a;return(0,i.Cj)(e,s.id,Object.assign(Object.assign({},a),{object:n.object}))},error:(e,{error:t,params:s})=>(0,i.VJ)(e,s.id,t)}))},9595:(e,t,s)=>{s.d(t,{T:()=>a});var r=s(5163);const a=(0,s(37647).G)("setReviewLike",(e=>({reviewsApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const{id:r,value:i}=e,n=yield s.getToken();if(!n)throw new Error("There is no access_token");return!0===i?t.likeReview({id:r,accessToken:n,locale:a.get("locale")||""}):t.unlikeReview({id:r,accessToken:n,locale:a.get("locale")||""})}))))},42392:(e,t,s)=>{s.d(t,{A:()=>c});var r=s(37647),a=s(84768),i=s(5160),n=s(64656);const o={items:[(0,i.N)("Поесть","eat","110539"),(0,i.N)("АЗС","gasoline_station","18547"),(0,i.N)("Аптеки","pharmacies","207"),(0,i.N)("Гостиницы","hotels","269")],code:200},c=(0,r.G)("fetchDashboard",(e=>({webApi:t})=>"0"===e.regionId?Promise.resolve(o):t.getDashboard(e)),(0,a.r)("rubric",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{dashboard:(0,n.Av)(e.dashboard,t.dashboardId)}),success:(e,{params:t,result:s})=>200===s.code&&s.items&&s.items.length?Object.assign(Object.assign({},e),{dashboard:(0,n.Cj)(e.dashboard,t.dashboardId,s.items.filter((e=>e.icon_url&&"112786"!==e.id)))}):e,error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{dashboard:(0,n.VJ)(e.dashboard,t.dashboardId,s)})}))},32098:(e,t,s)=>{s.d(t,{b:()=>n});var r=s(37647),a=s(84768);const i=e=>"pseudorubric"===e.type?e.id||e.owner_id:e.id,n=(0,r.G)("fetchRubric",(e=>({webApi:t})=>t.getRubric(e)),(0,a.r)("rubricator",{success(e,{result:t}){if(!t||!t.items)return e;const s=t.items.reduce(((e,t)=>Object.assign(Object.assign({},e),{[i(t)]:t})),{});return Object.assign(Object.assign({},e),{items:Object.assign(Object.assign({},e.items),s)})}}))},95271:(e,t,s)=>{s.d(t,{F:()=>c});var r=s(37647),a=s(84768),i=s(14677),n=s(64656);const o=e=>"pseudorubric"===e.type?e.id||e.owner_id:e.id,c=(0,r.G)("fetchRubricator",(e=>({webApi:t})=>t.getRubricatorList(e)),(0,a.r)("rubricator",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{lists:(0,n.Av)(e.lists,t.key)}),success(e,{params:t,result:s}){if(!s||!s.items)return Object.assign(Object.assign({},e),{lists:Object.assign(Object.assign({},e.lists),{[t.key]:{meta:(0,i.Mq)()}})});const r=s.items.map(o),a=s.items.reduce(((e,t)=>Object.assign(Object.assign({},e),{[o(t)]:t})),{});return Object.assign(Object.assign({},e),{lists:(0,n.Cj)(e.lists,t.key,r),items:Object.assign(Object.assign({},e.items),a)})},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{lists:(0,n.VJ)(e.lists,t.key,s)})}))},59137:(e,t,s)=>{s.d(t,{of:()=>n,r1:()=>o,ui:()=>i});var r=s(82603),a=s(97698);const i=()=>(0,a.P1)([({key:e})=>e,({state:e})=>e.data.rubricator.lists,({state:e})=>e.data.rubricator.items],((e,t,s)=>{const a=t[e];if(a&&a.data)return(0,r.oA)(a.data.map((e=>s[e])))})),n=e=>t=>t.data.rubricator.items[e],o=e=>t=>t.data.rubricator.lists[e]},54747:(e,t,s)=>{s.d(t,{J:()=>a});var r=s(82603);const a=(e,t,s)=>(0,r.oA)([e,s,t]).join("_")},63429:(e,t,s)=>{s.d(t,{D:()=>i});var r=s(84768),a=s(41560);const i=(0,s(37647).G)("createShortLink",(e=>({shortonizerApi:t})=>t.createShortLink(e.url)),(0,r.r)("shortonizer",{start(e,{params:t}){const s={data:void 0,meta:a.qV};return Object.assign(Object.assign({},e),{[t.url]:s})},success(e,{params:t,result:s}){const r={data:s,meta:a.YR};return Object.assign(Object.assign({},e),{[t.url]:r})},error(e,{params:t}){const s=t.url,r=Object.assign({},e);return delete r[s],r}}))},53342:(e,t,s)=>{s.d(t,{S:()=>r});const r=(0,s(37647).G)("fetchTrafficScore",(e=>({trafficApi:t})=>t.trafficScore(e)))},43997:(e,t,s)=>{s.d(t,{s:()=>r});const r=e=>t=>t.data.traffic[e]},44878:(e,t,s)=>{s.d(t,{j:()=>c,m:()=>o});var r=s(5163),a=s(37647),i=s(34291),n=s(41560);const o=(0,a.G)("actualizeUserInfo",(()=>({authApi:e,credentialsApi:t})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(s)return e.getUserInfo({accessToken:s});throw new Error("There is no access token")})))),c=(0,i.KX)("actualizeUserInfo",{success:(e,{result:t})=>({default:{data:Object.assign(Object.assign({},t.data),{access_token:t.access_token}),meta:n.YR}}),error:(e,{error:t})=>({default:{data:void 0,meta:(0,n.UL)(t)}})})},72563:(e,t,s)=>{s.d(t,{K:()=>d});var r=s(5163),a=s(25310),i=s(37647),n=s(64841),o=s(33558),c=s(28317);const d=(0,i.G)("clearPersonalData",(e=>({favoritesStorage:t,profileApi:s})=>(0,r.mG)(void 0,void 0,void 0,(function*(){yield Promise.all([t.clearPersonal(),t.clearPlaces(),n.tO.local.removeItem(o.d),e.doNotClearHistoryInProfileApi?void 0:s.clearSearchHistory(),a.r.removeStore("history","history"),(0,c.E)()])}))))},42067:(e,t,s)=>{s.d(t,{a:()=>i});var r=s(5163),a=s(84768);const i=(0,s(37647).G)("deleteUserProfile",(e=>({authApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken(),i=yield a.get("locale");if(!r)throw new Error("No access token");return t.deleteProfile(Object.assign(Object.assign({},e),{locale:i,accessToken:r}))}))),(0,a.r)("user",{success:e=>Object.assign(Object.assign({},e),{info:{default:void 0}})}),(0,a.r)("photo",{success:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.userId]:void 0})}))},938:(e,t,s)=>{s.d(t,{r:()=>c,y:()=>u});var r=s(5163),a=s(37647),i=s(34291),n=s(64656),o=s(14677);const c=(0,a.G)("fetchUserReviewsByObject",(e=>({reviewsApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){const r=yield s.getToken();if(!r)throw new Error("There is no access token in fetchUserReviewsByObject");return t.getUserReviewsByObject(Object.assign(Object.assign({},e),{accessToken:r,locale:a.get("locale")||""}))})))),d=(0,i.Rs)("fetchUserReviewsByObject","review",{success(e,{result:t}){if(!t.items.length)return e;const s=t.items.reduce(((e,t)=>(e[t.id]={data:t,meta:o.YR},e)),{});return Object.assign(Object.assign({},e),s)}}),u=[(0,i.Rs)("fetchUserReviewsByObject","user",{start:(e,{params:{entityId:t}})=>Object.assign(Object.assign({},e),{pinnedReviews:(0,n.Av)(e.pinnedReviews,t)}),error:(e,{params:{entityId:t},error:s})=>Object.assign(Object.assign({},e),{pinnedReviews:(0,n.VJ)(e.pinnedReviews,t,s)}),success(e,{params:{entityId:t},result:s}){var r;const a=(null===(r=s.items[0])||void 0===r?void 0:r.id)?[s.items[0].id]:[],i=s.total?o.YR:(0,o.Mq)();return Object.assign(Object.assign({},e),{pinnedReviews:Object.assign(Object.assign({},e.pinnedReviews),{[t]:{data:{items:a,total:s.total},meta:i}})})}}),d]},93697:(e,t,s)=>{s.d(t,{g:()=>c});var r=s(5163),a=s(37647),i=s(84768),n=s(14677);const o="default",c=(0,a.G)("updateUserInfo",(e=>({authApi:t,credentialsApi:s,contextApi:a})=>(0,r.mG)(void 0,void 0,void 0,(function*(){var r,i;const n=yield s.getToken();if(n)return t.updateUserInfo(Object.assign(Object.assign({accessToken:n,locale:a.get("locale")},e),{userInfo:Object.assign(Object.assign({},e.userInfo),{public_identity_accepted:null===(i=null===(r=e.userInfo)||void 0===r?void 0:r.public_identity_accepted)||void 0===i?void 0:i.toString()})}));throw new Error("There is no access token")}))),(0,i.r)("user",{success:(e,{result:t})=>Object.assign(Object.assign({},e),{info:{[o]:{data:t,meta:n.YR}}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{info:{[o]:{data:void 0,meta:(0,n.UL)(t)}}})}))},64049:(e,t,s)=>{s.d(t,{k:()=>r});const r=(e,t)=>e.includes(t)},20115:(e,t,s)=>{function r(e,t){return t<0||t>=e.length?e:[...e.slice(0,t),...e.slice(t+1)]}s.d(t,{O:()=>r})},19888:(e,t,s)=>{function r(e,t,s){return s<0||s>=e.length?e:[...e.slice(0,s),t,...e.slice(s+1)]}s.d(t,{g:()=>r})},30033:(e,t,s)=>{function r(e,t){return e<=0?[]:Array(e).fill("").map(((e,s)=>t(s)))}s.d(t,{D:()=>r})},91122:(e,t,s)=>{function r(e,t){const s={};return e.filter((e=>{const r=t(e);return!s[r]&&(s[r]=!0,!0)}))}s.d(t,{m:()=>r})},80531:(e,t,s)=>{function r(e,t,s){return[Math.round(255*e),Math.round(255*t),Math.round(255*s)]}function a(e,t,s){let r=s;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}s.d(t,{c:()=>o});var i=s(88834),n=s(39475);function o(e,t){const[s,o]=function(e){const t=e[0]/255,s=e[1]/255,r=e[2]/255,a=Math.max(t,s,r),i=Math.min(t,s,r),n=a-i;let o=0;0===n?o=0:a===t?o=(s-r)/n%6:a===s?o=(r-t)/n+2:a===r&&(o=(t-s)/n+4);const c=(i+a)/2;return[60*o,0===n?0:n/(1-Math.abs(2*c-1)),c]}((0,i.o)(e));return(0,n.v)(function(e){const t=e[0]/360,s=e[1],i=e[2];if(0===s)return r(i,i,i);const n=i<.5?i*(1+s):i+s-i*s,o=2*i-n;return r(a(o,n,t+1/3),a(o,n,t),a(o,n,t-1/3))}([s,o,t]))}},48956:(e,t,s)=>{function r(e){const t=e[0]/255,s=e[1]/255,r=e[2]/255;return.2126*a(t)+.7152*a(s)+.0722*a(r)}function a(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function i(e,t){return function(e,t){if(0===e.length)return;let s=e[0],r=t(s);for(let a=1;a<e.length;a++){const i=t(e[a]);i>r&&(s=e[a],r=i)}return s}(t,(t=>function(e,t){const s=(r(e)+.05)/(r(t)+.05);return s>1?s:1/s}(t,e)))||e}s.d(t,{N:()=>i})},88834:(e,t,s)=>{s.d(t,{o:()=>a});var r=s(11165);function a(e){const t=(0,r.t)(e);return[parseInt(`${t[1]}${t[2]}`,16),parseInt(`${t[3]}${t[4]}`,16),parseInt(`${t[5]}${t[6]}`,16)]}},11165:(e,t,s)=>{s.d(t,{t:()=>i});const r=/^#[a-f0-9]{6}$/,a=/^#[a-f0-9]{3}$/;function i(e){const t=e.toLowerCase();return r.test(t)?t:a.test(t)?`#${e[1]}${e[1]}${e[2]}${e[2]}${e[3]}${e[3]}`:"#000000"}},11259:(e,t,s)=>{s.d(t,{X:()=>i});var r=s(11165),a=s(90095);function i(e,t){const s=(0,r.t)(e).substr(1),i=function(e){const t=Math.round(255*(0,a.uZ)(e,0,1)).toString(16);return 1===t.length?"0"+t:t}(t);return`#${s}${i}`}},39475:(e,t,s)=>{function r([e,t,s]){return"#"+a(e)+a(t)+a(s)}function a(e){const t=e.toString(16);return 1===t.length?"0"+t:t}s.d(t,{v:()=>r})},84316:(e,t,s)=>{s.d(t,{GK:()=>a});s(28629);var r=s(82603);function a(e,t,s="unknown key"){if("string"==typeof e)return t;if("number"==typeof e){const e=Number(t);if(e!=e||""===t.trim())throw new Error(`Invalid number env config value (${s}): "${t}"`);return e}if("boolean"==typeof e)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;default:throw new Error(`Invalid boolean env config value (${s}): ${t}`)}if(Array.isArray(e)){const e=JSON.parse(t);if(Array.isArray(e))return e;throw new Error(`Invalid array env config value (${s}): ${t}`)}if((0,r.Kn)(e)){const e=JSON.parse(t);if((0,r.Kn)(e))return e;throw new Error(`Invalid object env config value (${s}): ${t}`)}throw new Error(`Config value is not a string/number/boolean/array/object (${s})`)}},79148:(e,t,s)=>{s.d(t,{Sb:()=>l,ZW:()=>d,fm:()=>c});var r=s(18584),a=s(82603),i=s(28176);const n="|",o=";";function c(e){const t=e.reduce(((e,t)=>t&&(0,a.$K)(t.lonLat)?e.concat((0,a.oA)([(0,i.S)(t.lonLat),"entityId"in t&&t.entityId]).join(o)):e),[]),s=e[0];return(!s||l(s)&&!(0,a.$K)(s.lonLat))&&t.length&&t.unshift(""),t.join(n)}function d(e){if(!e)return[];const t=e.split(n),s=t.reduce(((e,t)=>{const s=u(t);return s?e.concat(s):e}),[]);return s.length&&!t[0]?[void 0,...s]:s}function u(e,t=o){const s=e.split(t),a=(0,r.v)(s[0]);if(!a)return;const i=s[1];return/^\d+$/.test(i)?{type:"point",lonLat:a,entityId:i}:{type:"point",lonLat:a}}function l(e){return!!e&&"location"===e.type}},30485:(e,t,s)=>{s.d(t,{X:()=>a});var r=s(25278);function a(e){const t=e.split(".").pop();return e.includes("urbi-sa")&&"com"===t||t?r.wp[t]:void 0}},61789:(e,t,s)=>{s.d(t,{RG:()=>n});var r=s(30485),a=s(25278);const i="174";function n(e,t,s){return e.endsWith(".web-staging.2gis.ru")?function(e,t,s){const a=e.match(/([^.]+)\.?(.*)\.web-staging\.2gis\.ru/);if(!a)return;const n=a[1],c=a[2];let d=t;if(!c&&"ru"===d)return;if(s&&s===i){d="ru"===(0,r.X)(c)?"ru":"ua"}const u=o(c||"2gis.ru",d);if(!u)return;return`${n}.${u}.web-staging.2gis.ru`}(e,t,s):o(e,t,s)}function o(e,t,s){let n=t;if("sa"===n&&!/urbi-sa\.(com|4geo\.info)$/.test(e))return"urbi-sa.com";if("iq"===n&&!/urbi-iq\.(com|4geo\.info)$/.test(e))return"urbi-iq.com";if("eg"===n&&!/urbi-eg\.(com|4geo\.info)$/.test(e))return"urbi-eg.com";if("om"===n&&!/urbi-om\.(com|4geo\.info)$/.test(e))return"urbi-om.com";if("bh"===n&&!/urbi-bh\.4geo\.info$/.test(e)&&!/urbi\.bh$/.test(e))return"urbi.bh";if("qa"===n&&!/urbi-qa\.4geo\.info$/.test(e)&&!/urbi\.qa$/.test(e))return"urbi.qa";if("kw"===n&&!/urbi-kw\.(com|4geo\.info)$/.test(e))return"urbi-kw.com";if("ae"===n&&/urbi-ae\.4geo\.info$/.test(e))return;const o=e.replace(/(^|\.)urbi\.ae$/,"$12gis.ae"),c=(0,r.X)(o);s&&s===i&&(n="ru"===c?"ru":"ua");const d=a.wp[n];if(!c||!d||c===d)return;const u=o.lastIndexOf(c);return-1!==u?o.substr(0,u)+d:void 0}},30007:(e,t,s)=>{s.d(t,{J:()=>a,Z:()=>d,dx:()=>u,n:()=>i,t:()=>n,v:()=>c});let r=!1;function a(e){r=!e}function i(e){return r||!e?{}:{"data-n":e}}function n(e){return r||!e?{}:{"data-t":e}}function o(...e){return r?{}:{"data-s":e.filter((e=>!!e)).join(" ")||void 0}}function c(e){return r||!e?{}:{"data-v":`${e}`}}function d(e){return r?{}:Object.assign(Object.assign(Object.assign(Object.assign({},i(e.n)),n(e.t)),o(...(t=e.s,t?"string"==typeof t?[t]:t:[]))),c(e.v));var t}const u={s:o,n:i,t:n,v:c}},34291:(e,t,s)=>{s.d(t,{GW:()=>n,KX:()=>a.KX,Rs:()=>i.R,aq:()=>a.aq,xr:()=>a.xr});var r=s(82603),a=s(53806),i=s(71372);function n(e,t,...s){return a=>({type:`effect(${e})`,payload:{name:e,params:a,phase:"start",handler:t,uuid:(0,r.by)()},effect:!0,reducers:s})}},53806:(e,t,s)=>{function r(e){const{effect:t,payload:s}=e;return t&&"start"===s.phase}function a(e,t){return(s,r)=>{if(!function(e,t){return!0===e.effect&&e.payload.name===t}(r,e))return s;switch(r.payload.phase){case"start":return t.start?t.start(s,r.payload):s;case"success":return t.success?t.success(s,r.payload):s;case"error":return t.error?t.error(s,r.payload):s}return s}}function i(e,t,s){const r=a(e,s);return(e=t,s)=>r(e,s)}function n(e,t){return{type:`effect(${e.payload.name}):success`,payload:{uuid:e.payload.uuid,name:e.payload.name,params:e.payload.params,phase:"success",result:t},reducers:e.reducers,effect:!0}}function o(e,t){return{type:`effect(${e.payload.name}):error`,payload:{uuid:e.payload.uuid,name:e.payload.name,params:e.payload.params,phase:"error",error:t},reducers:e.reducers,effect:!0}}function c(e){return(t,s)=>{switch(s.payload.phase){case"start":return e.start?e.start(t,s.payload):t;case"success":return e.success?e.success(t,s.payload):t;case"error":return e.error?e.error(t,s.payload):t}return t}}s.d(t,{Co:()=>o,KX:()=>a,aq:()=>c,go:()=>n,ly:()=>r,xr:()=>i})},28629:(e,t,s)=>{s.d(t,{e:()=>i});var r=s(82603);function a(e){if(t=e,(0,r.Kn)(t)&&"message"in t&&"string"==typeof t.message)return e;var t;try{return new Error(JSON.stringify(e))}catch(t){return new Error(String(e))}}function i(e){return a(e).message}},15111:(e,t,s)=>{s.d(t,{d:()=>a});var r=s(82603);function a(e){if((0,r.Kn)(e)&&"stack"in e&&"string"==typeof e.stack)return e.stack}},78006:(e,t,s)=>{s.d(t,{X:()=>i});var r=s(30595);var a=s(91875);function i(e,t={}){const s=Object.assign({},t),{valueType:i,name:n,value:o,isChecked:c}=e;if(!n||!o)return s;const d=t&&t[n]||"";let u;switch(i){case"multiple":const e=(0,a.X)(d),t=e.indexOf(o),s=-1!==t;c&&!s?e.push(o):!c&&s&&e.splice(t,1),u=e.join(r.Ad);break;case"single":u=c?o:""}return u=!u&&e.defaultValue?e.defaultValue:u,!u&&n in s?delete s[n]:u&&s[n]!==u&&(s[n]=u),s}},96722:(e,t,s)=>{s.d(t,{C:()=>a});var r=s(30595);function a(e,t){return`${e}${r.Ad}${t}`}},73076:(e,t,s)=>{s.d(t,{n8:()=>n});var r=s(91326),a=s(82603);const i=["rating_rating_excellent","rating_rating_nice","rating_rating_pretty_good","rating_rating_perfect","rating_rating_not_bad"];function n(e,t={}){const s=(0,r.f)(e);return s?o(s,t):t}function o(e,t){const{value:s,name:r}=e;if(!r)return Object.assign({},t);if(i.includes(r)){const e=Object.assign({},(0,a.CE)(t,i));return Object.assign(Object.assign({},e),{[r]:s})}return s?Object.assign(Object.assign({},t),{[r]:s}):Object.assign({},(0,a.CE)(t,[r]))}},91326:(e,t,s)=>{function r(e){const{value:t,name:s,isChecked:r}=e;if(t)return s?{name:s,value:r?t:""}:{name:t,value:r?"true":""}}s.d(t,{f:()=>r})},41485:(e,t,s)=>{function r(e){const t=e.match(/^[a-z]\w*_(\d+)$/);return t&&t[1]||""}s.d(t,{$:()=>r})},30595:(e,t,s)=>{s.d(t,{AN:()=>r,Ad:()=>n,ER:()=>i,ZA:()=>o,kp:()=>a});const r="=",a=";",i=",",n=",",o="+"},50976:(e,t,s)=>{function r(e,t,s){return s.replace("%d1",String(e)).replace(/%d2\s*/,`${String(t)} `).trim()}s.d(t,{d:()=>r})},91875:(e,t,s)=>{s.d(t,{X:()=>a});var r=s(30595);function a(e){return e?e.split(r.ER):[]}},61244:(e,t,s)=>{s.d(t,{E:()=>a});var r=s(30595);function a(e){return e.split(r.ER).splice(0,2)}},92095:(e,t,s)=>{s.d(t,{Z:()=>r});const r=function(...e){const t=e?e.length:0;return function(...s){let r=0,a=t?e[r].apply(this,s):s[0];for(;++r<t;)a=e[r].call(this,a);return a}}},25521:(e,t,s)=>{function r(){const e={append:()=>{}};return"undefined"!=typeof FormData?new FormData:e}s.d(t,{O:()=>r})},59851:(e,t,s)=>{s.d(t,{gm:()=>u});var r=s(5163),a=s(52322),i=s(2784),n=s(28629),o=s(89003);function c(e,t){const s=function(e){const t=(0,i.useRef)(e);if(t.current===e)return e;if(function(e,t){if(e.length!==t.length)return!1;return e.every(((e,s)=>(0,o.w)(e,t[s])))}(t.current,e))return t.current;return e}(t);return(0,i.useMemo)(e,s)}const d=i.createContext({});function u(){const e=d;return{withFormatter:(t=e,function(e,s=h){return function(i){return n=>{const{render:o}=n,c=(0,r._T)(n,["render"]),[d,u]=p(e,c,t);if(void 0===u&&void 0===d)return null;const l=u?s(u):(0,a.jsx)(i,Object.assign({},c,d));return o?o(l):l}}}),FormatterProvider:e.Provider,useFormatter:l(e),FormatterContextConsumer:e.Consumer};var t}function l(e){return function(t,s){const r=p(t,s,e);if(r[1]){0,m(r[1])}return r[0]}}function p(e,t,s){const r=i.useContext(s);return c((()=>{try{return[e(t,r),void 0]}catch(e){return e instanceof g?[void 0,e.self]:[void 0,{status:"error",error:e instanceof Error?e:new Error(`Unknown formatter error ${(0,n.e)(e)}`)}]}}),[t])}const h=e=>{m(e)};new Error("Formatter failed");class g{constructor(e){this.self=e}}function m(e){if("loading"===e.status)throw new Error("Unexpected loading placeholder");throw e.error}},10061:(e,t,s)=>{s.d(t,{i:()=>a});var r=s(89003);function a(e){let t,s;return a=>(t&&(0,r.w)(t,a)||(t=a,s=e(a)),s)}},9421:(e,t,s)=>{s.d(t,{t:()=>a});var r=s(2784);function a(e,t){(0,r.useEffect)((()=>{const s=s=>{e.current&&!e.current.contains(s.target)&&t()};return document.addEventListener("mousedown",s),document.addEventListener("touchstart",s),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s)}}),[e,t])}},57010:(e,t,s)=>{s.d(t,{k:()=>a});var r=s(2784);function a(e,t,s){const a=(0,r.useRef)(null);(0,r.useEffect)((()=>{const r=()=>{!function(e,t,s){i(e),e.current=setTimeout(t,s)}(a,t,s)},n=()=>{i(a)};return r(),e.current&&(e.current.addEventListener("mouseenter",n),e.current.addEventListener("mouseleave",r)),()=>{n(),e.current&&(e.current.removeEventListener("mouseenter",n),e.current.removeEventListener("mouseleave",r))}}),[e.current])}function i(e){clearTimeout(e.current)}},25310:(e,t,s)=>{s.d(t,{r:()=>i});var r=s(82603);const a="undefined"==typeof window;class i{static removeStore(e,t){try{(0,r.Ed)(localStorage,((s,r)=>{const a=r.split(".");a[0]===e&&a[1]===t&&localStorage.removeItem(r)}))}catch(e){}}static forEachDbKey(e,t,s){try{(0,r.Ed)(localStorage,((r,a)=>{const i=a.split(".");i[0]===e&&i[2]===t&&s(JSON.parse(r),a)}))}catch(e){}}constructor(e,t){this.dbName=e,this.storeName=t,this.meta={},this.prefix=this.dbName+"."+this.storeName+".",a||this.get("__meta").then((e=>this.meta=e)).catch((()=>this.set("__meta",{})))}get(e){try{const t=localStorage.getItem(this.prefix+e);return null===t?Promise.reject(`no such key in storage: ${this.prefix+e}`):Promise.resolve(JSON.parse(t))}catch(e){return Promise.reject(e)}}set(e,t){try{const s=JSON.stringify(t);return this.meta[e]=!0,localStorage.setItem(this.prefix+e,s),"__meta"!==e&&this.updateMeta(),Promise.resolve()}catch(e){return Promise.reject(e)}}delete(e){for(const t of e)delete this.meta[t],localStorage.removeItem(this.prefix+t);this.updateMeta()}clear(){for(const e in this.meta)this.meta.hasOwnProperty(e)&&localStorage.removeItem(this.prefix+e);return this.meta={},this.updateMeta(),Promise.resolve()}getAll(e,t){const s=Object.keys(this.meta).sort(((e,s)=>t?e<s?1:e>s?-1:0:e>s?1:e<s?-1:0)).slice(e);return Promise.all(s.map((e=>this.get(e))))}updateMeta(){return this.set("__meta",this.meta)}}},79225:(e,t,s)=>{function r(e){return e.intended}function a(e){return e.actual}function i(e){return{intended:e,actual:e}}function n(e,t){return e.intended!==t?{intended:t,actual:e.actual}:e}function o(e){return i(e.intended)}function c(e){return i(e.actual)}s.d(t,{Gp:()=>a,Ue:()=>i,_e:()=>o,d1:()=>c,gg:()=>n,sG:()=>r})},6053:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});const r=!1},49918:(e,t,s)=>{s.d(t,{l:()=>a,v:()=>i});const r=":";function a(e,t){return`${e}${r}${t}`}function i(e){const t=e.split(r);return{productId:t.slice(0,t.length-1).join(r),branchId:t[t.length-1]}}},90095:(e,t,s)=>{function r(e,t,s){return Math.max(Math.min(e,s),t)}s.d(t,{uZ:()=>r})},38042:(e,t,s)=>{function r(e,t=1){if(0===t||!isFinite(t))return e;const s=Math.round(e/t)*t;return parseFloat(s.toFixed(8))}s.d(t,{s:()=>r})},15818:(e,t,s)=>{function r(e,...t){let s=e;for(;t.length>0;){if(null==s)return;s=s[t.shift()]}return s}s.d(t,{U:()=>r})},27087:(e,t,s)=>{s.d(t,{uc:()=>r.u,ei:()=>n,s0:()=>a});s(82603);var r=s(24199);function a(e){return void 0!==Object.values?Object.values(e):i(e)}function i(e){const t=Array(Object.keys(e).length);let s=0;for(const r in e)e.hasOwnProperty(r)&&(t[s]=e[r],s+=1);return t}function n(e,t){const s={};for(const r of t)e.hasOwnProperty(r)&&(s[r]=e[r]);return s}},24199:(e,t,s)=>{function r(e){return"object"!=typeof e?[]:Object.keys(e)}s.d(t,{u:()=>r})},79207:(e,t,s)=>{function r(e){const t={};let s=!1;for(const r in e){const a=e[r];void 0!==a?t[r]=a:s=!0}return s?t:e}s.d(t,{Y:()=>r})},89003:(e,t,s)=>{s.d(t,{w:()=>a});const r=Object.prototype.hasOwnProperty,a=(e,t)=>{if(e===t)return!0;if("object"!=typeof e||null===e)return!1;if("object"!=typeof t||null===t)return!1;const s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;for(let a=0;a<s.length;a++){const o=s[a];if(!r.call(t,o)||(i=e[o],n=t[o],!(i===n?0!==i||0!==n||1/i==1/n:i!=i&&n!=n)))return!1}var i,n;return!0}},93108:(e,t,s)=>{function r(e,t,s){const r=new IntersectionObserver(s,t);return r.observe(e),r}s.d(t,{A:()=>r})},38091:(e,t,s)=>{s.d(t,{Rr:()=>c,d7:()=>o,hG:()=>d});var r=s(89644),a=s.n(r),i=s(68671),n=s(82603);class o{constructor(e){this.details=e}}function c(e){return e instanceof o&&((0,n.U2)(e,"details.response.status")||(0,n.U2)(e,"details.code"))||""}function d(e,t={GDPRAllowedServiceHosts:[]}){const s=function(e){if(i.sk||!e.analyticsBssEnableTestHandles)return;const t=window;return t.testHandles=t.testHandles||{},t.testHandles.XHRActive=[],t.testHandles}(e);return(r,i={})=>{const n=Object.assign(Object.assign(Object.assign({method:"get",withCredentials:!1,timeout:e.networkTimeout},i),t.headers&&{headers:Object.assign(Object.assign({},t.headers),i.headers)}),{url:u(r,{useHttps:t.useHttps,hostname:e.hostname}),httpAgent:t.httpAgent,httpsAgent:t.httpsAgent});e.enableProxy&&(n.proxy={host:e.proxyHost,port:e.proxyPort}),i.timeout&&(n.timeout=i.timeout),e.transformRequest&&(n.transformRequest=e.transformRequest),s&&s.XHRActive.push(r);return e.featureReadOnly&&!t.GDPRAllowedServiceHosts.some((e=>r.includes(e)))?Promise.reject({message:"GDPR blocked service",skipLog:!0}):a().request(n).then((e=>(l(r,s),e))).catch((e=>{throw l(r,s),new o(e)}))}}function u(e,t){const{hostname:s,useHttps:r}=t;let a=e;return i.sk&&"/"===e[0]&&"/"!==e[1]&&(a=`//${s}${a}`),i.sk&&a.startsWith("//")&&(a=`${r?"https":"http"}:${a}`),a}function l(e,t){t&&t.XHRActive.find(((s,r)=>(s===e&&t.XHRActive.splice(r,1),!1)))}},37144:(e,t,s)=>{function r(e,t=!1,s=o){let r,a;const c=t?i:n;return(...t)=>(c(t,r,s)||(a=e(...t),r=t),a)}function a(e,t,s){return function(e,...t){return(s,a)=>{const i=e(a,...t);return r(((e,t,...r)=>{const a=s.map((s=>s(e,t,...r)));return i(...a)}))}}(r,!!s&&s.compareByFirstArgOnly)(e,t)}function i(e,t,s){return!!t&&s(e[0],t[0])}function n(e,t,s){return!(!t||t.length!==e.length)&&e.every(((e,r)=>s(e,t[r])))}function o(e,t){return e===t}s.d(t,{HP:()=>r,P1:()=>a})},17876:(e,t,s)=>{function r(e){if("undefined"!=typeof navigator&&"sendBeacon"in navigator){const t=new Blob([JSON.stringify(e)],{type:"application/json"});return navigator.sendBeacon("/_/metrics",t)}}s.d(t,{y:()=>r})},45537:(e,t,s)=>{s.d(t,{Dc:()=>m,Mf:()=>o,PQ:()=>l,Rh:()=>u,WC:()=>h,XJ:()=>p,Yz:()=>i,ZT:()=>g,ev:()=>a,gQ:()=>c,vP:()=>n,xJ:()=>d});var r=s(5163);const a={NAME:"__SIGNAL_NAME__"},i=e=>(...t)=>({type:"INTERNAL/ACTION_SEQUENCE",payload:t,[a.NAME]:e});function n(...e){return{type:"INTERNAL/ACTION_SEQUENCE",payload:e}}function o(...e){return{type:"INTERNAL/ACTION_PARALLEL",payload:e}}function c(e,t){return(...s)=>{return{type:"INTERNAL/SIGNAL",payload:r={name:e,params:1===s.length?s[0]:s,action:t(...s)},[a.NAME]:r.name};var r}}function d(e){return{type:"INTERNAL/ACTION_WITH_STATE",payload:e}}function u(e){return{type:"INTERNAL/ACTION_WITH_CONFIG",payload:e}}const l=e=>({type:"INTERNAL/DEFER",payload:{fn:e}});function p(e){return"undefined"!=typeof window?e:g()}function h(e){return d((t=>t.session.isSearchBot?g():e))}function g(e){return{type:"INTERNAL/NOOP",payload:e}}const m=e=>l((()=>(0,r.mG)(void 0,void 0,void 0,(function*(){return yield new Promise((t=>setTimeout(t,e)))}))))},64841:(e,t,s)=>{s.d(t,{tO:()=>n});let r=a();function a(){return"undefined"!=typeof window?window:void 0}function i(e){return r&&function(e){try{if(e.setItem("testStorageItem","1"),"1"!==e.getItem("testStorageItem"))throw new Error;return e.removeItem("testStorageItem"),!0}catch(e){return!1}}(r[e])?r[e]:function(){const e={};return Object.defineProperty(e,"key",{value(e){return Object.keys(this)[e]}}),Object.defineProperty(e,"getItem",{value(e){return this[e]}}),Object.defineProperty(e,"setItem",{value(e,t){this[e]=t}}),Object.defineProperty(e,"removeItem",{value(e){delete this[e]}}),Object.defineProperty(e,"length",{get(){return Object.keys(this).length}}),Object.defineProperty(e,"clear",{value(){for(const e in this)this.hasOwnProperty(e)&&delete this[e]}}),Object.create(e)}()}const n={local:i("localStorage"),session:i("sessionStorage")}},82603:(e,t,s)=>{s.d(t,{$K:()=>C,CE:()=>v,DB:()=>A,Ds:()=>f,Ed:()=>a,Ez:()=>l,G9:()=>w,Gg:()=>O,Kn:()=>j,P2:()=>m,Q8:()=>i,U2:()=>b,ZT:()=>u,_G:()=>g,_J:()=>h,by:()=>d,d4:()=>I,dL:()=>p,hj:()=>n,oA:()=>_,uK:()=>y,uv:()=>E,xH:()=>o,xb:()=>R});var r=s(5163);function a(e,t){for(const s in e)if(e.hasOwnProperty(s)){if(!1===t(e[s],s))break}}function i(e,t){const s={};for(const r in e)e.hasOwnProperty(r)&&(s[r]=t(e[r],r));return s}function n(e,t){const s=e.lastIndexOf(t);return s===e.length-1||-1===s?e[0]:e[s+1]}function o(e){const t=[];return e.forEach((e=>{Array.isArray(e)?t.push(...e):t.push(e)})),t}const c=s(15013);function d(){return c()}const u=()=>{};function l(e){return e.charAt(0).toUpperCase()+e.slice(1)}function p(e,t){if(!e)return"";const s=(e,s)=>t[s]||"";return e.replace(/\${(\w+)}/g,s).replace(/\$(\w+)/g,s)}const h=e=>e?e.split("_")[0]:"",g=e=>e.split("_")[1];function m(e,t){let s,r;return function(){r?s=()=>e.apply(this,arguments):(e.apply(this,arguments),r=setTimeout((()=>{r=void 0,s&&(s(),s=void 0)}),t))}}function f(e,t){let s;return function(){s&&clearTimeout(s),s=setTimeout((()=>{s=void 0,e.apply(this,arguments)}),t)}}function b(e,t,s){if(!e)return s;return t.split(".").reduce(((e,t)=>j(e)?e[t]:Array.isArray(e)?e[+t]:void 0),e)||s}function _(e){return e.filter((e=>!!e))}function y(e,t){const s=[],r=[];for(let a=0;a<e.length;a++){const i=e[a];t(i,a)?s.push(i):r.push(i)}return[s,r]}function E(e){for(const t in e)void 0===e[t]||null===e[t]?delete e[t]:"object"==typeof e[t]&&E(e[t]);return e}function O(e){return!!e}function v(e,t){return t.reduce(((e,t)=>{const s=e,a=t;s[a];return(0,r._T)(s,["symbol"==typeof a?a:a+""])}),e)}function j(e){return null!==e&&"object"==typeof e&&!1===Array.isArray(e)}function R(e){return!e||0===Object.keys(e).length}function I(e){const t=e.split("."),s=e.split(":");return s.length>1?function(e){let t=e.join(":");8===e.length&&0===t.indexOf("0000:0000:0000:0000:0000:ffff:")&&(t=`::ffff:${t.substr(30)}`);if(0===t.indexOf("::ffff:")){const s=t.substr(7),r=s.split(".");if(4===r.length)return S(r);const a=s.split(":");if(2!==a.length)return T(e);return S(a.reduce(((e,t)=>{let s=t.split("");switch(s.length){case 3:s.unshift("0");break;case 2:s=["0",s[0],"0",s[1]];break;case 1:s.unshift("0","0","0")}return e.push(parseInt(`${s[0]}${s[1]}`,16).toString()),e.push(parseInt(`${s[2]}${s[3]}`,16).toString()),e}),[]))}if(e.length<2)return e.join(":");return T(e)}(s):4===t.length?S(t):e}function S(e){return e[3]="0",e.join(".")}function T(e){const t=`${e[0]}:${e[1]}::`;return":::"===t?"::":t}function A(e,t=6){return parseFloat(e.toFixed(t))}function C(e){return null!=e}function w(e,t,s=6){return Math.abs(e-t)<Math.pow(10,-s)}},10405:(e,t,s)=>{s.d(t,{ze:()=>i,wX:()=>n.w});const r={sizeLimit:void 0,photoCount:void 0,maxDailyPhotoCount:void 0,maxVerticalRatio:void 0,maxHorizontalRatio:void 0,maxHeight:void 0,maxWidth:void 0,minWidth:void 0,minHeight:void 0,approvedMIMERegExpr:void 0},a={productFeedback:Object.assign(Object.assign({},r),{sizeLimit:10485760,photoCount:5,approvedMIMERegExpr:/image\/(png|gif|bmp|jp(e?)g)/}),userAvatar:Object.assign(Object.assign({},r),{sizeLimit:10485760,photoCount:1,maxVerticalRatio:5,maxHorizontalRatio:5,maxHeight:7e3,maxWidth:7e3,minWidth:170,minHeight:170,approvedMIMERegExpr:/image\/(png|jp(e?)g)/}),entityPhoto:Object.assign(Object.assign({},r),{sizeLimit:10485760,photoCount:9,maxDailyPhotoCount:20,maxVerticalRatio:5,maxHorizontalRatio:5,maxHeight:7e3,maxWidth:7e3,minWidth:600,minHeight:600,approvedMIMERegExpr:/image\/(png|jp(e?)g)/}),reviewPhoto:Object.assign(Object.assign({},r),{sizeLimit:10485760,photoCount:10,maxVerticalRatio:5,maxHorizontalRatio:5,maxHeight:7e3,maxWidth:7e3,minWidth:600,minHeight:600,approvedMIMERegExpr:/image\/(png|jp(e?)g)/}),typedFeedback:Object.assign(Object.assign({},r),{sizeLimit:10485760,photoCount:5,maxVerticalRatio:5,maxHorizontalRatio:5,approvedMIMERegExpr:/image\/(png|jp(e?)g)/})};function i(e){return a[e]}var n=s(44551)},44551:(e,t,s)=>{s.d(t,{w:()=>a});var r=s(83466);function a(e,t){return new Promise(((s,a)=>{const i=function(e,t){const s=e.name.slice(2+(e.name.lastIndexOf(".")-1>>>0));if(s&&["heic","heif"].indexOf(s)>-1)return"failFormatHEIF";if(e.size>t.sizeLimit)return"failSize";if(!e.type.match(t.approvedMIMERegExpr))return"failFormat";return}(e,t);if(i)return a(i),void(0,r.H)({message:"Ошибка валидации при загрузке файла изображения",level:"info",id:"ffv510",payload:{type:"debug",subtype:"filevalidation",data:JSON.stringify({error:i,fileType:e.type,fileName:e.name,fileSize:e.size})}});const n=new FileReader;n.onload=()=>{if(!n.result)return void a("failRead");const e=new Image;e.onload=()=>{const i=function(e,t){if(t.minWidth&&e.width<t.minWidth)return"smallWidth";if(t.minHeight&&e.height<t.minHeight)return"smallHeight";if(t.maxWidth&&e.width>t.maxWidth)return"largeWidth";if(t.maxHeight&&e.height>t.maxHeight)return"largeHeight";if(t.maxHorizontalRatio&&e.width/e.height>t.maxHorizontalRatio)return"wide";if(t.maxVerticalRatio&&e.height/e.width>t.maxVerticalRatio)return"narrow";return}(e,t);if(i)return a(i),void(0,r.H)({message:"Ошибка валидации при загрузке файла изображения",level:"info",id:"dff144",payload:{type:"debug",subtype:"filevalidation",data:i}});s(e)},e.onerror=()=>{a("failRead")},e.src=n.result.toString()},n.onerror=()=>{a("failRead")},n.readAsDataURL(e)}))}},53e3:(e,t,s)=>{s.d(t,{_:()=>a,v:()=>i});var r=s(64049);const a=["sbol-review"],i={args:[{key:"subtype",isRequired:!1,formatCheck:e=>(0,r.k)(a,e)}],type:"error",name:"error",isQuery:!1}},18584:(e,t,s)=>{s.d(t,{v:()=>a});var r=s(82603);function a(e){const[t,s]=e.split(","),a=function(e){const t=parseFloat(e);if(!Number.isNaN(t))return t>180?180:t<-180?-180:(0,r.DB)(t)}(t),i=function(e){const t=parseFloat(e);if(!Number.isNaN(t))return t>90?90:t<-90?-90:(0,r.DB)(t)}(s);if(void 0!==a&&void 0!==i&&!Number.isNaN(a)&&!Number.isNaN(i))return{lon:a,lat:i}}},28176:(e,t,s)=>{s.d(t,{S:()=>a});var r=s(82603);function a(e){return`${(0,r.DB)(e.lon)},${(0,r.DB)(e.lat)}`}},88111:(e,t,s)=>{s.d(t,{M:()=>D,Q:()=>H});const r={args:[{key:"id",isRequired:!0,formatCheck:/^\d+$/}],type:"region",compile:({code:e})=>e?[e]:void 0,name:"region",isQuery:!1};var a=s(82603),i=s(30595);function n(e){const t=[];return(0,a.Ed)(e,((e,s)=>{!e||"sort"===s&&"distance"===e||t.push("true"===e?s:`${s}${i.AN}${e}`)})),t.join(`${i.kp}`)}function o(e){const t={};if(!e)return t;return e.split(i.kp).forEach((e=>{const[s,r="true"]=e.split(i.AN);s&&r&&(t[s]=function(e){return/^\d+-\d+$/.test(e)?e.replace("-",i.ER):e}(r))})),t}const c={args:[{key:"query",isRequired:!0,formatCheck:/^.+$/},{key:"activeTab",name:"tab",isRequired:!1,formatCheck:/^(catalog)$/},{key:"rubricId",name:"rubricId",isRequired:!1,formatCheck:/^\d+$/},{key:"attributeId",name:"attributeId",isRequired:!1,formatCheck:/^\d+$/},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o},{key:"page",name:"page",isRequired:!1,formatCheck:/^\d+$/,serialize:e=>e?Math.round(e).toString():"",deserialize:e=>parseInt(e,10)}],type:"search",name:"search",isQuery:!1};var d=s(79148);const u={args:[{key:"tab",name:"tab",isRequired:!1,formatCheck:/^.+$/},{key:"points",name:"points",isRequired:!1,formatCheck:/^.+$/,serialize:e=>e&&(0,d.fm)(e),deserialize:d.ZW},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o}],type:"directions",name:"directions",isQuery:!1};var l=s(28176),p=s(18584);const h={args:[{key:"entityId",isRequired:!1,formatCheck:/^[1-9]\d*$/},{key:"entityWithPoint",isRequired:!1,formatCheck:/^[1-9]\d*,(-?\d+(\.\d+)?,-?\d+(\.\d+)?)(\/|$)/,deserialize:e=>{const[t,s,r]=e.split(",");return{id:t,point:(0,p.v)(`${s},${r}`)}}},{key:"point",isRequired:!1,formatCheck:/^-?[.\d]+,-?[.\d]+$/,serialize:e=>e&&(0,l.S)(e),deserialize:p.v},{key:"tab",name:"tab",isRequired:!1,formatCheck:/^[a-z]+$/},{key:"query",name:"query",isRequired:!1,formatCheck:/^.+$/},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o},{key:"page",name:"page",isRequired:!1,formatCheck:/^\d+$/,serialize:e=>e?Math.round(e).toString():"",deserialize:e=>parseInt(e,10)},{key:"entranceId",name:"entranceId",isRequired:!1,formatCheck:/^\d+$/}],validate:e=>!!(e.entityId||e.entityWithPoint||e.point),type:"firm",name:"firm",isQuery:!1},g={args:[{key:"query",name:"query",isRequired:!1,formatCheck:/^.+$/},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o},{key:"page",name:"page",isRequired:!1,formatCheck:/^\d+$/,serialize:e=>e?Math.round(e).toString():"",deserialize:e=>parseInt(e,10)}],type:"offers",name:"offers",isQuery:!1},m={args:[{key:"buildingId",isRequired:!0,formatCheck:/^\d+$/},{key:"query",name:"query",isRequired:!1,formatCheck:/^.+$/},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o}],type:"inside",name:"inside",isQuery:!1},f=Object.assign(Object.assign({},h),{type:"geo",name:"geo"}),b=Object.assign(Object.assign({},h),{type:"route",name:"route"}),_=Object.assign(Object.assign({},h),{type:"platform",name:"platform"}),y=Object.assign(Object.assign({},h),{type:"station",name:"station"}),E=Object.assign(Object.assign({},h),{type:"stationEntrance",name:"stationEntrance"}),O={args:[{key:"productId",isRequired:!0,formatCheck:/^\S+$/},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o}],type:"product",name:"product",isQuery:!1};function v(e){return e?(Math.round(100*e)/100).toString():""}const j={args:[{key:"center",isRequired:!1,serialize:e=>void 0!==e?(0,l.S)(e):"",deserialize:e=>(0,p.v)(e),formatCheck:/^-?[.\d]+,-?[.\d]+$/},{key:"zoom",isRequired:!1,formatCheck:/^\d{1,2}(?:\.\d{1,2})?$/,serialize:v,deserialize:e=>parseFloat(e)},{key:"pitch",name:"p",isRequired:!1,formatCheck:/^\d{1,2}(?:\.\d{1,2})?$/,serialize:v,deserialize:e=>e?parseFloat(e):0},{key:"rotation",name:"r",isRequired:!1,formatCheck:/^-?\d{1,3}(?:\.\d{1,2})?$/,serialize:v,deserialize:e=>e?parseFloat(e):0}],type:"mapview",name:"m",isQuery:!0},R={args:[{key:"value",formatCheck:/^\d+$/,serialize:e=>void 0===e?"0":String(e),deserialize:e=>{const t=parseInt(e,10);return Number.isNaN(t)?0:t},isRequired:!1}],isQuery:!0,type:"floor",name:"floor"},I=["source","medium","term","content","campaign"].map((e=>({args:[{key:"value",isRequired:!0}],type:e,name:`utm_${e}`,isQuery:!0})));function S(e){return e.map((e=>(0,a.DB)(e))).join(",")}function T(e){const t=(0,p.v)(e);return t?[t.lon,t.lat]:void 0}function A(e){const t=e.split("|"),s=(0,p.v)(t[0]);if(s)return{type:"point",lonLat:s,entityId:t[2]}}const C=[{args:[{key:"rsType",name:"rsType",isRequired:!1},{key:"from",name:"from",isRequired:!1,formatCheck:/^.+$/,deserialize:A},{key:"to",name:"to",isRequired:!1,formatCheck:/^.+$/,deserialize:A}],type:"online4RouteSearch",name:"routeSearch",isQuery:!1},{args:[{key:"point",isRequired:!0,deserialize:A}],type:"online4From",name:"from",isQuery:!1},{args:[{key:"point",isRequired:!0,deserialize:A}],type:"online4To",name:"to",isQuery:!1},{args:[{key:"value",isRequired:!0}],type:"online4RsType",name:"rsType",isQuery:!1},{args:[],type:"online4Collections",name:"collections",isQuery:!1},{args:[{key:"entityId",isRequired:!0,formatCheck:/^\d+$/},{key:"innerFirmId",name:"firm",isRequired:!1,formatCheck:/^\d+$/}],type:"online4Floors",name:"floors",isQuery:!1},{args:[{key:"stopId",isRequired:!0}],type:"online4Stop",name:"stop",isQuery:!1},{args:[{key:"entityId",isRequired:!0,formatCheck:/^\d+$/}],type:"online4Reviews",name:"reviews",isQuery:!1},{args:[{key:"tab",isRequired:!0,deserialize:e=>{switch(e){case"discount":return"discounts";case"reviews":return"reviews";case"photos":return"photos";default:return"contacts"}}}],type:"online4MediaTab",name:"mediaTab",isQuery:!1},{args:[{key:"entityId",isRequired:!0}],type:"online4Discounts",name:"discounts",isQuery:!1},{args:[{key:"entityId",isRequired:!0},{key:"tab",name:"group",isRequired:!1,deserialize:e=>"internet"===e?"providers":"services"}],type:"online4Service",name:"service",isQuery:!1},{args:[{key:"entityId",isRequired:!0}],type:"online4Inside",name:"inside",isQuery:!1},{args:[],type:"online4Feedback",name:"feedback",isQuery:!1},{args:[],type:"online4AddOrg",name:"addOrg",isQuery:!1},{args:[{key:"entityId",isRequired:!0}],type:"online4Article",name:"article",isQuery:!1},{args:[{key:"id",isRequired:!0,formatCheck:/^\d+$/}],type:"online4City",name:"city",isQuery:!1},{args:[{key:"id",isRequired:!0,formatCheck:/^(geo-|firms-)\d+$/,deserialize:e=>e.replace(/(geo-|firms-)/g,"")}],type:"online4Callout",name:"callout",isQuery:!1},{args:[{key:"lang",isRequired:!0}],type:"online4Lang",name:"lang",isQuery:!1},{args:[{key:"center",isRequired:!0,deserialize:e=>(0,p.v)(e),formatCheck:/^-?[.\d]+[,╎]-?[.\d]+$/}],type:"online4Center",name:"center",isQuery:!1},{args:[{key:"zoom",isRequired:!0,formatCheck:/^\d{1,2}(?:\.\d{1,2})?$/,deserialize:e=>parseFloat(e)}],type:"online4Zoom",name:"zoom",isQuery:!1}];const w={slugs:[r,{args:[],type:"rubrics",name:"rubrics",isQuery:!1},{args:[{key:"parentId",isRequired:!0,formatCheck:/^\d+$/}],type:"subrubrics",name:"subrubrics",isQuery:!1},c,{args:[{key:"rubricId",isRequired:!0,formatCheck:/^\d+$/},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o},{key:"page",name:"page",isRequired:!1,formatCheck:/^\d+$/,serialize:e=>e?Math.round(e).toString():"",deserialize:e=>parseInt(e,10)}],type:"rubric",name:"rubric",isQuery:!1},u,{args:[{key:"branchId",isRequired:!0,formatCheck:/^\d+$/},{key:"categoryId",name:"categoryId",isRequired:!1,formatCheck:/^\d+$/}],type:"prices",name:"prices",isQuery:!1},{args:[{key:"profileTab",isRequired:!1,formatCheck:/^[a-zA-Z].+$/}],type:"my",name:"my",isQuery:!1},{args:[{key:"entityId",isRequired:!0,formatCheck:/^\d+$/}],type:"friends",name:"friends",isQuery:!1},{args:[{key:"group",isRequired:!1,formatCheck:/^[a-zA-Z].+$/}],type:"achievements",name:"achievementsGroup",isQuery:!1},g,{args:[{key:"productId",isRequired:!0,formatCheck:/^\S+$/}],type:"offer",name:"offer",isQuery:!1},{args:[{key:"dialogId",isRequired:!1}],type:"messenger",name:"messenger",isQuery:!1},h,m,f,b,_,y,E,O,{args:[{key:"entityType",isRequired:!0,formatCheck:/^\w+$/},{key:"entityId",isRequired:!0,formatCheck:/^\d+$/},{key:"photoId",name:"photoId",isRequired:!1}],type:"gallery",name:"gallery",isQuery:!1},{args:[{key:"orgId",isRequired:!0,formatCheck:/^\d+$/},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o}],type:"branches",name:"branches",isQuery:!1},R,{args:[{key:"OLD_ONLINE_4_PUBLIC_FAVORITE_ID",isRequired:!1}],type:"favorites",name:"favorites",isQuery:!1},{args:[],type:"interesting",name:"interesting",isQuery:!1},{args:[],type:"guidebook",name:"guidebook",isQuery:!1},{args:[{key:"collectionId",isRequired:!0}],type:"collection",name:"collection",isQuery:!1},j,{args:[{key:"lang",isRequired:!0}],isQuery:!1,compile:e=>[e.lang],type:"lang",name:""},{args:[{key:"source",name:"source",isRequired:!1}],type:"writeReview",name:"writeReview",isQuery:!0},{args:[{key:"value",isRequired:!0}],type:"stat",name:"stat",isQuery:!0},{args:[{key:"points",isRequired:!1,formatCheck:/^.+$/,serialize:e=>e&&e.map(S).join("|"),deserialize:e=>(0,a.oA)(e.split("|").map(T))}],type:"ruler",name:"ruler",isQuery:!0},{args:[{key:"value",formatCheck:/^[a-zA-Z0-9].+$/,isRequired:!0}],isQuery:!0,type:"layer",name:"layer"},{args:[{key:"value",formatCheck:/^[a-zA-Z0-9].+$/,isRequired:!0}],isQuery:!0,type:"sublayer",name:"sublayer"},{args:[],type:"feedback",name:"feedback",isQuery:!0},{args:[],type:"addOrg",name:"addOrg",isQuery:!0},{args:[],type:"traffic",name:"traffic",isQuery:!0},{args:[{key:"status",isRequired:!0,formatCheck:/^[a-zA-Z].+$/}],type:"auth",name:"auth",isQuery:!1},{args:[],type:"award2019",name:"award2019",isQuery:!1},{args:[{key:"adsIds",isRequired:!0,formatCheck:/^\d+(,\d+)*$/},{key:"page",name:"page",isRequired:!1,formatCheck:/^\d+$/,serialize:e=>e?Math.round(e).toString():"",deserialize:e=>parseInt(e,10)},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o}],type:"buyHere",name:"buyHere",isQuery:!1},{args:[{key:"adsIds",isRequired:!0,formatCheck:/^\d+(,\d+)*$/},{key:"page",name:"page",isRequired:!1,formatCheck:/^\d+$/,serialize:e=>e?Math.round(e).toString():"",deserialize:e=>parseInt(e,10)},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o}],type:"fmcg",name:"fmcg",isQuery:!1},{args:[{key:"calc",name:"calc",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e?Object.entries(e).filter((e=>!!e[1])).map((e=>`${e[0]}=${e[1]}`)).join(";"):"",deserialize:e=>{if(!e)return;const t=e.split(";").map((e=>e.split("="))).reduce(((e,[t,s])=>Object.assign(Object.assign({},e),{[t]:s})),{}),s=(null==t?void 0:t.volume)?parseInt(t.volume,10):void 0;return{action:(null==t?void 0:t.action)?t.action:void 0,currencyCode:null==t?void 0:t.currencyCode,volume:s&&s>0?s:void 0}}},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o},{key:"page",name:"page",isRequired:!1,formatCheck:/^\d+$/,serialize:e=>e?Math.round(e).toString():"",deserialize:e=>parseInt(e,10)}],isQuery:!1,type:"exchange",name:"exchange"},{args:[{key:"category",isRequired:!1,formatCheck:/^(sale|rent|daily)$/},{key:"at",name:"at",isRequired:!1,formatCheck:/^\d+$/},{key:"filters",name:"filters",isRequired:!1,formatCheck:/^[a-zA-Z].+$/,serialize:e=>e&&n(e),deserialize:o}],isQuery:!1,type:"realty",name:"realty"},{args:[{key:"id",isRequired:!0},{key:"tab",name:"tab",isRequired:!1}],isQuery:!1,type:"realtyAd",name:"ad"},{args:[{key:"profileTab",isRequired:!1,formatCheck:/^[a-zA-Z].+$/}],type:"profile",name:"profile",isQuery:!1},s(53e3).v,{args:[],type:"new_year_promo",name:"new_year_promo",isQuery:!1},{args:[{key:"intensity",isRequired:!1}],type:"snow",name:"snow",isQuery:!1},...I,...C]};var k=s(82854);const U=["ru","en","es","uk","cs","ar","az","uz"];function N(e,t,s){const r={};if(e.args.every((e=>{let a=t.shift();if(!a)return!e.isRequired;if(e.name&&e.name!==a)return t.unshift(a),!0;const i=s.slugs.some((e=>e.name===a));if(!e.isRequired&&i)return t.unshift(a),!1;const n=e.formatCheck,o=n&&n instanceof RegExp?e=>e&&e.match(n):n;if(e.name&&e.name===a){if(a=t.shift(),!a||o&&!o(a))return t.unshift(a),!e.isRequired}else if(o&&!o(a))return t.unshift(a),!e.isRequired;return r[e.key]=e.deserialize?e.deserialize(a):a,!0})),e.validate&&!e.validate(r))return;return e.args.every((e=>!e.isRequired||!!r[e.key]))?r:void 0}function P(e,t){const s={},r=[...e],a=[],i=[];let n=-1;for(;r.length;){const e=r.shift();if(n+=1,!e)continue;const o=t.slugs.find((t=>t.name===e&&!t.isQuery));if(!o){a.push({name:e,value:[],position:n,isQuery:!1});continue}const c=r.length,d=N(o,r,t),u=r.length;d?s[o.type]=Object.assign({type:o.type},d):i.push({name:e,value:[],position:n,isQuery:!1}),n+=c-u}return{payload:s,unknown:a,invalid:i}}function L(e,t){const s={},r=[],a=[];for(;e.length;){const i=e.shift();if(!i)continue;const[n,o]=i,c=t.slugs.find((e=>e.name===n&&e.isQuery));if(!c){r.push({name:n,value:o,isQuery:!0});continue}const d=N(c,o,t);d?s[c.type]=Object.assign({type:c.type},d):a.push({name:n,value:o,isQuery:!0})}return{payload:s,unknown:r,invalid:a}}function H(e,t=w){const{path:s,query:r}=(0,k.Qc)(e),a=P(s,t),i=L(r,t);return function(e){const t=Object.assign({},e.payload),s=[...e.unknown];s[0]&&s[0].name&&0===s[0].position&&U.includes(s[0].name)&&(t.lang={type:"lang",lang:s[0].name},s.shift());s[0]&&s[0].name&&(0===s[0].position||1===s[0].position)&&(t.region={type:"region",code:s[0].name},s.shift());return Object.assign(Object.assign({},e),{payload:t,unknown:s})}({payload:Object.assign(Object.assign({},a.payload),i.payload),unknown:[...a.unknown,...i.unknown],invalid:[...a.invalid,...i.invalid]})}function F(e,t){return(0,a.oA)(t.reduce(((t,{key:s,name:r,serialize:a})=>{const i=a?a(e[s]):e[s];return i?r?[...t,r,i]:[...t,i]:t}),[]))}function D(e,t=w){return(0,k.MY)((s=e,r=t.slugs,s.reduce(((e,t)=>{const s=r.find((e=>e.type===t.type));if(!s)return e;const a=s.compile&&s.compile(t),i=a&&a.length>0?a:[s.name,...F(t,s.args)];if(s.isQuery){const[t,...s]=i;return Object.assign(Object.assign({},e),{query:[...e.query,[t,s]]})}return Object.assign(Object.assign({},e),{path:[...e.path,...i]})}),{path:[],query:[]})));var s,r}},82854:(e,t,s)=>{s.d(t,{MY:()=>c,Qc:()=>i,NL:()=>d});var r=s(82603);const a=e=>{try{return decodeURIComponent(e)}catch(e){return""}},i=e=>{const[t,s=""]=e.split("?");return{path:n(t),query:o(s.split("#")[0])}};function n(e){return"/"===e?[]:(0,r.oA)(e.split("/")).map(a)}function o(e){if(""===e)return[];const t=e.split("&");return(0,r.oA)(t.map((e=>{if(!e)return;const[t,s]=e.split("=");if(!t)return;if(!s)return[t,[]];return[t,(0,r.oA)(a(s).split("/"))]})))}const c=e=>{const t=function(e){return"/"+d(...e.map((e=>encodeURIComponent(e))))}(e.path),s=function(e){return(0,r.oA)(e.map((([e,t])=>{if(""===e)return;const s=encodeURIComponent((0,r.oA)(t).join("/"));return""===s?e:`${e}=${s}`}))).join("&")}(e.query);return s?`${t}?${s}`:t};function d(...e){return e.slice(1).reduce(((e,t)=>t?(e.endsWith("/")||""===e?e+=t.startsWith("/")?t.slice(1):t:e+=t.startsWith("/")?t:"/"+t,e):e),e[0]||"")}},64301:(e,t,s)=>{s.d(t,{$W:()=>n,DF:()=>f,h_:()=>d,rx:()=>o});var r=s(82603),a=s(85388);const i=/^[A-Z]+\((.+)\)/.source;function n(e){const t=m(e);if(t)switch(t){case"POINT":return{type:"point",geometry:o(e)};case"MULTIPOINT":return{type:"points",geometry:c(e)};case"LINESTRING":return{type:"polyline",geometry:d(e)};case"POLYGON":return{type:"polygon",geometry:u(e)};case"MULTILINESTRING":return{type:"polyline",geometry:l(e)};case"MULTIPOLYGON":return{type:"polygon",geometry:p(e)}}}function o(e){const t=g(e);if("POINT"!==m(t))return;const s=new RegExp(i).exec(t);if(!s)return;const[r,a]=s[1].split(" ");return void 0!==r&&void 0!==a?{lon:parseFloat(r),lat:parseFloat(a)}:void 0}function c(e){const t=g(e);if("MULTIPOINT"!==m(t))return;const s=new RegExp(i).exec(t);return s?h(s[1].split(",")):void 0}function d(e){const t=g(e);if("LINESTRING"!==m(t))return;const s=new RegExp(i).exec(t);return s?h(s[1].split(",")):void 0}function u(e){const t=g(e);if("POLYGON"!==m(t))return;const s=new RegExp(i).exec(t);if(!s)return;const r=[],a=/\((.*?)\)/g;let n;for(;n=a.exec(s[1]);)r.push(h(n[1].split(",")));return r}function l(e){const t=g(e);if("MULTILINESTRING"!==m(t))return;const s=new RegExp(i).exec(t);if(!s)return;const r=[],a=/\((.*?)\)/g;let n;for(;n=a.exec(s[1]);)r.push(h(n[1].split(",")));return r}function p(e){const t=g(e);if("MULTIPOLYGON"!==m(t))return;const s=new RegExp(i).exec(t);if(!s)return;return s[1].split(")),((").map((e=>`POLYGON((${e.replace("((","").replace("))","")}))`)).map(u).filter(r.Gg).reduce(((e,t)=>(e.push(...t),e)),[])}function h(e){return e.reduce(((e,t)=>{const[s,r]=t.replace(/\(|\)/g,"").split(" ");return e.push({lon:parseFloat(s),lat:parseFloat(r)}),e}),[])}function g(e){return e.replace(/\s*([\s(),])\s*/g,"$1")}function m(e){const t=/((MULTI)?(POINT|LINESTRING|POLYGON)).+/.exec(e);return t&&t[1]?t[1]:void 0}function f(e){if(e&&(0,a.S)(e))return`POINT(${(0,r.DB)(e.lon,7)} ${(0,r.DB)(e.lat,7)})`}},83466:(e,t,s)=>{s.d(t,{H:()=>_,UB:()=>y});var r=s(82603),a=s(38091);const i=e=>{let t=5381,s=e.length;for(;s;)t=33*t^e.charCodeAt(--s);return String(t>>>0)};var n=s(27087);const o=(0,a.hG)({networkTimeout:1e4,enableProxy:!1,analyticsBssEnableTestHandles:!1,featureReadOnly:!1},{GDPRAllowedServiceHosts:[]});const c=new class{constructor(e,t,s){this.queue=[],this.inProgress=!1,this.LOG_BATCH_SIZE=20,this.deduplicateTimeout=s||0,this.sendLogAction=e,this.deduplicateQueue=t}addToQueue(e){this.queue.push(e),this.queue=this.deduplicateQueue(this.queue),this.startQueue()}startQueue(){this.sendNextLog()}sendNextLog(){this.inProgress||(this.inProgress=!0,setTimeout((()=>{this.sendLog()}),this.deduplicateTimeout))}sendLog(){if(!this.queue.length)return void(this.inProgress=!1);const e=this.queue.splice(0,this.LOG_BATCH_SIZE);this.sendLogAction(e).then((()=>{this.inProgress=!1,this.sendNextLog()})).catch((()=>{this.inProgress=!1,e.forEach((e=>{this.addToQueue(e)})),this.addToQueue({environment:"client",level:"warn",message:"Error during send log","error.type":"sendLogError"})}))}}((function(e){return o("/_/log",{method:"post",data:e,timeout:3e4,headers:{"Content-Type":"application/json"}})}),(function(e){const t=(s=e=>i("error.type"in e?`${e["error.type"]}_${e.message}`:`${e.log_id}`),e.reduce(((e,t)=>{const r=s(t);return void 0!==e[r]?(e[r].count++,e):(e[r]={data:t,count:1},e)}),{}));var s;return(0,n.s0)(t).map((e=>{const t=e.data;return Object.assign(Object.assign({},t),{count:t.count>1?e.count+t.count-1:e.count})}))}),1e3),d=s(6053),u=!0;const l=d.Logger?function(){const e=new d.Logger({exitOnError:!1,emitErrs:!1,levels:{fatal:0,error:1,warn:2,info:3}});return e.add(d.transports.Console,{handleExceptions:!1,json:!0,stringify:u,timestamp:u,prettyPrint:!1}),e}():void 0;var p=s(79207);const h=1e3;function g(e){return e.noCropValues?e:(0,r.Q8)(e,(e=>"string"==typeof e?e.slice(0,h):e))}function m(e){const{message:t,level:s,id:r,payload:a,ip:i,sessionId:n,userId:o,userAgent:c,requestId:d,namespace:u,url:l,noCropValues:p}=e;return Object.assign({message:t,level:s,log_id:r,remote_addr:i,user_id:o,session_id:n,request_id:d,http_user_agent:c,request_uri:l,noCropValues:p},function(e,t){const s=Object.keys(e),r={};for(const a of s)r[`${t}.${a}`]=e[a];return r}(a,u))}function f(e){const t=m(e),s=(0,r.CE)(t,["user_id","remote_addr","http_user_agent","session_id"]);!function(e){c.addToQueue(g((0,p.Y)(e)))}(Object.assign(Object.assign({},s),{environment:"client"}))}function b(e){const t=m(e);!function(e){const{level:t}=e;l.log(t,g((0,p.Y)(e)))}(Object.assign(Object.assign({},t),{environment:"server"}))}function _(e){return"undefined"==typeof window?b(Object.assign(Object.assign({},e),{namespace:"error"})):f(Object.assign(Object.assign({},e),{namespace:"error"}))}function y(e){return"undefined"==typeof window?b(Object.assign(Object.assign({},e),{namespace:"perf"})):f(Object.assign(Object.assign({},e),{namespace:"perf"}))}},41560:(e,t,s)=>{s.d(t,{UL:()=>r.UL,YR:()=>r.YR,qV:()=>r.qV});var r=s(14677)},44390:(e,t,s)=>{s.d(t,{BZ:()=>c,Cz:()=>r,Kr:()=>d,Kt:()=>i,LF:()=>a,N6:()=>n,m8:()=>o});const r=12,a=12,i=50,n=20,o=19,c=5,d=2},68671:(e,t,s)=>{s.d(t,{sk:()=>r});let r="undefined"==typeof window},87325:(e,t,s)=>{s.d(t,{A1:()=>o,F7:()=>n,NF:()=>u,Y_:()=>d,fe:()=>c,og:()=>l});var r=s(38091),a=s(73134),i=s(28629);class n{constructor(e,t){this.name="NetworkError",this.message=e,this.code=t}}function o(e,t,s){var i,n,o,d,u;const l=(0,r.Rr)(s);if(422===Number(l))throw c((null===(o=null===(n=null===(i=s.details.response)||void 0===i?void 0:i.data.error_fields)||void 0===n?void 0:n[0])||void 0===o?void 0:o.error)||(null===(d=s.details.response)||void 0===d?void 0:d.data.error)||s.details.message,(null===(u=s.details.response)||void 0===u?void 0:u.data.error_description)||"");(0,a.No)(e,{},t)(s)}function c(e,t){return{name:"ValidationError",message:e,code:422,data:t}}const d=e=>!("object"!=typeof e||!e)&&("obscene"in e||"insults"in e||"unproven_allegations"in e);function u(e){if(e instanceof r.d7){const t=e.details.message,s=(0,r.Rr)(e);return new n(t,function(e){const t=Number(e);if(t!=t)return 500;return l(t)}(s))}return function(e){if(e&&"object"==typeof e&&"name"in e&&"string"==typeof e.name&&"message"in e&&"string"==typeof e.message)return!("code"in e)||"number"==typeof e.code;return!1}(e)?{name:e.name,message:e.message,code:e.code||500}:{name:"Unknown error type",message:(0,i.e)(e),code:500}}function l(e){switch(e){case 400:return 400;case 401:return 401;case 402:case 404:return 404;case 403:return 403;case 307:return 307;default:return 500}}},14677:(e,t,s)=>{s.d(t,{EM:()=>i,L3:()=>l,Mq:()=>u,UL:()=>o,YR:()=>r,fD:()=>n,qV:()=>a});const r={status:"success",code:200},a={status:"loading"},i=e=>({status:"loading",__effect_uuid:e}),n={code:404,name:"NotFound",message:"Empty result"},o=e=>({status:"error",code:c(e),error:d(e)});function c(e){return e.code||500}function d(e){return{name:e.name,message:e.message,code:e.code,data:e.data}}function u(e=404){return o({code:e,name:"NotFound",message:"Empty result"})}function l(e){return 404===e?u():{status:"error",code:500,error:new Error(`Api have responded with ${e}`)}}},64656:(e,t,s)=>{s.d(t,{Av:()=>a,Cj:()=>n,VJ:()=>c});var r=s(14677);function a(e,t,s){return function(e,t,s,r){return Object.assign(Object.assign({},e),{[t]:r(e[t],s)})}(e,t,s,i)}function i(e,t){return{data:e&&e.data,meta:(0,r.EM)(t)}}function n(e,t,s,r){return function(e,t,s,r,a){const i=e[t];if((null==i?void 0:i.meta.__effect_uuid)!==r)return e;return Object.assign(Object.assign({},e),{[t]:a(i,s)})}(e,t,s,r,o)}function o(e,t){return{data:t,meta:r.YR}}function c(e,t,s,r){return function(e,t,s,r,a){const i=e[t];if((null==i?void 0:i.meta.__effect_uuid)!==r)return e;return Object.assign(Object.assign({},e),{[t]:a(i,s)})}(e,t,s,r,d)}function d(e,t){return{data:e&&e.data,meta:(0,r.UL)(t)}}},30774:(e,t,s)=>{function r(){return{emitEvent:e=>({type:"EVENT/EMIT",payload:e,event:!0}),addEventListener:e=>({type:"EVENT/ADD_LISTENER",payload:e,event:!0}),removeEventListener:e=>({type:"EVENT/REMOVE_LISTENER",payload:e,event:!0})}}s.d(t,{U:()=>r})},27144:(e,t,s)=>{function r(e,t,s){const r=function(e,t){for(let s=0;s<e.length;s++)if(t>=(e[s].priority||-1/0))return s;return e.length}(e,t.priority||s);return[...e.slice(0,r),t,...e.slice(r)]}s.d(t,{k:()=>i,n:()=>n});var a=s(45537);const i=0;function n(){let e=[];return t=>s=>n=>{if(n){if(!n.event)return s(n);if("EVENT/EMIT"===n.type){const s=[];for(const r of e){if(r.type!==n.payload.type)continue;const e=r.handler(n.payload.event,t.getState());if(e&&(s.push(e),r.stopIfHandled))break}return t.dispatch((0,a.Mf)(...s))}"EVENT/ADD_LISTENER"!==n.type?"EVENT/REMOVE_LISTENER"===n.type&&(e=e.filter((e=>e.id!==n.payload.id))):e=r(e,n.payload,i)}}}},9659:(e,t,s)=>{s.d(t,{d:()=>n});var r=s(82603);let a="",i=!1;const n=(e,t)=>({windowApi:s,analyticsApi:n})=>o=>{const c=e(o.getState());s.historyReplace(c.historyState,c.url||"");let d=o.getState();const u=(0,r.Ds)((t=>{var r;const{historyState:o,url:c}=e(t,d);if(c&&(s.historyReplace(o,c),i)){const e=null===(r=s.location)||void 0===r?void 0:r.pathname;e&&a!==e&&(n.trackPageview(),a=e)}d=t}),333);return e=>r=>{var n;return"turnAutoPageViewOn"===r.type?(i=t.analyticsAutoTrackPageview,void(a=(null===(n=s.location)||void 0===n?void 0:n.pathname)||"")):"object"!=typeof r?e(r):(e(r),void u(o.getState()))}}},50022:(e,t,s)=>{s.d(t,{Eb:()=>n,eg:()=>i,z2:()=>a});var r=s(82603);function a(e,t){return e&&e.data?{data:Object.assign(Object.assign({},e.data),t.data),meta:t.meta}:t}function i(e,t){return e?Object.assign(Object.assign({},e),t):t}function n(e){return"branch"!==e.type?e:(0,r.CE)(e,["ads","context","hash","stat"])}},76448:(e,t,s)=>{s.d(t,{Jk:()=>u,NI:()=>g,ZP:()=>d,vT:()=>i});var r=s(5163),a=s(91122);const i=20,n=100,o=["branch","building","station","adm_div","attraction"],c={data:{searches:[],suggestLastObjects:[]}};function d(e=c,t){switch(t.type){case"USER/LOAD_HISTORY_SUCCESS":return function({payload:e}){return{data:e}}(t);case"USER/ADD_HISTORY_OBJECT":return function(e,{payload:t}){const{entity:s,timestamp:r,text:a}=t,n={type:"history",entity:s,text:a,timestamp:r};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{searches:f(e.data.searches,[n],i)})})}(e,t);case"USER/ADD_HISTORY_SEARCH":return function(e,{payload:t}){const{query:s,timestamp:r}=t,a={type:"history",text:s,timestamp:r};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{searches:f(e.data.searches,[a],i)})})}(e,t);case"USER/CLEAR_HISTORY":return c;default:return e}}function u(e){const{searches:t,suggester_picked_objects:s,last_objects:r}=e,i=(0,a.m)(r,(e=>e.id));return{searches:[...t.map(l),...s.map(p)],suggestLastObjects:i.filter((e=>o.includes(e.type))).map(h)}}function l(e){const{text:t,timestamp:s}=e;return{type:"history",text:t,timestamp:s}}function p(e){const{timestamp:t}=e;return{type:"history",entity:(0,r._T)(e,["timestamp"]),timestamp:t}}function h(e){const{timestamp:t}=e;return{type:"history",entity:(0,r._T)(e,["timestamp"]),timestamp:t}}function g(e,t){return{searches:f(e.searches,t.searches,i),suggestLastObjects:f([],t.suggestLastObjects,n)}}function m(e){return(e.entity?e.entity.id:e.text&&e.text.toLowerCase())||""}function f(e,t,s){const r={};e.forEach((e=>{const t=m(e);t&&(r[t]=e)}));let a=!1;if(t.forEach((e=>{const t=m(e);t&&(r[t]?e.timestamp>r[t].timestamp&&(r[t]=e,a=!0):(r[t]=e,a=!0))})),!a)return e;const i=Object.keys(r).map((e=>r[e]));return i.sort(((e,t)=>e.timestamp<t.timestamp?1:-1)),i.slice(0,s)}},77665:(e,t,s)=>{s.d(t,{u:()=>Ut});var r=s(5163),a=s(25310);class i{constructor(){this.localStorageApi=new a.r("feedback","feedback")}get(e){return(0,r.mG)(this,void 0,void 0,(function*(){try{return yield this.localStorageApi.get(e)}catch(e){}}))}set(e,t){return(0,r.mG)(this,void 0,void 0,(function*(){try{yield this.localStorageApi.set(e,t)}catch(e){}}))}}var n=s(73134);function o(e,t){t&&t.trace&&t.trace.events&&t.trace.events.map((t=>{if("sapphire"===t.category){const s=`https://search.2gis.one/onlinedebug?text=${encodeURIComponent(t.body)}`,r=`Перейти на debug-поиска по ссылке: ${s}`;console.group(e),console.log(r),function(e){if("undefined"==typeof window)return;const t={text:e},s=new CustomEvent("FromPage",{detail:t});window.dispatchEvent(s)}(s),console.log(t.body),console.groupEnd()}}))}const c=e=>t=>{const{debug:s}=t;return o(e,s),t},d=e=>t=>{const{debug:s}=t.data;return o(e,s),t};var u=s(87325);function l(e){var t,s;const{data:{meta:r,result:a}}=e;if([400,403,500].includes(r.code)){const e=r.error?`${r.error.message} (${r.code})`:`Unknown WebAPI error (${r.code})`;if(500===r.code)throw new u.F7(e,r.code);if(403===r.code&&"apiKeyIsBlocked"===(null===(t=r.error)||void 0===t?void 0:t.type))throw new u.F7(e,r.code);const a=new Error(e);throw a.name=(null===(s=r.error)||void 0===s?void 0:s.type)||a.name,a}return Object.assign(Object.assign({},a),{code:r.code,error:r.error})}var p=s(82603),h=s(30595);const g=["sort","work_time","has_reviews","has_reviews_on_flamp","has_site","has_photos","has_rating","subway","opened_after_date","rubric_id","district_id","friends_were_here"],m=["bound"];function f(e,t=m){const s={};return(0,p.Ed)(e,((e,r)=>{if(!e||!r)return;r.split(h.ZA).forEach((r=>{-1===t.indexOf(r)&&("work_time"!==r||"today,alltime"!==e?-1===g.indexOf(r)?s["attr["+r+"]"]=e:s[r]=e:s["attr[work_round_the_clock]"]="true")}))})),s}const b=["bound","sort"];var _=s(37144);const y={search:["adm_div.city","adm_div.district","adm_div.district_area","adm_div.division","adm_div.living_area","adm_div.place","adm_div.region","adm_div.settlement","attraction","branch","building","crossroad","foreign_city","gate","parking","road","route","station","street","coordinates","kilometer_road_sign"],suggest:["adm_div.city","adm_div.district","adm_div.district_area","adm_div.division","adm_div.living_area","adm_div.place","adm_div.region","adm_div.settlement","attraction","building","crossroad","foreign_city","road","route_type","route","station.metro","station","street","user_queries","rubric","meta_rubric"],objectSuggest:["adm_div.region","adm_div.district_area","adm_div.city","adm_div.settlement","adm_div.district","adm_div.living_area","adm_div.division","adm_div.place","street","branch","building","road","attraction","crossroad","route","route_type","station","station.metro","user_queries","attribute","rubric","meta_rubric","org","special","coordinates","kilometer_road_sign"]},E=(0,_.HP)(((e,t)=>{const s=y[e];if(0===t.length)return s.join(",");const r=t.split(",");return s.filter((e=>-1===r.indexOf(e))).join(",")}));function O(e){const[t,s]=e;return{viewpoint1:`${t.lon},${t.lat}`,viewpoint2:`${s.lon},${s.lat}`}}function v(e,t){if("true"!==t.bound)return{};const[s,r]=e;return{point1:`${s.lon},${s.lat}`,point2:`${r.lon},${r.lat}`}}function j(e,t){return"broadcast"===t?"branch":E("search",e)}function R(e){return e?`${e.lon},${e.lat}`:void 0}const I=e=>e?Object.assign({},O(e)):{};function S(e){return Object.keys(e).map((t=>({key:t,value:(e[t]||"").toString()}))).sort(((e,t)=>e.key<t.key?-1:e.key>t.key?1:0)).map((e=>e.value)).join("")}function T(e){return e.split("?")[0].replace(/^[^/]*\/\/[^/]+\//,"/")}const A=[22,4147,1234,11],C=A[0]+A[3],w=A[1]+A[2];function k(e,t,s){const r=S(t);return U(T(e)+r+s)}function U(e){const t=e.length;let s=w;for(let r=0;r<t;r+=1)s=s*C+e.charCodeAt(r),s>>>=0;return s}const N={"items.locale":!0,"items.flags":!0,search_attributes:!0,"items.adm_div":!0,"items.city_alias":!0,"items.region_id":!0,"items.segment_id":!0,"items.reviews":!0,"items.point":!0,request_type:!0,context_rubrics:!0,query_context:!0,"items.links":!0,"items.name_ex":!0,"items.name_back":!0,"items.org":!0,"items.group":!0,"items.dates":!0,"items.external_content":!0,"items.contact_groups":!0,"items.comment":!0,"items.ads.options":!0,"items.email_for_sending.allowed":!0,"items.stat":!0,"items.stop_factors":!0,"items.description":!0,"items.geometry.centroid":!0,"items.geometry.selection":!0,"items.geometry.style":!0,"items.timezone_offset":!0,"items.context":!0,"items.level_count":!0,"items.address":!0,"items.is_paid":!0,"items.access":!0,"items.access_comment":!0,"items.for_trucks":!0,"items.is_incentive":!0,"items.paving_type":!0,"items.capacity":!0,"items.schedule":!0,"items.floors":!0,dym:!0,ad:!0,"items.rubrics":!0,"items.routes":!0,"items.platforms":!0,"items.directions":!0,"items.barrier":!0,"items.reply_rate":!0,"items.purpose":!0,"items.attribute_groups":!0,"items.route_logo":!0,"items.has_goods":!0,"items.has_apartments_info":!0,"items.has_pinned_goods":!0,"items.has_realty":!0,"items.has_exchange":!0,"items.has_payments":!0,"items.has_dynamic_congestion":!0,"items.is_promoted":!0,"items.congestion":!0,"items.delivery":!0,"items.order_with_cart":!0,search_type:!0,"items.has_discount":!0,"items.metarubrics":!0,broadcast:!0,"items.detailed_subtype":!0,"items.temporary_unavailable_atm_services":!0,"items.poi_category":!0},P={getRegion:["items.code","items.uri_code","items.uri_aliases","items.name_grammatical_cases","items.time_zone","items.statistics","items.domain","items.locale","items.locales","items.satellites","items.bounds","items.country_code","items.zoom_level","items.default_pos","items.flags"].join(","),getRoute:["items.region_id","items.segment_id"].join(","),getItemList:Object.keys((0,p.CE)(N,["items.level_count","items.platforms","items.directions","items.barrier","items.dates","items.contact_groups","items.stop_factors","items.has_exchange","items.congestion","items.has_dynamic_congestion"])).join(","),getItemListWithoutContextRubrics:Object.keys((0,p.CE)(N,["items.level_count","items.platforms","items.directions","items.barrier","items.attribute_groups","items.dates","items.contact_groups","items.email_for_sending.allowed","items.stop_factors","context_rubrics","query_context","items.has_exchange","items.congestion","items.has_dynamic_congestion"])).join(","),getItem:Object.keys((0,p.CE)(N,["dym"])).concat(["items.structure_info.material","items.structure_info.floor_type","items.structure_info.gas_type","items.structure_info.year_of_construction","items.structure_info.elevators_count","items.structure_info.is_in_emergency_state","items.structure_info.project_type"]).join(","),getSuggestions:["items.name_ex","items.rubrics","items.org","items.adm_div","items.routes","items.type","items.subtype","items.address","items.search_attributes.personal_priority","items.search_attributes.dgis_source_type","items.search_attributes.dgis_found_by_address","items.segment_id","items.region_id","items.locale","items.group","items.context","search_attributes","items.flags","items.has_exchange","items.ads.options"].join(","),markers:["items.ads","items.name","items.stop_factors","items.reviews","items.schedule","items.context","items.name_ex","items.timezone_offset","items.flags","items.has_exchange","items.temporary_unavailable_atm_services","search_attributes"].join(","),getItemByEntrance:["items.locale","items.adm_div","items.region_id","items.segment_id","items.group","items.address","items.floors"].join(",")};function L(e,t){switch(e){case 6:case 7:return"adm_div.region,adm_div.district_area";case 8:case 9:case 10:return"adm_div.city,adm_div.region,adm_div.district_area,adm_div.settlement,road";case 11:return"adm_div.city,adm_div.region,adm_div.settlement,road,adm_div.district_area,adm_div.division";case 12:return"adm_div.city,adm_div.region,adm_div.settlement,road,adm_div.district_area,adm_div.division,adm_div.district";case 13:return"adm_div.city,adm_div.region,adm_div.settlement,road,adm_div.district_area,adm_div.division,adm_div.district"+(t?"":",poi");case 14:return"adm_div.city,adm_div.region,adm_div.settlement,road,adm_div.district_area,adm_div.division,adm_div.district,street,adm_div.living_area,crossroad"+(t?"":",poi");case 15:case 16:return"adm_div.city,adm_div.region,adm_div.settlement,road,adm_div.district_area,adm_div.division,adm_div.district,street,adm_div.living_area,crossroad,building,adm_div.place"+(t?"":",poi");case 17:return"adm_div.city,adm_div.region,adm_div.settlement,road,adm_div.district_area,adm_div.division,adm_div.district,street,adm_div.living_area,crossroad,building,adm_div.place,attraction,parking"+(t?"":",poi");case 18:case 19:case 20:return"adm_div.city,adm_div.region,adm_div.settlement,road,adm_div.district_area,adm_div.division,adm_div.district,street,adm_div.living_area,crossroad,building,adm_div.place,attraction,parking,gate"+(t?"":",poi");default:return"adm_div.region"}}var H=s(44390),F=s(68671);const D=6e4;function B(e){const{timeToLive:t,errorTtl:s=D,staleWhileRevalidate:r=!1}=e;return{timeToLive:t,errorTtl:s,staleWhileRevalidate:r,data:{}}}function $(e){const{key:t,store:s,request:r}=e,{data:a,timeToLive:i,errorTtl:n,staleWhileRevalidate:o}=s;if("undefined"!=typeof process){const e=process.env.DESKTOP_DISABLE_SERVER_CACHE;if("true"===String(e).toLowerCase())return r()}let c=a[t];if(!c||c.expires<Date.now()){const e=Date.now()+i;if(c&&o){c.expires=e;const t=r().then((e=>(c.promise=t,e))).catch((()=>(c.expires=Date.now()+n,c.promise))).catch((()=>{}))}else c={promise:r().catch((e=>{throw c.expires=Date.now()+n,e})),expires:e},a[t]=c}return c.promise}var q=s(83466);function G(e,t){const s=e.items,r={};for(const e of s)(0,p.xb)(e.default_pos)?(0,q.H)({message:`Region without default_pos: ${e.code} `,level:"fatal",requestId:t.requestId,id:"dh57w",payload:{type:"exception",subtype:"InvalidRegion",data:JSON.stringify(e)}}):(r[e.id]=e,r[e.code]=e);return{result:{items:s,hashMap:r}}}var x=s(27087),M=s(11252);function Y(e){return 404===e.code?{}:e.items.reduce(((e,t)=>{const{region_id:s,id:r,name:a,alias:i,simple_geometry:n}=t;return s&&"0"!==s&&(e[r]={id:r,region_id:s,name:a,alias:i,default_pos:(0,M.$)(n)}),e}),{})}var z=s(25627);const K=B({timeToLive:6e4,staleWhileRevalidate:!0}),Q=B({timeToLive:6e4,staleWhileRevalidate:!0});class V{constructor(e,t){this.request=e,this.KEY=t.webApiKey,this.a="baf4c54e9dae";const s=t.webApiUrl,r=t.webApi3Url;this.RUBRICATOR_GET_URL=`${r}rubricator/get`,this.RUBRICATOR_DASHBOARD_URL=`${r}rubricator/dashboard`,this.RUBRICATOR_LIST_URL=`${r}rubricator/list`,this.RUBRICS_TREE_URL=`${s}catalog/rubric/list`,this.DETECT_REGION_URL=`${r}dashboard/geo/items`,this.DASHBOARD_ADS_GET_URL=`${r}ads/advise/gta/online/dashboard`,this.ADS_ADVISE_GTA_ONLINE=`${r}ads/advise/gta/online`,this.SEARCH_FIRM_URL=`${r}items`,this.GET_ITEM_URL=`${r}items/byid`,this.SEARCH_GEO_URL=`${s}geo/search`,this.SEARCH_CLUSTERED_MARKERS_URL=`${r}markers/clustered`,this.SEARCH_MARKERS_URL=`${r}markers`,this.SUGGESTS_URL=`${s}suggest/list`,this.OBJECTS_SUGGESTS_URL=`${r}suggests`,this.PROFILE_URL=`${r}profile/data`,this.REGIONS_URL=`${s}region/list`,this.SETTLEMENTS_URL=`${r}aliases`,this.REGION_INFO=`${s}region/get`,this.BRANCH_GET_URL=`${s}catalog/branch/get`,this.BRANCH_LIST_URL=`${s}catalog/branch/list`,this.GET_ITEM_BY_ENTRACE_URL=`${r}items/byentrance`,F.sk&&(this.REQUEST_ID=t.requestId),this.sendPrivacyData=!t.featureReadOnly,this.userId=t.userId,this.sessionId=t.sessionId,this.appVersion=(0,z.n)(t.commitIsoDate),this.excludeTypesFromSearch=t.excludeTypesFromSearch,this.debugMode=t.srchdbgmd,this.searchDeviceType=t.searchDeviceType,this.searchUserHash=t.searchUserHash}getRegionsList({locale:e}){return $({key:e||"",store:K,request:()=>{const t={fields:P.getRegion,key:this.KEY,locale:e,page_size:2e3};return this.request(this.REGIONS_URL,this.extendParams(t,this.REGIONS_URL)).then(l).then((e=>G(e,{requestId:this.REQUEST_ID}))).catch((0,n.No)("regionsList",t,this.REQUEST_ID))}})}getSettlementsList({locale:e}){return $({key:e||"",store:Q,request:()=>{const t={key:this.KEY,locale:e,page_size:2e3};return this.request(this.SETTLEMENTS_URL,this.extendParams(t,this.SETTLEMENTS_URL)).then(l).then(Y).catch((e=>{if("itemNotFound"===(null==e?void 0:e.name))return{};throw e})).catch((0,n.No)("aliases",t,this.REQUEST_ID))}})}searchByQuery({query:e,page:t=1,pageSize:s,regionId:r,viewpoint:a,filters:i={},withFilters:o=!1,isViewportChanged:c=!1,sortPoint:u,locale:p,fields:h,adsIds:g,searchKey:m,cityId:b,accessToken:_}){const y=h||P.getItemList+(o?",filters,widgets":""),E=e&&!g?e:void 0,I=Object.assign(Object.assign(Object.assign(Object.assign({key:this.KEY,region_id:"0"!==r?r:void 0,q:E,sort_point:R(u),fields:y,type:j(this.excludeTypesFromSearch,m),page_size:s||H.Cz,ads_id:g,page:t,locale:p,allow_deleted:!0,location:R(u),search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash,city_id:b},c?{is_viewport_change:!0}:{}),O(a)),f(i)),v(a,i));return this.request(this.SEARCH_FIRM_URL,this.extendParams(I,this.SEARCH_FIRM_URL,_?{headers:{Authorization:`Bearer ${_}`}}:void 0)).then(d(this.SEARCH_FIRM_URL)).then(l).catch((0,n.No)("searchFirmByQuery",I,this.REQUEST_ID))}getSearchFilters({regionId:e,query:t,viewpoint:s,rubrId:r,locale:a,filters:i={},sortPoint:o}){const c=r?{rubric_id:r}:{q:t},u=Object.assign(Object.assign(Object.assign(Object.assign({key:this.KEY,locale:a},c),{region_id:"0"!==e?e:void 0,page:1,page_size:1,type:E("search",this.excludeTypesFromSearch),fields:"filters,widgets",allow_deleted:!0,location:R(o),search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash}),O(s)),f((0,x.ei)(i,["rubric_id"])));return this.request(this.SEARCH_FIRM_URL,this.extendParams(u,this.SEARCH_FIRM_URL)).then(d(this.SEARCH_FIRM_URL)).then(l).catch((0,n.No)("getSearchFilters",u,this.REQUEST_ID))}getSearchFilialsFilters({orgId:e,viewpoint:t,locale:s}){const r=Object.assign({key:this.KEY,locale:s,org_id:e,page:1,page_size:1,fields:"filters,widgets",search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash},O(t));return this.request(this.SEARCH_FIRM_URL,this.extendParams(r,this.SEARCH_FIRM_URL)).then(d(this.SEARCH_FIRM_URL)).then(l).catch((0,n.No)("getSearchFilters",r,this.REQUEST_ID))}searchByPoint({point:e,zoom:t,locale:s,viewpoint:r,is3dEnabled:a=!1}){const i=Math.round(Math.min(t,H.m8)),o=Object.assign(Object.assign({key:this.KEY,point:`${e.lon},${e.lat}`,type:L(i,a),fields:P.getItemList,page_size:1,locale:s},!a&&{zoom_level:i}),I(r));return this.request(this.SEARCH_GEO_URL,this.extendParams(o,this.SEARCH_GEO_URL)).then(l).then(c(this.SEARCH_GEO_URL)).catch((0,n.No)("searchByPoint",o,this.REQUEST_ID))}clusteredMarkersQuery({query:e,filters:t={},rubrId:s,buildingId:r,orgId:a,isViewportChanged:i=!1,viewpoint:o,locale:c,mapSize:u,attrId:p,markersWithLogoIds:h,adsIds:g,sortPoint:m,accessToken:_}){const y=!e||p||g?void 0:e,j=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({key:this.KEY,map_width:u.width,map_height:u.height,locale:c,q:y,rubric_id:s,building_id:r,org_id:a,allow_deleted:!0,ads_id:g,type:E("search",this.excludeTypesFromSearch),location:R(m),search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash},function(e){return e?{[`attr[${e}]`]:!0}:{}}(p)),i?{is_viewport_change:!0}:{}),O(o)),v(o,t)),function(e){return f(e,b)}(t)),(null==h?void 0:h.length)?{marker_ids:h.join(",")}:{}),{fields:P.markers});return this.request(this.SEARCH_CLUSTERED_MARKERS_URL,this.extendParams(j,this.SEARCH_CLUSTERED_MARKERS_URL,_?{headers:{Authorization:`Bearer ${_}`}}:void 0)).then(d(this.SEARCH_CLUSTERED_MARKERS_URL)).then(l).catch((0,n.No)("clusteredMarkersQuery",j,this.REQUEST_ID))}getInfrastructure({rubrIds:e,radius:t,center:s,locale:r,screen:a}){const i={key:this.KEY,map_width:a.width,map_height:a.height,locale:r,radius:t,lon:s.lon,lat:s.lat,rubric_id:e.join(","),type:E("search",this.excludeTypesFromSearch),search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash,fields:P.markers};return this.request(this.SEARCH_MARKERS_URL,this.extendParams(i,this.SEARCH_MARKERS_URL)).then(d(this.SEARCH_MARKERS_URL)).then(l).catch((0,n.No)("getInfrastructure",i,this.REQUEST_ID))}searchFilials({orgId:e,page:t=1,pageSize:s,regionId:r,viewpoint:a,filters:i={},withFilters:o=!1,isViewportChanged:c=!1,sortPoint:u,locale:p,fields:h,searchDisableClippingByRelevance:g=!0,cityId:m,accessToken:b}){const _=Object.assign(Object.assign(Object.assign(Object.assign({page:t,page_size:s||H.Cz,org_id:e,region_id:"0"!==r?r:void 0,sort_point:R(u),fields:h||`${P.getItemList}${o?",filters,widgets":""}`,key:this.KEY,type:"branch",locale:p,search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash,search_disable_clipping_by_relevance:g,location:R(u),city_id:m},f(i)),c?{is_viewport_change:!0}:{}),O(a)),v(a,i));return this.request(this.SEARCH_FIRM_URL,this.extendParams(_,this.SEARCH_FIRM_URL,b?{headers:{Authorization:`Bearer ${b}`}}:void 0)).then(d(this.SEARCH_FIRM_URL)).then(l).catch((0,n.No)("searchFilials",_,this.REQUEST_ID))}searchByBuildingId({buildingId:e,viewpoint:t,page:s=1,filters:r,locale:a,fields:i}){const o=r?f(r):void 0,d=Object.assign(Object.assign({key:this.KEY,building_id:e,fields:i||P.getItemListWithoutContextRubrics,locale:a,page_size:H.Cz,page:s},I(t)),o);return this.request(this.BRANCH_LIST_URL,this.extendParams(d,this.BRANCH_LIST_URL)).then(l).then(c(this.BRANCH_LIST_URL)).catch((0,n.No)("fetchInBuildingList",d,this.REQUEST_ID))}searchInBuildingByQuery({buildingId:e,page:t=1,query:s,filters:r,viewpoint:a,locale:i,fields:o,withFilters:c=!1,sortPoint:u}){const p=o||P.getItemList+(c?",filters,widgets":""),h=r?f(r):void 0,g=Object.assign(Object.assign({key:this.KEY,building_id:e,q:s,fields:p,page_size:H.Cz,search_type:"indoor",locale:i,page:t,location:R(u),search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash,allow_deleted:!0},h),I(a));return this.request(this.SEARCH_FIRM_URL,this.extendParams(g,this.SEARCH_FIRM_URL)).then(d(this.SEARCH_FIRM_URL)).then(l).catch((0,n.No)("searchInBuildingByQuery",g,this.REQUEST_ID))}searchMaintainers({buildingId:e,page:t=1,withStandardPageSize:s=!1,viewpoint:r,locale:a,fields:i}){const o=Object.assign({servicing:!0,servicing_group:"default",page_size:s?H.Cz:void 0,key:this.KEY,building_id:e,locale:a,fields:i||P.getItemList,page:t},I(r));return this.request(this.BRANCH_LIST_URL,this.extendParams(o,this.BRANCH_LIST_URL)).then(l).then(c(this.BRANCH_LIST_URL)).catch((0,n.No)("searchMaintainers",o,this.REQUEST_ID))}searchProviders({buildingId:e,page:t=1,withStandardPageSize:s=!1,viewpoint:r,locale:a,fields:i}){const o=Object.assign({servicing:!0,servicing_group:"internet",page_size:s?H.Cz:void 0,key:this.KEY,building_id:e,locale:a,fields:i||P.getItemList,page:t},I(r));return this.request(this.BRANCH_LIST_URL,this.extendParams(o,this.BRANCH_LIST_URL)).then(l).then(c(this.BRANCH_LIST_URL)).catch((0,n.No)("searchProviders",o,this.REQUEST_ID))}searchSuggestionsByQuery({regionId:e,query:t,types:s,type:r,locale:a}){const i={key:this.KEY,locale:a,q:t,region_id:"0"!==e?e:void 0,types:s&&s.length?s.join(","):E("suggest",this.excludeTypesFromSearch),type:r};return this.request(this.SUGGESTS_URL,this.extendParams(i,this.SUGGESTS_URL)).then(l).then(c(this.SUGGESTS_URL)).catch((0,n.No)("searchSuggestionsByQuery",i,this.REQUEST_ID))}searchObjectSuggestions({query:e,types:t,locale:s,regionId:r,viewpoint:a,sortPoint:i,suggesterType:o,personalRecords:c}){const u=t?t.join(","):E("objectSuggest",this.excludeTypesFromSearch),p=Object.assign(Object.assign({key:this.KEY,q:e,suggesttype:o},O(a)),{region_id:"0"!==r?r:void 0,fields:P.getSuggestions,type:"route_endpoint"===o?`${u},parking`:u,location:R(i),search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash,locale:s}),h=c&&c.length>0?{method:"post",data:{personal_records:c}}:void 0;return this.request(this.OBJECTS_SUGGESTS_URL,this.extendParams(p,this.OBJECTS_SUGGESTS_URL,h)).then(d(this.OBJECTS_SUGGESTS_URL)).then(l).catch((0,n.No)("searchObjectSuggestions",h?Object.assign(Object.assign({},h),p):p,this.REQUEST_ID))}getProfile({userId:e,authId:t}){const s={key:this.KEY,user_id:e,auth_id:t};return this.request(this.PROFILE_URL,this.extendParams(s,this.PROFILE_URL)).then(l).catch((0,n.No)("getProfile",s,this.REQUEST_ID))}getItem({id:e,fields:t,locale:s,clickPoint:r,viewpoint:a,contextRubrics:i,adsId:o}){const c=Object.assign(Object.assign(Object.assign({id:e,key:this.KEY,locale:s,fields:t||P.getItem,clickPoint:r?`${r.lon},${r.lat}`:void 0},(u=i)&&u.length?u.reduce(((e,t)=>(e[t.group]=e[t.group]||[],e[t.group].push(t.id),e)),[]).reduce(((e,t,s)=>(e[`context_rubrics[${s}]`]=t.join(","),e)),{}):{}),I(a)),o?{ads_id:o}:{});var u;return this.request(this.GET_ITEM_URL,this.extendParams(c,this.GET_ITEM_URL)).then(d(this.GET_ITEM_URL)).then(l).catch((0,n.No)("getItem",c,this.REQUEST_ID))}fetchApartments(e){const t={id:e.id,key:this.KEY,locale:e.locale,fields:"items.links,items.links.database_entrances.apartments_info"},s=this.extendParams(t,this.GET_ITEM_URL),r={Authorization:`Bearer ${e.accessToken}`};return this.request(this.GET_ITEM_URL,Object.assign(Object.assign({},s),{headers:r})).then(l).catch((0,n.No)("fetchApartments",t,this.REQUEST_ID))}getItems({ids:e,fields:t,locale:s,clickPoint:r,viewpoint:a}){const i=Object.assign({id:e.join(","),key:this.KEY,locale:s,fields:t||P.getItem,clickPoint:r?`${r.lon},${r.lat}`:void 0},I(a));return this.request(this.GET_ITEM_URL,this.extendParams(i,this.GET_ITEM_URL)).then(d(this.GET_ITEM_URL)).then(l).catch((0,n.No)("getItem",i,this.REQUEST_ID))}getProfiles({ids:e,viewpoint:t,locale:s},r){const a=Object.assign({id:e.join(","),key:this.KEY,locale:s,fields:r||P.getItemList,allow_deleted:!0},I(t));return this.request(this.BRANCH_GET_URL,this.extendParams(a,this.BRANCH_GET_URL)).then(l).then(c(this.BRANCH_GET_URL)).catch((0,n.No)("getProfiles",a,this.REQUEST_ID))}getRegionById({id:e,locale:t}){const s=t=>({result:t.result.hashMap[e]}),r=function({key:e,store:t}){const s=t.data[e];if(s)return t.staleWhileRevalidate||s.expires>Date.now()?s.promise:void 0}({key:t||"",store:K});if(r)return r.then(s);const a={fields:P.getRegion,id:e,key:this.KEY,locale:t};return this.request(this.REGION_INFO,this.extendParams(a,this.REGION_INFO)).then(l).then((e=>G(e,{requestId:this.REQUEST_ID}))).then(s).catch((0,n.No)("getRegionById",a,this.REQUEST_ID))}searchParkingsAround({point:{lon:e,lat:t},radius:s,fields:r,locale:a}){const i={type:"parking",key:this.KEY,locale:a,point:`${e},${t}`,radius:s,fields:r||P.getItemList};return this.request(this.SEARCH_GEO_URL,this.extendParams(i,this.SEARCH_GEO_URL)).then(d(this.SEARCH_GEO_URL)).then(l).catch((0,n.No)("searchParkingsAround",i,this.REQUEST_ID))}searchFirmByRubric({page:e=1,rubrId:t,regionId:s,viewpoint:r,filters:a={},sortPoint:i,pageSize:o,locale:c,fields:u,withFilters:p=!1,cityId:h,accessToken:g}){const m=Object.assign(Object.assign(Object.assign({page:e,page_size:o||H.Cz,rubric_id:t,region_id:"0"!==s?s:void 0,sort_point:R(i),fields:u||`${P.getItemList}${p?",filters,widgets":""}`,key:this.KEY,locale:c,search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash,location:R(i),city_id:h},O(r)),v(r,a)),f(a));return this.request(this.SEARCH_FIRM_URL,this.extendParams(m,this.SEARCH_FIRM_URL,g?{headers:{Authorization:`Bearer ${g}`}}:void 0)).then(d(this.SEARCH_FIRM_URL)).then(l).catch((0,n.No)("searchFirmByRubric",m,this.REQUEST_ID))}searchFirmByAttribute({page:e=1,attrId:t,regionId:s,viewpoint:r,filters:a={},sortPoint:i,pageSize:o,locale:d,fields:u,withFilters:p=!1,accessToken:h}){const g=Object.assign(Object.assign(Object.assign({page:e,page_size:o||H.Cz,[`attr[${t}]`]:!0,region_id:"0"!==s?s:void 0,sort_point:R(i),fields:u||`${P.getItemList}${p?",filters,widgets":""}`,key:this.KEY,locale:d,allow_deleted:!0,search_device_type:this.searchDeviceType,search_user_hash:this.searchUserHash,location:R(i)},O(r)),v(r,a)),f(a));return this.request(this.SEARCH_FIRM_URL,this.extendParams(g,this.SEARCH_FIRM_URL,h?{headers:{Authorization:`Bearer ${h}`}}:void 0)).then(l).then(c(this.SEARCH_FIRM_URL)).catch((0,n.No)("searchFirmByAttribute",g,this.REQUEST_ID))}getRubric(e){const t={id:e.id,region_id:"0"!==e.regionId?e.regionId:void 0,locale:e.locale,key:this.KEY};return this.request(this.RUBRICATOR_GET_URL,this.extendParams(t,this.RUBRICATOR_GET_URL)).then(l).catch((0,n.No)("getRubric",e,this.REQUEST_ID))}getDashboard(e){const t=e.viewpoint?O(e.viewpoint):{},s=Object.assign(Object.assign({region_id:"0"!==e.regionId?e.regionId:void 0,locale:e.locale},t),{key:this.KEY});return this.request(this.RUBRICATOR_DASHBOARD_URL,this.extendParams(s,this.RUBRICATOR_DASHBOARD_URL)).then(l).catch((0,n.No)("getDashboard",e,this.REQUEST_ID))}deprecatedGetRubricatorList(e){const t={parent_id:e.activeMetarubric&&e.activeMetarubric.id,region_id:"0"!==e.regionId?e.regionId:void 0,locale:e.locale,key:this.KEY};return this.request(this.RUBRICATOR_LIST_URL,this.extendParams(t,this.RUBRICATOR_LIST_URL)).then(l).then((t=>{if(200===t.code)return Object.assign(Object.assign({},t),{activeMetarubric:e.activeMetarubric});throw new u.F7("Rubricator list not found",404)})).catch((0,n.No)("deprecatedRubricatorList",e,this.REQUEST_ID))}getRubricatorList(e){const t=Object.assign(Object.assign({parent_id:e.parentId,region_id:"0"!==e.regionId?e.regionId:void 0,locale:e.locale},O(e.viewpoint)),{key:this.KEY});return this.request(this.RUBRICATOR_LIST_URL,this.extendParams(t,this.RUBRICATOR_LIST_URL)).then(l).catch((0,n.No)("getRubricatorList",e,this.REQUEST_ID))}getRubricsTree(e){if("0"===e.regionId)return Promise.resolve([]);const t={key:this.KEY,region_id:"0"!==e.regionId?e.regionId:void 0,locale:e.locale,fields:"items.rubrics"};return this.request(this.RUBRICS_TREE_URL,this.extendParams(t,this.RUBRICS_TREE_URL)).then(l).then((e=>{if(200!==e.code)throw new u.F7("Rubrics tree not found",404);return e.items})).catch((0,n.No)("getRubricsTree",e,this.REQUEST_ID))}detectRegion(e){const t={key:this.KEY,locale:e.locale,limit:1,zoom_level:Math.min(e.zoomLevel,H.m8),k_area:.25,k_distance:.45,k_branches:.05,k_from_region:.25,min_percent_intersection_of_screen:5,distance_to_field:"board",geometry:e.geometry};return this.request(this.DETECT_REGION_URL,this.extendParams(t,this.DETECT_REGION_URL)).then(l).catch((0,n.No)("detectRegion",e,this.REQUEST_ID))}getAdsAdviseGtaOnline(e){const t={key:this.KEY},s="0"!==e.regionId&&e.regionId?+e.regionId:void 0,r={withCredentials:this.sendPrivacyData,method:"post",data:Object.assign(Object.assign({},this.enableDebug()),{shv:this.appVersion,user_id:this.sendPrivacyData?this.userId:void 0,key:this.KEY,auth_user_id:e.authUserId,locale:e.locale,product_id:e.productId,viewport:e.viewport,query:e.query,region_id:s,user_location:e.userLocation,banner_slot:e.bannerSlot,query_context_rubrics:e.rubrics})};return this.request(this.ADS_ADVISE_GTA_ONLINE,this.extendParams(t,this.ADS_ADVISE_GTA_ONLINE,r)).then(l).catch((0,n.No)("getAdsAdvise",e,this.REQUEST_ID))}getDashboardAds(e){const t={key:this.KEY},s={withCredentials:this.sendPrivacyData,method:"post",data:Object.assign(Object.assign({},this.enableDebug()),{shv:this.appVersion,user_id:this.sendPrivacyData?this.userId:void 0,key:this.KEY,auth_user_id:e.authUserId,locale:e.locale,product_id:e.productId,viewport:e.viewport,region_id:"0"!==e.regionId?e.regionId:void 0,user_location:e.userLocation})};return this.request(this.DASHBOARD_ADS_GET_URL,this.extendParams(t,this.DASHBOARD_ADS_GET_URL,s)).then(l).catch((0,n.No)("getDashboardAds",e,this.REQUEST_ID))}getItemByEntrance({id:e,locale:t}){const s={id:e,key:this.KEY,locale:t,fields:P.getItemByEntrance};return this.request(this.GET_ITEM_BY_ENTRACE_URL,this.extendParams(s,this.GET_ITEM_BY_ENTRACE_URL)).then(d(this.GET_ITEM_BY_ENTRACE_URL)).then(l).catch((0,n.No)("getItemByEntrance",s,this.REQUEST_ID))}enableDebug(){return this.debugMode?{debug:this.debugMode}:{}}extendParams(e,t,s){const r=Object.assign({withCredentials:this.sendPrivacyData},s),a=Object.assign(Object.assign(Object.assign({},e),this.enableDebug()),{"stat[sid]":this.sessionId,"stat[user]":this.sendPrivacyData?this.userId:void 0,shv:this.appVersion});return Object.assign({params:Object.assign(Object.assign({},a),{r:k(t,a,this.a)})},r)}}var W=s(7459),J=s(45488);const Z=6e4;function X(e,t){return Object.assign(Object.assign({},(0,W.G)(e,t)),function(e,t){const{photoApiKeyProfile:s,photoApiKey:r,photoApiUrl:a,requestId:i}=t;function o(e){return{"Auth-Version":"2.0","Auth-Token":e}}return{addPhoto({uid:t,objectId:c,objectType:d,albumCode:u,locale:l,regionId:p,accessToken:h,isReplaced:g,isMenuPhoto:m}){const f=new FormData;f.append("key","profile"===d?s:r),f.append("object_id",c),f.append("object_type",d),f.append("album_code",u),f.append("locale",l),f.append("region_id",p),f.append("items[0][uid]",t),m&&f.append("items[0][tag_code]","price_list_image"),g&&f.append("replace","true");const b=o(h);return e(`${a}2.0/photo/add`,{method:"post",headers:b,data:f}).then(J.tb).catch((0,n.No)("addPhotos",{objectId:c,objectType:d,albumCode:u},i))},deletePhoto({objectId:t,objectType:s,photoId:c,accessToken:d}){const u=new FormData;u.append("key",r),u.append("object_id",t),u.append("object_type",s),u.append("id",c);const l=`${a}2.0/photo/delete`,p=o(d);return e(l,{method:"post",headers:p,data:u}).then(J.Lg).catch((0,n.No)("deletePhoto",{objectId:t,objectType:s,photoId:c,accessToken:d},i))},uploadPhoto({id:t,hash:c,file:d,accessToken:u,objectType:l}){const p=new FormData;p.append("key","profile"===l?s:r),p.append("items[0][id]",t),p.append("items[0][hash]",c),p.append("items[0][file]",d,d.name),p.append("preview_size",W.s);const h=o(u);return e(`${a}2.0/photo/upload`,{method:"post",headers:h,data:p,timeout:Z}).then(J.dD).catch((0,n.No)("uploadPhoto",{id:t,hash:c,fileName:d.name,accessToken:u},i))}}}(e,t))}class ee{constructor(e,t){this.request=e,this.URL=t.profileApiUrl,this.REQUEST_ID=t.requestId,this.userId=t.userId}clearSearchHistory({authId:e}={}){const t={ts:Date.now(),userId:e?this.userId:void 0},s=e?`${this.URL}/authuser/${e}/profile/history/clear`:`${this.URL}/user/${this.userId}/profile/history/clear`;return this.request(s,{withCredentials:!1,method:"post",params:t}).then((()=>({code:200}))).catch((0,n.No)("clearSearchHistory",t,this.REQUEST_ID))}}var te=s(25521);const se={branches:["meta.providers","meta.branch_rating","meta.branch_reviews_count","meta.total_count","reviews.hiding_reason","reviews.is_verified"].join(","),geo:["meta.providers","meta.geo_rating","meta.geo_reviews_count","meta.total_count","reviews.hiding_reason"].join(","),orgs:["meta.org_rating","meta.org_reviews_count","meta.total_count","reviews.object.address","reviews.hiding_reason","reviews.is_verified"].join(","),user:["reviews.object.address","reviews.object.logo","reviews.object.name","reviews.object.is_deleted","reviews.hiding_reason","reviews.is_verified"].join(","),create:["reviews.hiding_reason"].join(","),edit:["reviews.hiding_reason"].join(",")};class re{constructor(e,t){this.PAGE_SIZE=12,this.UNCONFIRMED_PAGE_SIZE=50,this.request=e,this.BASE_URL=t.reviewApiUrl,this.REQUEST_ID=t.requestId,this.KEY=t.reviewApiKey}getBranchReviews({id:e,offset:t,isAdvertiser:s=!1,withAnswer:r,ratings:a,unconfirmed:i,pageSize:o=(i?this.UNCONFIRMED_PAGE_SIZE:this.PAGE_SIZE),accessToken:c,facts:d,newtworkTimeout:u,locale:l}){const p={limit:o,offset_date:t,ratings:a,is_advertiser:s,with_answer:r,fields:se.branches,without_my_first_review:!!c,rated:!i,facts:d,sort_by:"date_edited",key:this.KEY,locale:l};return this.request(`${this.BASE_URL}branches/${e}/reviews`,{params:p,headers:Object.assign({},c?{Authorization:`Bearer ${c}`}:void 0),withCredentials:!1,timeout:u}).then(ie).catch((0,n.No)("getBranchReviews",p,this.REQUEST_ID))}getGeoReviews({id:e,offset:t,pageSize:s=this.PAGE_SIZE,ratings:r,accessToken:a,newtworkTimeout:i,locale:o}){const c={limit:s,offset_date:t,ratings:r,fields:se.geo,sort_by:"date_edited",without_my_first_review:!!a,key:this.KEY,locale:o};return this.request(`${this.BASE_URL}geo/${e}/reviews`,{params:c,headers:Object.assign({},a?{Authorization:`Bearer ${a}`}:void 0),withCredentials:!1,timeout:i}).then(ie).catch((0,n.No)("getGeoReviews",c,this.REQUEST_ID))}getOrgReviews({id:e,offset:t,withAnswer:s,ratings:r,accessToken:a,unconfirmed:i,pageSize:o=(i?this.UNCONFIRMED_PAGE_SIZE:this.PAGE_SIZE),facts:c,newtworkTimeout:d,locale:u}){const l={limit:o,offset_date:t,ratings:r,with_answer:s,fields:se.orgs,without_my_first_review:!!a,rated:!i,facts:c,sort_by:"date_edited",key:this.KEY,locale:u};return this.request(`${this.BASE_URL}orgs/${e}/reviews`,{params:l,headers:Object.assign({},a?{Authorization:`Bearer ${a}`}:void 0),withCredentials:!1,timeout:d}).then(ie).catch((0,n.No)("getReviews",l,this.REQUEST_ID))}getUserReviews(e){const t={limit:this.PAGE_SIZE,locale:e.locale,fields:se.user,offset_date:e.offset,sort_by:"date_edited",key:this.KEY},s=`${this.BASE_URL}users/2gis/${e.userId}/reviews`;return this.request(s,{params:t,headers:{Authorization:`Bearer ${e.accessToken}`},withCredentials:!1}).then(oe).catch((0,n.No)("getUserReviews",t,this.REQUEST_ID))}getUserReviewsByObject(e){const t=`${this.BASE_URL}users/2gis/${e.userId}/reviews/by-objects`;return this.request(t,{method:"get",params:{objects_ids:e.entityId,limit:1,fields:se.user,key:this.KEY,locale:e.locale},headers:{Authorization:`Bearer ${e.accessToken}`},withCredentials:!1}).then(oe).catch((0,n.No)("getUserReviews",(0,p.CE)(e,["accessToken"]),this.REQUEST_ID))}createReview(e){var t;const s=(0,te.O)();s.append("object_id",e.id),s.append("object_type",e.type),(null===(t=e.photos)||void 0===t?void 0:t.length)&&s.append("photo_ids",e.photos.join(",")),s.append("rating",e.rating.toString()),e.text.length>0&&s.append("text",e.text),s.append("fields",se.create),e.sourceId&&(s.append("source_type","sbol"),s.append("source_id",e.sourceId));const r=`${this.BASE_URL}reviews`;return this.request(r,{method:"post",params:{key:this.KEY,locale:e.locale},headers:{Authorization:`Bearer ${e.accessToken}`},data:s,withCredentials:!1}).then(ce).catch((t=>{var s,r;const a=null===(s=null==t?void 0:t.details)||void 0===s?void 0:s.response;if(403===(null==a?void 0:a.status)&&"FORBIDDEN_YOU_HAVE_BUSINESS_ACCOUNT"===(null===(r=a.data)||void 0===r?void 0:r.error_code))throw{code:403,name:a.data.error_code,message:a.data.message,skipLog:!0};return(0,n.No)("createReview",e,this.REQUEST_ID)(t)}))}postReviewPhotos(e){const{accessToken:t,image:s}=e,r=`${this.BASE_URL}photos`,a=new FormData;return a.append("images[]",s),this.request(r,{method:"post",params:{key:this.KEY,locale:e.locale},headers:{Authorization:`Bearer ${t}`},data:a}).then((({data:e})=>e)).catch((0,n.No)("postReviewPhotos",e,this.REQUEST_ID))}editReview(e){var t;const s=(0,te.O)();s.append("rating",e.rating.toString()),e.text.length>0&&s.append("text",e.text),s.append("fields",se.edit),e.photos&&s.append("photos",e.photos.join(",")),(null===(t=e.new_photos)||void 0===t?void 0:t.length)&&s.append("new_photos",e.new_photos.join(","));const r=`${this.BASE_URL}reviews/${e.id}`;return this.request(r,{method:"patch",params:{key:this.KEY,locale:e.locale},headers:{Authorization:`Bearer ${e.accessToken}`},data:s,withCredentials:!1}).then(ce).catch((0,n.No)("editReview",(0,p.CE)(e,["accessToken"]),this.REQUEST_ID))}validateReview(e){const{text:t}=e,s=`${this.BASE_URL}reviews/validate`,r=new FormData;return r.append("text",t),this.request(s,{method:"post",params:{key:this.KEY,locale:e.locale},headers:{Accept:"application/json"},data:r}).then((({data:e})=>e)).catch((0,n.No)("validateReview",e,this.REQUEST_ID))}likeReview(e){const t=`${this.BASE_URL}reviews/${e.id}/likes`;return this.request(t,{method:"post",params:{key:this.KEY,locale:e.locale},headers:{Authorization:`Bearer ${e.accessToken}`},withCredentials:!1}).then((()=>({code:200}))).catch((0,n.No)("likeReview",(0,p.CE)(e,["accessToken"]),this.REQUEST_ID))}unlikeReview(e){const t=`${this.BASE_URL}reviews/${e.id}/likes`;return this.request(t,{method:"delete",params:{key:this.KEY,locale:e.locale},headers:{Authorization:`Bearer ${e.accessToken}`},withCredentials:!1}).then((()=>({code:200}))).catch((0,n.No)("likeReview",(0,p.CE)(e,["accessToken"]),this.REQUEST_ID))}getReviewComments({id:e,offset:t,limit:s,locale:r}){const a={limit:s,offset_date:t,key:this.KEY,locale:r};return this.request(`${this.BASE_URL}reviews/${e}/comments`,{params:a,withCredentials:!1}).then(ne).catch((0,n.No)("getReviewComments",a,this.REQUEST_ID))}deleteReview({id:e,accessToken:t,locale:s}){const r={id:e,key:this.KEY,locale:s},a=`${this.BASE_URL}reviews/${e}`;return this.request(a,{method:"delete",params:r,headers:{Authorization:`Bearer ${t}`},withCredentials:!1}).then((()=>({code:200}))).catch((0,n.No)("deleteReview",r,this.REQUEST_ID))}deleteComment({id:e,accessToken:t,locale:s}){const r={id:e,key:this.KEY,locale:s},a=`${this.BASE_URL}comments/${e}`;return this.request(a,{method:"delete",params:r,headers:{Authorization:`Bearer ${t}`},withCredentials:!1}).then((()=>({code:200}))).catch((0,n.No)("deleteComment",r,this.REQUEST_ID))}sendReviewComplaint(e){const t=(0,te.O)();t.append("id",e.id),t.append("text",e.text);const s=`${this.BASE_URL}reviews/${e.id}/complaints`;return this.request(s,{method:"post",params:{key:this.KEY,locale:e.locale},headers:{Authorization:`Bearer ${e.accessToken}`},data:t,withCredentials:!1}).then((()=>({code:200}))).catch((e=>{const t=e.details.response;if(t&&400===t.status&&"INVALID_PARAMETER_TEXT"===t.data.error_code)throw{name:"ComplaintError",message:"INVALID_PARAMETER_TEXT",code:400};throw e})).catch((0,n.No)("sendReviewComplaint",(0,p.CE)(e,["accessToken"]),this.REQUEST_ID))}sendReviewCommentAnswer({id:e,text:t,accessToken:s,locale:r}){const a=`${this.BASE_URL}reviews/${e}/comments`,i={id:e,text:t,key:this.KEY,locale:r};return this.request(a,{method:"post",params:i,headers:{Authorization:`Bearer ${s}`},withCredentials:!1}).then((e=>({comment:e.data.comment,code:200}))).catch((e=>{const t=e.details.response;if(t&&400===t.status&&"INVALID_PARAMETER_TEXT"===t.data.error_code)throw{name:"ReviewCommentError",message:"INVALID_PARAMETER_TEXT",code:400};throw e})).catch((0,n.No)("sendReviewCommentAnswer",i,this.REQUEST_ID))}getFacts(e){const{id:t,type:s,isAdvertiser:r}=e,a=`${this.BASE_URL}objects/${s}/${t}/facts`,i={is_advertiser:r,key:this.KEY,locale:e.locale};return this.request(a,{params:i,withCredentials:!1}).then(ae).catch((0,n.No)("getFacts",e,this.REQUEST_ID))}}function ae({data:e}){return{code:e.meta.code,data:e.facts}}function ie({data:e}){return{items:e.reviews?e.reviews:[],total:e.meta.branch_reviews_count||e.meta.org_reviews_count||e.meta.geo_reviews_count||0,rating:e.meta.branch_rating||e.meta.geo_rating||0,orgRating:e.meta.org_rating||0,totalForRequest:e.meta.total_count||0,hasMore:!!e.meta.next_link,code:200===e.meta.code?e.meta.code:(0,u.og)(e.meta.code)}}function ne({data:e}){return{comments:e.comments,total:e.comments.length||0,code:200===e.meta.code?e.meta.code:(0,u.og)(e.meta.code)}}function oe({data:e}){const t=e.reviews?e.reviews:[];return{items:t,total:e.total_count||t.length,totalForRequest:e.total_count||t.length,code:200===e.meta.code?e.meta.code:(0,u.og)(e.meta.code)}}function ce({data:e}){if(!e.review)throw new Error("There is no review in create review response");return{items:[e.review],total:1,code:200}}function de({data:e}){return e.result&&e.result.items?{items:e.result.items,total:e.result.total_count||0,code:200}:{items:[],total:0,code:200}}function ue(e,t){const{discountsApiUrl:s,requestId:r}=t;return{getDiscounts:({id:t})=>e(`${s}filials/${t}/discounts`).then(de).catch((0,n.No)("getDiscounts",{id:t},r))}}class le{constructor(e,t){this.request=e,this.URL=t.shortonizerUrl,this.REQUEST_ID=t.requestId}createShortLink(e){const t={mode:"json",encoded:!0,url:e};return this.request(this.URL,{params:t}).then(pe).catch((0,n.No)("createShortLink",t,this.REQUEST_ID))}}function pe(e){const{data:t,status:s,config:r}=e;return 200===s&&t&&t.shorturl||!r.params?t.shorturl:r.params.url}class he{constructor(e,t){this.request=e,this.FEEDBACK_URL=t.feedbackApiUrl,this.REQUEST_ID=t.requestId}sendFeedback(e){if(e.message.length>=1e4){const e={name:"FeedbackError",message:"Длина поля message не должна превышать 10000 символов",code:400};return Promise.reject(e)}const t=this.createFormData(e);return this.request(this.FEEDBACK_URL,{method:"post",data:t,withCredentials:!1}).then(ge).catch((0,n.No)("sendFeedback",e,this.REQUEST_ID))}createFormData(e){const t=(0,te.O)();if(t.append("special[product]",e.product),t.append("useJson","true"),t.append("special[city]",e.city),t.append("email",e.emailValue||""),t.append("message",e.message||""),t.append("type",e.errorType||""),t.append("sourceUrl",e.sourceUrl),t.append("screenWidth",e.screen.width.toString()),t.append("screenHeight",e.screen.height.toString()),t.append("user_id",e.userId),t.append("session_id",e.sessionId),e.photoId&&(t.append("photoId",e.photoId),t.append("type","photo")),e.objectId&&t.append("objectId",e.objectId),e.objectType&&t.append("objectType",e.objectType),e.accessToken&&t.append("authorizationToken",e.accessToken),e.routeName&&t.append("routeName",e.routeName),e.routeNumber&&t.append("routeNumber",e.routeNumber),e.filialId&&t.append("filialId",e.filialId),e.files&&e.files.forEach((e=>t.append("file[]",e,e.name))),e.place&&t.append("place",e.place),e.placeTitle&&t.append("placeTitle",e.placeTitle),e.mapType&&t.append("rawParams[mapType]",e.mapType),e.category&&t.append("rawParams[category]",e.category),e.hardwareInfo&&t.append("rawParams[hardwareInfo]",e.hardwareInfo),e.raw)for(const s in e.raw){const r=e.raw[s];r&&t.append(`rawParams[${s}]`,r)}return t.append("lang",e.lang),t}}function ge({data:e}){if("ok"!==e.result)throw{name:"FeedbackError",message:e.result,code:400};return{code:200}}function me(e){var t;const{data:s}=e;if("error"in s){const e=new Error(s.error);throw e.name=s.status,e}const{meta:r,result:a}=s;if([400,403,500].includes(r.code)){const e=r.error?`${r.error.message} (${r.code})`:`Unknown MarketAPI error (${r.code})`;if(500===r.code)throw new u.F7(e,r.code);const s=new Error(e);throw s.name=(null===(t=r.error)||void 0===t?void 0:t.type)||s.name,s}return Object.assign(Object.assign({},a),{code:r.code,error:r.error})}function fe(e){const[t,s]=e;return{point1:`${t.lon},${t.lat}`,point2:`${s.lon},${s.lat}`}}function be(e){const t={};return(0,p.Ed)(e,((e,s)=>{e&&(t[s]=e)})),t}const _e=([e,t])=>({id:e,label:e,count:3,children:t?t.map(_e):[]}),ye=_e(["Товары",[["Автотовары",[["Шины",[]]]],["Лекарства",[["Лекарства",[]],["Витамины",[]],["БАД",[]],["Медицинские изделия",[]]]],["Строительные материалы",[["Брус",[]],["Доски",[]],["ДСП",[]],["МДФ",[]],["Фанера",[]],["Шпаклевка",[]],["Штукатурка",[]],["Кирпич",[]],["Гипсокартон",[]],["Межкомнатные двери",[]],["Входные двери",[]]]],["Отделочные материалы",[["Ламинат",[]],["Линолеум",[]],["Обои",[]],["Керамическая плитка",[]],["Керамогранит",[]],["Краски",[]],["Эмали",[]]]],["Сантехника",[["Ванны",[]],["Унитазы",[]],["Смесители",[]],["Душевые кабины",[]],["Раковины",[]]]],["Электроинструмент",[["Дрели",[]],["Перфораторы",[]],["УШМ (Болгарки)",[]],["Шуруповёрты",[]]]],["Крепёжные изделия",[["Гвозди",[]],["Саморезы",[]],["Болты",[]],["Дюбели",[]]]]]]),Ee=["69","4","46","25","33","78","31","9","65","41","11","21","40","5","58","23","7","10","73","86","32","29","12","19","45","6","74","1","76","2","48","16","24","44","18","38","43","54","39","81","47","97","22","3","36","13","83","17","35","53","15","50","28"],Oe={feature_config:"categories_without_fake_first_level,range_price_type_supported,from_price_type_supported"};class ve{constructor(e,t){this.request=e;const s=t.marketApiUrl;this.GET_SUGGESTIONS_URL=`${s}product/suggest`,this.SEARCH_PRODUCTS_URL=`${s}product/items`,this.SEARCH_PRODUCTS_BY_BRANCH_URL=`${s}product/items_by_branch`,this.GET_OFFERS_URL=`${s}offer/items`,this.GET_OFFERS_GROUPED_BY_ORG_URL=`${s}offer/items_by_org`,this.GET_PRODUCT_OFFER_WITH_ITEMS=`${s}offer/items_with_products`,this.GET_REALTY_URL=`${s}realty/items`,this.GET_REALTY_MARKERS=`${s}realty/markers`,this.GET_EXCHANGE_ITEMS=`${s}currency_exchange/items`,this.GET_EXCHANGE_MARKERS=`${s}currency_exchange/markers`,this.GET_EXCHANGE_ITEMS_BY_BRANCH=`${s}currency_exchange/items_by_branch`,this.SBER_MM_CC_CHECKOUT=`${s}partner/smm/cc/checkout`,this.GET_PRICE_LIST_IMAGES=`${s}price_list_images/items_by_branch`,this.GET_GEO_BY_ID_URL=`${t.marketGeoApiUrl}product/items_by_geo`,this.REQUEST_ID=t.requestId,this.CLIENT_ID=t.clientId}getProjectCategories({projectId:e}){return Ee.includes(e)?Promise.resolve({code:200,categories:ye}):Promise.reject({code:404})}getSuggestions(e){const{query:t,branchId:s,viewpoint:r,locale:a}=e;return this.request(this.GET_SUGGESTIONS_URL,{params:Object.assign(Object.assign(Object.assign(Object.assign({},Oe),{q:t,branch_id:s}),fe(r)),{locale:a,types:"category,org_product,raw_product"})}).then(me).catch((0,n.No)("getSuggestions",e,this.REQUEST_ID))}searchProductsById(e){return this.searchProducts(e)}getBranchCategoriesAndProducts(e){return this.getProductsByBranch(e)}searchBranchProducts(e){return this.getProductsByBranch(Object.assign(Object.assign({},e),{page:e.page||1}))}getOffers(e){const{productId:t,buildingId:s,viewpoint:r,locale:a,page:i=1,filters:o={}}=e;return this.request(this.GET_OFFERS_URL,{params:Object.assign(Object.assign(Object.assign(Object.assign({product_id:t,building_id:s},fe(r)),{locale:a,page:i,page_size:H.Kt}),be(o)),Oe)}).then(me).catch((0,n.No)("getOffers",e,this.REQUEST_ID))}getOffersGroupedByOrg(e){const{productId:t,buildingId:s,viewpoint:r,locale:a,page:i=1,filters:o={}}=e;return this.request(this.GET_OFFERS_GROUPED_BY_ORG_URL,{params:Object.assign(Object.assign(Object.assign(Object.assign({product_id:t,building_id:s},fe(r)),{locale:a,page:i,page_size:H.Kt}),be(o)),Oe)}).then(me).catch((0,n.No)("getOffersGroupedByOrg",e,this.REQUEST_ID))}getRealtyItem(e){const{id:t,locale:s}=e,r={platform_code:this.CLIENT_ID,locale:s,id:t};return this.request(`${this.GET_REALTY_URL}/${t}`,{params:r}).then(me).catch((0,n.No)("getRealtyItem",r,this.REQUEST_ID))}getRealtyMarkers(e){const{category_ids:t,viewpoint:s,locale:r,geo_id:a,filters:i}=e,o=Object.assign(Object.assign(Object.assign({platform_code:this.CLIENT_ID,category_ids:t},fe(s)),{locale:r,geo_id:a}),be(i||{}));return this.request(this.GET_REALTY_MARKERS,{params:o}).then(me).catch((0,n.No)("getRealtyMarkers",o,this.REQUEST_ID))}getRealtyItems(e){const{category_ids:t,viewpoint:s,page:r=1,locale:a,filters:i,pageSize:o,geometry:c,geo_id:d,sort:u,platformCode:l}=e,p=Object.assign(Object.assign(Object.assign({platform_code:l||this.CLIENT_ID,category_ids:t},fe(s)),{page:r,locale:a,page_size:o||H.N6,geometry:c,geo_id:d,sort:u}),be(i||{}));return this.request(this.GET_REALTY_URL,{params:p}).then(me).catch((0,n.No)("getRealtyItems",p,this.REQUEST_ID))}getRealtyForEntityTab(e){const{geoId:t,locale:s,page:r}=e,a=Object.assign({geo_id:t,locale:s,page:r,page_size:H.N6},this.CLIENT_ID?{product_id:this.CLIENT_ID}:void 0);return this.request(this.GET_GEO_BY_ID_URL,{params:a}).then(me).catch((0,n.No)("getRealtyForEntityTab",e,this.REQUEST_ID))}getProductOfferWithItems(e){const{branchId:t,productIds:s,locale:r}=e,a={branch_id:t,product_ids:s.slice(0,50).join(","),locale:r};return this.request(this.GET_PRODUCT_OFFER_WITH_ITEMS,{params:a}).then(me).catch((0,n.No)("getProductOfferWithItems",e,this.REQUEST_ID))}getExchangeItems(e){const t=Object.assign({locale:e.locale,currency:e.currency,volume:e.volume,action:e.action,page:e.page,page_size:e.page_size},fe(e.viewpoint));return this.request(this.GET_EXCHANGE_ITEMS,{params:t}).then(me).catch((0,n.No)("getExchangeItems",e,this.REQUEST_ID))}getExchangeMarkers(e){const t=Object.assign({locale:e.locale,currency:e.currency,volume:e.volume,action:e.action},fe(e.viewpoint));return this.request(this.GET_EXCHANGE_MARKERS,{params:t}).then(me).catch((0,n.No)("getExchangeMarkers",e,this.REQUEST_ID))}getExchangeByBranch(e){const t={locale:e.locale,branch_id:e.branch_id};return this.request(this.GET_EXCHANGE_ITEMS_BY_BRANCH,{params:t}).then(me).catch((0,n.No)("getExchangeByBranch",e,this.REQUEST_ID))}sberMMCheckout(e){const t=e.payload;return this.request(this.SBER_MM_CC_CHECKOUT,{data:t,method:"post",params:{locale:e.locale}}).then((e=>e.data)).catch((e=>{var t,s;const r=null===(s=null===(t=null==e?void 0:e.details)||void 0===t?void 0:t.response)||void 0===s?void 0:s.data;if(r)return r;throw e})).catch((0,n.No)("sberMMCheckout",e,this.REQUEST_ID))}getPriceListImages(e){return this.request(this.GET_PRICE_LIST_IMAGES,{params:{locale:e.locale,branch_id:e.branchId}}).then(me).then((e=>e[0])).catch((0,n.No)("getPriceListImages",e,this.REQUEST_ID))}searchProducts(e){const{query:t,productId:s,buildingId:r,viewpoint:a,locale:i,page:o=1,filters:c={},category_ids:d,page_size:u}=e;return this.request(this.SEARCH_PRODUCTS_URL,{params:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({q:t,product_id:s,building_id:r},fe(a)),{locale:i,page:o,page_size:u||H.LF}),d?{category_ids:d}:{}),be(c)),Oe)}).then(me).catch((0,n.No)("searchProducts",e,this.REQUEST_ID))}getProductsByBranch(e){const{query:t,branchId:s,locale:r,page:a,filters:i={}}=e,o=Object.assign(Object.assign({q:t,branch_id:s,locale:r,page:a,page_size:H.Kt},be(i)),Oe);return this.request(this.SEARCH_PRODUCTS_BY_BRANCH_URL,{params:o}).then(me).catch((0,n.No)("searchProducts",e,this.REQUEST_ID))}}function je(e){return Object.keys(e).reduce(((t,s)=>e[s]?[...t,`${s}=${e[s]}`]:t),[]).join("&")}const Re=(e,t)=>({getUserInfo:({accessToken:s,refreshToken:r})=>e(`${t.authUrl}users/me`,{method:"get",params:{access_token:s}}).then((e=>({data:e.data,access_token:s,refresh_token:r}))).catch((0,n.No)("getUserInfo",{},t.requestId)),deleteProfile(s){const{accessToken:r,locale:a="ru_RU"}=s;return e(`${t.authUrl}users/me`,{method:"delete",params:{access_token:r,locale:a}}).then((()=>Promise.resolve())).catch((0,n.No)("deleteProfile",{},t.requestId))},confirmRegistration:s=>e(`${t.authUrl}users/me/confirmation`,{method:"post",data:je({grant_type:"email"}),params:{access_token:s.accessToken}}).then((()=>Promise.resolve())).catch((0,n.No)("confirmRegistration",{},t.requestId)),fetchOauthToken:s=>e(`${t.authUrl}oauth/token`,{method:"post",data:je(s)}).then((e=>e.data)).catch((0,n.No)("fetchOauthToken",{grant_type:s.grant_type},t.requestId)),revokeToken:s=>e(`${t.authUrl}oauth/revoke`,{method:"post",data:je({access_token:s.access_token,refresh_token:s.refresh_token})}).catch((0,n.No)("revokeToken",{},t.requestId)),getPhoneConfirmationCode:s=>e(`${t.authUrl}confirmation/sms-code`,{method:"post",params:{locale:s.locale||"ru_RU",client_id:s.authClientId,access_token:s.accessToken},data:je({action:s.action,phone:encodeURIComponent(s.phone),segment_id:s.segmentId})}).then((e=>e.data)).catch((e=>(0,u.A1)("confirmationCode",t.requestId,e))),confirmPhone:s=>e(`${t.authUrl}users/me/phone`,{method:"put",params:{locale:s.locale||"ru_RU",client_id:s.authClientId,access_token:s.accessToken},data:je({phone:encodeURIComponent(s.phone),confirmation_code:s.confirmationCode})}).then((e=>e.data)).catch((e=>(0,u.A1)("confirmPhone",t.requestId,e))),updateUserInfo:s=>e(`${t.authUrl}users/me`,{method:"patch",params:{locale:s.locale||"ru_RU",client_id:s.authClientId,access_token:s.accessToken},data:je(s.userInfo)}).then((e=>e.data)).catch((0,n.No)("updateUserInfo",{userInfo:s.userInfo},t.requestId)),updateEmail:s=>e(`${t.authUrl}users/me/email`,{method:"put",params:{locale:s.locale||"ru_RU",client_id:s.authClientId,access_token:s.accessToken},data:je({new_email:s.email})}).then((e=>e.data)).catch((0,n.No)("updateEmail",s,t.requestId)),confirmEmail:s=>e(`${t.authUrl}users/me/confirmation`,{method:"post",params:{locale:s.locale||"ru_RU",access_token:s.accessToken},data:je({grant_type:"email"})}).then((e=>e.data)).catch((0,n.No)("updateEmail",s,t.requestId))});class Ie{constructor(e,t){this.request=e,this.videoServiceVersion=t.videoServiceVersion,this.REQUEST_ID=t.requestId}getVideoData(e){return this.request(`${e}/${this.videoServiceVersion}`,{withCredentials:!1}).then((e=>{if(null!==e.data&&"object"==typeof e.data)return e.data;throw new Error("response is not json data")})).catch((0,n.No)("getVideoData",{url:e},this.REQUEST_ID))}}function Se(e){return`{ ${Object.keys(e).reduce(((t,s)=>{const r=e[s];switch(typeof r){case"object":{const e=r;return r?Array.isArray(e)?`${t} ${s}: [ ${e.map(Se).join(", ")} ]`:`${t} ${s}: ${Se(e)}`:t}case"string":return`${t} ${s}: "${r.replace(/"/g,"'")}"`;case"number":return`${t} ${s}: ${r}`;case"boolean":return`${t} ${s}: ${r}`;default:return t}}),"").trim()} }`}class Te{constructor(e,t){this.request=e,this.domain=t.aggregatorUrl+"/normalized",this.config=t}updateProfile(e){const{first_name:t,middle_name:s,last_name:r,accessToken:a,locale:i,requestId:o,avatarUrl:c,public_identity_accepted:d}=e,u=function(e){return`updateUser {\n    updateMeInfo(partialUser: ${Se({first_name:e.first_name,middle_name:e.middle_name,last_name:e.last_name,avatar_url:e.avatarUrl,public_identity_accepted:e.public_identity_accepted})}) {\n      id\n      display_name\n      ${e.first_name?"first_name":""}\n      ${e.middle_name?"middle_name":""}\n      ${e.last_name?"last_name":""}\n      ${e.avatarUrl?"avatar_url":""}\n      ${void 0!==e.public_identity_accepted?"public_identity_accepted":""}\n    }\n  }`}({first_name:t,middle_name:s,last_name:r,public_identity_accepted:d,avatarUrl:c}),l={accessToken:a,locale:i},p=`mutation ${u}`;return this.submitGraphQLRequest({params:l,query:p,requestId:o}).then((t=>t.data.data.updateMeInfo.entities.users[e.userId])).catch((0,n.No)("updateProfile",e,o))}updateEmail(e){return this.request(`${this.config.authUrl}users/me/email`,{method:"put",params:{locale:e.locale,client_id:e.clientId,access_token:e.accessToken},data:je({new_email:e.email})}).then((t=>{if(t.data.code&&200!==t.data.code&&204!==t.data.code)throw t.data;return{id:e.userId,new_email:e.email}})).catch((0,n.No)("updateEmail",e,this.config.requestId))}deleteProfile(e){const{accessToken:t,locale:s,requestId:r}=e,a={accessToken:t,locale:s};return this.submitGraphQLRequest({params:a,query:"mutation {\n    deleteMe\n  }",requestId:r}).then((e=>({isDeleted:e.data.data.deleteMe}))).catch((0,n.No)("deleteProfile",e,r))}submitGraphQLRequest({params:e,query:t}){const s={session_token:e.accessToken,locale:e.locale};return this.request(this.domain,{method:"post",data:t,params:s,headers:{"content-type":"application/graphql","Auth-Version":"2.0",Accept:"*/*"}})}}var Ae=s(17921),Ce=s(46238),we=s(24854),ke=s(62365),Ue=s(32909);class Ne{constructor(e,t){this.request=e,this.REQUEST_ID=t.requestId,this.FEEDBACK_URL=`${t.dataFeedbackApiUrl}feedback`,this.FEEDBACKS_PER_PAGE=t.feedbacksPerPage}sendFeedback(e){const{feedback:t,userToken:s}=e,r={data:this.createData(t),method:"post",withCredentials:!0,headers:Object.assign({},s&&{Authorization:`Bearer ${s}`}),timeout:0};return this.request(this.FEEDBACK_URL,r).then(this.formatApiResponse).catch((0,n.No)("typedFeedback",{url:this.FEEDBACK_URL,data:r},this.REQUEST_ID))}getUserFeedbacks(e){const t={Authorization:`Bearer ${e.accessToken}`};return this.request(this.FEEDBACK_URL,{method:"get",headers:t,params:{locale:e.locale,offset:e.offset,limit:this.FEEDBACKS_PER_PAGE}}).then((e=>({items:e.data.items}))).catch((0,n.No)("getUserFeedbacks",{url:this.FEEDBACK_URL,data:{offset:e.offset,locale:e.locale}},this.REQUEST_ID))}getUserFeedbacksCount(e){const t={Authorization:`Bearer ${e.accessToken}`};return this.request(`${this.FEEDBACK_URL}/count`,{method:"get",headers:t}).then((e=>({total:e.data.total}))).catch((0,n.No)("getUserFeedbacksCount",{url:this.FEEDBACK_URL},this.REQUEST_ID))}createData(e){const t=(0,te.O)(),{user:s,attachments:a}=e,i=(0,r._T)(e,["user","attachments"]);return a&&a.forEach((e=>{t.append("attachments[]",e,e.name)})),t.append("feedback",JSON.stringify(Object.assign(Object.assign({},i),{user:s}))),t}formatApiResponse({data:e}){if(!e.feedback_id)throw{name:"DataFeedbackError",message:e.message,code:400};return{code:200,message:e.message,feedbackId:e.feedback_id}}}const Pe=15e3;function Le(e,t){const{favoritesApiUrl:s,requestId:r}=t,a=()=>({timestamp:String(Date.now())});return{syncPublicFavorites({filter:t}){const i=Object.assign(Object.assign({},a()),{payload:{favorites:{filter:t}}});return e(`${s}public/sync`,{method:"post",data:i,headers:{"Content-Type":"application/json"},timeout:Pe}).then((e=>e.data.favorites)).catch((0,n.No)("syncPublicFavorites",i,r))},syncPersonalFavorites({last_sync:t,objects:i,access_token:o}){const c=`${s}personal/collections/sync`,d=Object.assign(Object.assign({},a()),{access_token:o,payload:{personal_favorites:{last_sync:t,objects:i}}});return e(c,{method:"post",data:d,headers:{"Content-Type":"application/json"},timeout:Pe}).then((e=>e.data.personal_favorites)).catch((0,n.No)("syncPersonalFavorites",d,r))},syncPlaces({last_sync:t,objects:i,access_token:o}){const c=`${s}personal/places/sync`,d=Object.assign(Object.assign({},a()),{access_token:o,payload:{places:{last_sync:t,objects:i}}});return e(c,{method:"post",data:d,headers:{"Content-Type":"application/json"},timeout:Pe}).then((e=>e.data.places)).catch((0,n.No)("syncPlaces",d,r))}}}let He={sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{},changes:{}};const Fe={sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{},changes:{}};function De(){let e=Fe,t=Fe;return{getPublic:()=>Promise.resolve(He),setPublic:e=>(He=e,Promise.resolve()),getPersonal:()=>Promise.resolve(e),setPersonal:t=>(e=t,Promise.resolve()),getPlaces:()=>Promise.resolve(t),setPlaces:e=>(t=e,Promise.resolve()),clearPersonal:()=>(e=Fe,Promise.resolve()),clearPlaces:()=>(t=Fe,Promise.resolve())}}function Be({data:e}){return{items:"object"==typeof e?e:[],total:"object"==typeof e?e.length:0,code:200}}function $e({data:e}){return{items:"object"==typeof e&&e.transport||[],total:"object"==typeof e&&e.transport&&e.transport.length||0,code:200}}function qe({data:e}){return{items:"object"==typeof e?e.result:[],total:"object"==typeof e?e.result.length:0,code:200}}var Ge=s(25278),xe=s(91875);function Me(e){return Ge.uR.includes(e)}function Ye(e,t){const[s,r]=e;return{topLeft:{x:s.lon,y:s.lat},bottomRight:{x:r.lon,y:r.lat},zoom:t}}function ze(e){return e.map(((t,s)=>({type:0===s||s===e.length-1?"pedo":"pref",x:t.lonLat.lon,y:t.lonLat.lat,object_id:t.entityId})))}function Ke(e){switch(e.split("_")[0]){case"ar":return"ar";case"en":return"en";case"uk":return"uk";case"es":return"es";case"it":return"it";case"cs":return"cs";case"uz":return"uz";case"kk":return"kk";default:return"ru"}}function Qe(e){const t=function(e={}){const t=e[Ge.pA];return t?(0,xe.X)(t).filter(Me):[]}(e);return t.length?t:Ge.uR}const Ve=["dangerous_cargo","explosive_cargo"],We=["max_perm_mass","mass","axle_load","height","width","length"],Je=e=>Ve.includes(e),Ze=e=>We.includes(e);function Xe(e,t){const{ppnotApiUrl:s,ppnotTypesApiUrl:r,ppnaApiUrl:a,pedestrianApiUrl:i,ppngApiUrl:o,requestId:c,webApiKey:d}=t;return{ppnot({projectCode:t,locale:r,points:a,viewpoint:i,zoom:o,filterValues:c}){const u=`${s}/${t}`,l=a[0],p=a[a.length-1],h={locale:Ke(r),enable_schedule:!1,source:{point:l.lonLat,object_id:l.entityId,name:"Source"},target:{point:p.lonLat,object_id:p.entityId,name:"Target"},transport:Qe(c),purpose:"routeSearch",viewport:Ye(i,o)};return e(u,{method:"post",params:{key:d},data:h}).then(Be).catch((0,n.No)("directionsApi.ppnot",{projectCode:t,data:h},u))},ppnotTypes:({projectCode:t})=>e(`${r}/filters/${t}`,{method:"post",params:{key:d},data:{}}).then($e).catch((0,n.No)("directionsApi.ppnotTypes",{projectCode:t},c)),ppna({locale:t,points:s,viewpoint:r,zoom:i}){const o=`${a}/global`,u={locale:Ke(t),point_a_name:"Source",point_b_name:"Target",points:ze(s),purpose:"autoSearch",type:"online5",viewport:Ye(r,i)};return e(o,{method:"post",params:{key:d},data:u}).then(qe).catch((0,n.No)("directionsApi.ppna",{data:u},c))},pedestrian({projectCode:t,locale:s,points:r,viewpoint:a,zoom:o}){const u=`${i}/${t}`,l={locale:Ke(s),point_a_name:"Source",point_b_name:"Target",points:ze(r),type:"pedestrian",purpose:"autoSearch",viewport:Ye(a,o)};return e(u,{method:"post",params:{key:d},data:l}).then(qe).catch((0,n.No)("directionsApi.pedestrian",{projectCode:t,data:l},c))},ppng({locale:t,points:s,viewpoint:r,zoom:a,filterValues:i}){const u=`${o}/global`,l=function(e){if(!e)return;const t={};return(0,p.Ed)(e,((e,s)=>{if((0,p.$K)(e))if(Je(s))t[s]="true"===e;else if(Ze(s)){const r=parseFloat(e);Number.isNaN(r)||(t[s]=r)}})),Object.keys(t).length>0?t:void 0}(i),h=Object.assign({locale:Ke(t),point_a_name:"Source",point_b_name:"Target",points:ze(s),purpose:"autoSearch",type:"truck_jam",alternative:0,viewport:Ye(r,a)},l&&{truck_params:l});return e(u,{method:"post",params:{key:d},data:h}).then(qe).catch((0,n.No)("directionsApi.ppng",{data:h},c))}}}function et(e,t){return{trafficScore(s){const r=(0,p.dL)(t.trafficApiUrl,{s:Math.floor(10*Math.random()).toString(10),regionCode:s.regionCode});return e(r,{headers:{Accept:"text/plain"}}).then((e=>{const t=e.data.match(/^'(\d{1,2}),?([+-])?'$/);return t&&void 0!==t[1]?+t[1]:0}))}}}function tt(e,t){return{getUserAchievements(s){const{locale:r,accessToken:a}=s,i=`${t.achievesApiUrl}achieves`;return e(i,{params:{locale:r,fields:"meta.contest_progress_weeks"},headers:{Accept:"application/json",Authorization:`Bearer ${a}`}}).then((({data:e})=>e))}}}function st(e,t){return{getUserContestStatus(s){const{locale:r,contestId:a,accessToken:i}=s,o=`${t.contestApiUrl}contests/${a}`;return e(o,{params:{locale:r,accessToken:i},headers:{Accept:"application/json",Authorization:`Bearer ${i}`}}).then((({data:e})=>e)).catch((0,n.No)("getUserContestStatus",s,t.requestId))},joinUser(s){const{locale:r,contestId:a,accessToken:i}=s,o=`${t.contestApiUrl}contests/${a}/join`;return e(o,{method:"post",params:{locale:r,access_token:i},headers:{Accept:"application/json",Authorization:`Bearer ${i}`}}).then((({data:e})=>e)).catch((0,n.No)("joinUser",s,t.requestId))}}}function rt({data:e}){return e?{items:e,code:200}:{items:[],code:200}}function at(e){return 202===e.status?{code:200}:{code:500}}function it(e,t){const{pusherApiUrl:s,requestId:r}=t;return{fetchDevices:({authToken:t})=>e(`${s}devices`,{method:"get",headers:{"auth-token":t}}).then(rt).catch((0,n.No)("fetchDevices",{authToken:t},r)),messageMe(t){const a=`${s}messages/me`,{authToken:i,deviceId:o,title:c,body:d,url:u}=t;return e(a,{method:"post",headers:{"auth-token":i},data:{app_instance_ids:[o],data:{title:c,body:d,url:u}}}).then(at).catch((0,n.No)("messageMe",t,r))}}}function nt(e){return e&&e.data&&e.data.length?{items:e.data,total:e.data.length,code:200}:{items:[],total:0,code:200}}const ot='["camera","crash","roadwork","restriction","comment","other"]';function ct(e,t){const{tugcApiUrl:s,requestId:r}=t;return{getUserLayers({regionCode:t}){const a={project:t,layers:ot};return e(`${s}layers/user`,{params:a}).then(nt).catch((0,n.No)("getLayers",a,r))},get2GisLayers({regionCode:t}){const a={project:t,layers:ot};return e(`${s}layers/2gis`,{params:a}).then(nt).catch((0,n.No)("getLayers",a,r))},getPhotos({eventId:t}){const a={id:t};return e(`${s}event/photo`,{params:a}).then(nt).catch((0,n.No)("getLayers",a,r))}}}var dt=s(67129);function ut(e,t){const{paymentsApiUrl:s,requestId:r,userId:a}=t,i="online";return{checkoutOrder(o){const{idempotencyKey:c,entityId:d,orgId:u,user:l,cart:p,comment:h,accessToken:g,locale:m}=o;return e(`${s}payments/api/1.0/checkout`,{method:"post",data:{orgId:u,branchId:d,user:l,cart:p,comment:h},headers:lt({accessToken:g,platform:i,commitIsoDate:t.commitIsoDate,bssUserId:a,idempotencyKey:c,locale:m}),withCredentials:!1}).then((e=>({code:200,total:1,items:[e.data]}))).catch((0,n.No)("checkoutOrder",o,r))},checkoutDelivery(o){const{idempotencyKey:c,entityId:d,orgId:u,user:l,cart:p,delivery:h,payment:g,comment:m,accessToken:f,locale:b}=o;return e(`${s}payments/api/2.0/checkout`,{method:"post",data:{orgId:u,branchId:d,user:l,cart:p,delivery:h,payment:g,comment:m},headers:lt({accessToken:f,platform:i,commitIsoDate:t.commitIsoDate,bssUserId:a,idempotencyKey:c,locale:b}),withCredentials:!0}).then((e=>e.data)).catch((0,n.No)("checkoutDelivery",o,r))},getOrders(r){const{accessToken:o,locale:c}=r;return e(`${s}payments/api/2.0/orders`,{params:{limit:999},headers:lt({accessToken:o,platform:i,commitIsoDate:t.commitIsoDate,bssUserId:a,idempotencyKey:void 0,locale:c})}).then((e=>e.data)).catch((0,n.No)("getOrders",r,t.requestId))},cancelOrder(r){const{accessToken:o,locale:c,orderId:d}=r;return e(`${s}payments/api/2.0/orders/${d}/cancel`,{method:"post",headers:lt({accessToken:o,platform:i,commitIsoDate:t.commitIsoDate,bssUserId:a,idempotencyKey:void 0,locale:c})}).then((e=>e.data)).catch((0,n.No)("cancelOrder",r,t.requestId))},getDeliveryCalculation(r){const{orgId:o,branchId:c,cart:d,delivery:u,locale:l}=r;return e(`${s}payments/api/2.0/calculate`,{method:"post",headers:lt({accessToken:void 0,platform:i,commitIsoDate:t.commitIsoDate,bssUserId:a,idempotencyKey:void 0,locale:l}),data:{orgId:o,branchId:c,cart:d,delivery:u}}).then((e=>e.data)).catch((e=>{var t,s,r;if("delivery_not_available_at_point"===(null===(r=null===(s=null===(t=null==e?void 0:e.details)||void 0===t?void 0:t.response)||void 0===s?void 0:s.data)||void 0===r?void 0:r.code))throw{name:"DeliveryNotAvailableError",message:e.details.response.data.message};throw e})).catch((0,n.No)("getDeliveryCalculation",r,t.requestId))},getOrdersShort(r){const{accessToken:a,locale:o,type:c}=r;return e(`${s}payments/api/2.0/orders/short`,{params:{type:c},headers:lt({accessToken:a,platform:i,commitIsoDate:t.commitIsoDate,bssUserId:t.userId,idempotencyKey:void 0,locale:o})}).then((e=>e.data)).catch((0,n.No)("getOrdersShort",r,t.requestId))}}}function lt(e){const{idempotencyKey:t,accessToken:s,platform:r,commitIsoDate:a,bssUserId:i,locale:n}=e;return Object.assign(Object.assign(Object.assign({},t?{"X-Idempotency-Key":t}:void 0),s?{Authorization:`Bearer ${s}`}:void 0),{"X-Device-Platform":(0,dt.$)()?"pwa":r,"X-App-Version":(0,z.n)(a),"X-Bss-User-Id":i,"X-Locale":n||""})}function pt(e,t){return{getData(s){const[r,a]=s.viewport;return e(`${t.etaApiUrl}/points/viewport`,{method:"post",data:{viewport:{topLeft:{x:r.lon,y:r.lat},bottomRight:{x:a.lon,y:a.lat},zoom:s.zoom},type:"online5"}})},getCurrentDirectionsData(s){const{directions:r}=s;return e(`${t.etaApiUrl}/points/directions`,{method:"post",data:{directions:r,type:"online5"}})},getHasBusInViewport(s){const[r,a]=s.viewport;return e(`${t.etaApiUrl}/points/has_bus_in_viewport`,{method:"post",data:{viewport:{topLeft:{x:r.lon,y:r.lat},bottomRight:{x:a.lon,y:a.lat},zoom:s.zoom},type:"online5"}})}}}function ht(e,t){return{getUserFriendsActivityByObjects(s){const{accessToken:r,objectsIds:a,maxFriendsPerObject:i}=s,o=`${t.userActivityApiUrl}activities/by-friends`;return e(o,{params:{max_friends_per_object:i||5,objects_ids:a.join(","),fields:"activities.friends.user,activities.friends.types,activities.friends.items,activities.total_friends"},headers:{Accept:"application/json",Authorization:`Bearer ${r}`}}).then((({data:e})=>e)).catch((0,n.No)("getUserFriendsActivityByObjects",s,t.requestId))},getUserActivity(s){const{accessToken:r}=s,a=`${t.userActivityApiUrl}activities/counters`;return e(a,{headers:{Accept:"application/json",Authorization:`Bearer ${r}`}}).then((({data:e})=>e)).catch((0,n.No)("getUserActivity",s,t.requestId))}}}function gt(e,t){return{getTaxaProviders(s){const{regionId:r}=s,a=`${t.taxaApiUrl}providers`;return e(a,{params:{region_id:r,screen:"card"},headers:{Accept:"application/json"}}).then((({data:e})=>e)).catch((0,n.No)("getTaxaProviders",s,t.requestId))},searchTaxi(s){const{point1:r,point2:a,regionId:i}=s,o=`${t.taxaApiUrl}route/calculate`;return e(o,{method:"post",headers:{Accept:"application/json"},data:{point1:r,point2:a,region_id:i,screen:"card"}}).then((({data:e})=>e)).catch((0,n.No)("searchTaxi",s,t.requestId))}}}const mt=e=>{var t,s;const r=e.details.response;if(null===(s=null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.error)||void 0===s?void 0:s.code)return r;throw e};function ft(e,t){return{postBroadcast(s){const{accessToken:r,branchIds:a,text:i}=s,o=`${t.messengerApiUrl}broadcasts`;return e(o,{method:"post",data:{branch_ids:a,text:i,platform:t.messengerPlatform},headers:{"auth-token":r,"auth-version":"2.0"}}).catch(mt).then((({data:e})=>e)).catch((0,n.No)("postBroadcast",s,t.requestId))}}}function bt(e,t){return{getWalkDistanceData(s){const{regionId:r}=s;return e(`https://disk.2gis.com/transport-reach/${r}.json`).then((({data:e})=>e)).catch((0,n.No)("getWalkDistanceData",s,t.requestId))},getRoadAccidentData(s){const{localityId:r}=s;return e(`https://disk.2gis.com/layers/dtp-stat/${r}.json`).then((({data:e})=>e)).catch((0,n.No)("getRoadAccidentData",s,t.requestId))}}}function _t(e,t){return{getData:s=>e(`${t.isochronesApiUrl}?key=${t.webApiKey}`,{method:"post",data:Object.assign({simplify:!0,reverse:!1},s)}).then((e=>e.data)).catch((0,n.No)("getData",s,t.requestId))}}function yt(e,t){return{getCongestion(s){const{id:r}=s,a=`${t.congestionApiUrl}congestion`;return e(a,{params:{branch_id:r}}).then((({data:e})=>e)).catch((0,n.No)("getCongestion",s,t.requestId))}}}function Et(e,t){return{getUserChronologyPlaces(s){const{accessToken:r}=s,a=`${t.chronologyPlacesApiUrl}myplaces/authuser`,i={token:r,limit:H.BZ};return e(a,{params:i,headers:{Authorization:`Bearer ${r}`}}).then((({data:e})=>Object.assign(Object.assign({},e),{limit:i.limit}))).catch((0,n.No)("getUserChronologyPlaces",s,t.requestId))},getUserChronologyPlacesByObjects(s){const{accessToken:r,ids:a}=s,i=`${t.chronologyPlacesApiUrl}myplaces/authuser/objects`,o={token:r,ids:a.join(","),limit:H.BZ};return e(i,{params:o,headers:{Authorization:`Bearer ${r}`}}).then((({data:e})=>Object.assign(Object.assign({},e),{limit:o.limit}))).catch((0,n.No)("getUserChronologyPlacesByObjects",s,t.requestId))},approveChronologyPlace(s){const{accessToken:r,objectId:a}=s,i=`${t.checkinApiUrl}checkins`,o={object_id:a,source:"chronology",product_id:"34"};return e(i,{method:"post",data:`object_id=${a}&source=chronology&product_id=34`,headers:{Authorization:`Bearer ${r}`}}).then((({data:e})=>e)).catch((0,n.No)("approveChronologyPlace",o,t.requestId))},declineChronologyPlace(s){const{objectId:r,accessToken:a}=s,i=`${t.chronologyPlacesApiUrl}myplaces/authuser/${r}/decline`,o={token:a};return e(i,{method:"post",params:o,headers:{Authorization:`Bearer ${a}`}}).then((({data:e})=>e)).catch((0,n.No)("addChronologyPlace",o,t.requestId))}}}function Ot(e,t){return{getCounters(s){const r=`${t.socialGraphApiUrl}social-graph/friends/counters`;return e(r,{headers:{Authorization:`Bearer ${s.accessToken}`}}).then((({data:e})=>e)).catch((0,n.No)("getCounters",s,t.requestId))},getFriends(s){const{accessToken:r,limit:a=20,next_page_token:i,source:o,without_friends:c,offset:d}=s,u=`${t.socialGraphApiUrl}social-graph/friends`,l={limit:a,next_page_token:i,source:o,without_friends:c,offset:d};return e(u,{params:l,headers:{Authorization:`Bearer ${r}`}}).then((({data:e})=>e)).catch((0,n.No)("getFriends",l,t.requestId))},getRecommendedFriends(s){const{accessToken:r,limit:a=20,next_page_token:i}=s,o=`${t.socialGraphApiUrl}social-graph/friends/all`,c={limit:a,next_page_token:i};return e(o,{params:c,headers:{Authorization:`Bearer ${r}`}}).then((({data:e})=>e)).catch((0,n.No)("getRecommendedFriends",c,t.requestId))},getSubscribers(s){const{accessToken:r,limit:a=20,next_page_token:i}=s,o=`${t.socialGraphApiUrl}social-graph/friends/subscribers`,c={limit:a,next_page_token:i};return e(o,{params:c,headers:{Authorization:`Bearer ${r}`}}).then((({data:e})=>e)).catch((0,n.No)("getSubscribers",c,t.requestId))},getSubscriptions(s){const{accessToken:r,limit:a=20,next_page_token:i}=s,o=`${t.socialGraphApiUrl}social-graph/friends/subscriptions`,c={limit:a,next_page_token:i};return e(o,{params:c,headers:{Authorization:`Bearer ${r}`}}).then((({data:e})=>e)).catch((0,n.No)("getSubscriptions",c,t.requestId))},subscribe(s){const{accessToken:r,user_ids:a}=s,i=`${t.socialGraphApiUrl}social-graph/friends`;return e(i,{method:"post",headers:{Authorization:`Bearer ${r}`},data:{user_ids:a}}).catch((0,n.No)("subscribeToFriends",{user_ids:a},t.requestId))},subscribeToAll(s){const{accessToken:r,excludedUserIds:a,source:i}=s,o=`${t.socialGraphApiUrl}social-graph/friends/all`;return e(o,{method:"post",params:{source:i},headers:{Authorization:`Bearer ${r}`},data:{user_ids:a}}).catch((0,n.No)("subscribeToAllFriends",{user_ids:a,source:i},t.requestId))},unsubscribe(s){const{accessToken:r,user_ids:a}=s,i=`${t.socialGraphApiUrl}social-graph/friends`,o={user_ids:a.join(",")};return e(i,{method:"delete",params:o,headers:{Authorization:`Bearer ${r}`}}).catch((0,n.No)("unsubscribe",o,t.requestId))}}}const vt="https://rosconnect.api.2gis.com/";function jt(e,t){return{checkConnection(t){const{entityId:s}=t;return e(`${vt}check/${s}`,{headers:{Accept:"application/json"}}).then((()=>!0)).catch((()=>!1))}}}function Rt(e){const{getToken:t}=e;return{getToken(){return(0,r.mG)(this,void 0,void 0,(function*(){try{const e=yield t();return e&&"string"==typeof e?e:void 0}catch(e){return}}))}}}var It=s(38091),St=s(98812),Tt=s(52034),At=s(52792),Ct=s(14866);const wt=6048e5;function kt({request:e,config:t}){const s=(s,r,a)=>{if(t.userAgent.includes("Chrome")||!t.userAgent.includes("Safari"))return;const{expires:i,domain:o,secure:c}=a||{},d=i&&function(e){return"number"==typeof e?1e3*e*60*60*24:e.getTime()-Date.now()}(i);if(!d||d<wt)return;const u=[{name:s,value:r,maxAge:d,domain:o,secure:c}];return e("/_/cookie",{method:"post",data:u}).catch((0,n.No)("setHttpCookie",u,t.requestId)).catch((()=>{}))};return{set(e,t,a){return(0,r.mG)(this,void 0,void 0,(function*(){a?Tt.set(e,t,a):Tt.set(e,t),yield s(e,t,a)}))},get(e){const t=Tt.get(e);if(t)return-1===Ge.zO.indexOf(t)?t:void 0},delete:(e,t)=>Tt.remove(e,t),setStrict(e,t){return(0,r.mG)(this,void 0,void 0,(function*(){yield(0,At.J)(e,t,s)}))},getStrict:Ct.z}}function Ut(e){const{config:t,sideEffects:s}=e,r=Object.assign({},(0,n.fp)(t.requestId)),a=(0,It.hG)(t,{headers:r,GDPRAllowedServiceHosts:[t.webApi3Url,t.webApiUrl,t.ppnotApiUrl,t.ppnotTypesApiUrl,t.ppnaApiUrl,t.ppngApiUrl,t.pedestrianApiUrl,t.isochronesApiUrl]}),o=new i;return function({overwrittenServices:e,request:t,config:s}){return Object.assign({analyticsApi:{trackGoogleEvent:Ae.cm,changeGoogleProjectId:Ae.Cy,setGoogleConsentGranted:Ae.GW,trackPageview:()=>{(0,Ce.S)(),(0,Ae.Vc)(),(0,we.i)(),(0,Ue.E)(),(0,ke.C)()}},achievesApi:tt(t,s),contestApi:st(t,s),webApi:new V(t,s),photoApi:X(t,s),aggregatorApi:new Te(t,s),reviewsApi:new re(t,s),discountsApi:ue(t,s),shortonizerApi:new le(t,s),profileApi:new ee(t,s),videoApi:new Ie(t,s),marketApi:new ve(t,s),authApi:Re(t,s),feedbackApi:new he(t,s),dataFeedbackApi:new Ne(t,s),favoritesApi:Le(t,s),favoritesStorage:De(),directionsApi:Xe(t,s),trafficApi:et(t,s),pusherApi:it(t,s),tUgcApi:ct(t,s),paymentsApi:ut(t,s),etaApi:pt(t,s),userActivityApi:ht(t,s),taxaApi:gt(t,s),messengerApi:ft(t,s),diskApi:bt(t,s),isochronesApi:_t(t,s),congestionApi:yt(t,s),chronologyPlacesApi:Et(t,s),socialGraphApi:Ot(t,s),rosconnectApi:jt(t)},e)}({overwrittenServices:{windowApi:(0,St.T)(),cookieApi:kt({request:a,config:t}),feedbackStorageApi:o,seoStoreApi:void 0,credentialsApi:Rt({getToken:s.getToken})},request:a,config:t})}},73134:(e,t,s)=>{s.d(t,{No:()=>c,fp:()=>o});var r=s(38091),a=s(87325),i=s(82603),n=s(83466);const o=e=>e?{"X-Request-Id":e}:void 0;function c(e,t,s){return o=>{const c=(0,a.NF)(o),u=`${c.name}: ${c.message||"Unknown error"}`;if("skipLog"in o&&o.skipLog)throw c;var l;throw o instanceof r.d7?(0,n.H)({message:u,id:"xsk47",level:"undefined"==typeof window?"error":"warn",payload:{type:"network",subtype:e,request_url:o.details.config.url,request_params:JSON.stringify(o.details.config.params),request_data:JSON.stringify(o.details.config.data),is_timeout:"ECONNABORTED"===o.details.code,response_status_code:o.details.response&&o.details.response.status},requestId:s}):o instanceof a.F7?(0,n.H)({message:u,id:"5tnb8",level:"warn",payload:{type:"network",subtype:e},requestId:s}):(0,n.H)({message:u,id:"guf37",level:"error",payload:{type:"exception",subtype:e,stack:o.stack,data:JSON.stringify((l=t,Object.assign(Object.assign({},(0,i.CE)(l,["accessToken","refreshToken","access_token","token"])),{fields:d(l,"fields",50),type:d(l,"type",50)})))},requestId:s}),c}}function d(e,t,s){const r=e[t];if("string"==typeof r)return r.length>s?`...(${r.length})`:void 0}},7459:(e,t,s)=>{s.d(t,{G:()=>n,s:()=>i});var r=s(73134),a=s(45488);const i=s(94844).v.join(",");function n(e,t){const{requestId:s,photoApiKey:n,photoApiUrl:o,photosPerPage:c,photosPerPageInUserProfile:d}=t;return{getPhotos({objectId:t,objectType:d,page:u,locale:l,pageSize:p,accessToken:h}){const g={key:n,object_id:t,object_type:d,locale:l,status:"active",sort_by:"position",album_code:"branch"===d?"common":"view",preview_size:i,size:p||c,page:u};return e(`${o}2.0/photo/get`,{params:g,headers:Object.assign({},h?{"Auth-Version":"2.0","Auth-Token":h}:void 0)}).then((e=>(0,a.i7)(e,c))).catch((0,r.No)("getPhotos",g,s))},getPhotosByAlbum({objectId:t,albumId:i,locale:d,preview_size:u,page_size:l,page_token:p,accessToken:h}){const g={locale:d,key:n,preview_size:u,page_size:l||c,page_token:p};return e(`${o}3.0/objects/${t}/albums/${i}/photos`,{params:g,headers:Object.assign({},h?{"Auth-Version":"2.0","Auth-Token":h}:void 0)}).then(a.Jp).catch((0,r.No)("getPhotosByAlbum",g,s))},getPhotosCount({objectIds:t,objectType:i,locale:c,accessToken:d}){const u={key:n,object_id:t.join(","),object_type:i,locale:c};return e(`${o}2.0/photo/count`,{params:u,headers:Object.assign({},d?{"Auth-Version":"2.0","Auth-Token":d}:void 0)}).then(a.$N).catch((0,r.No)("getPhotosCount",u,s))},getUserPhotos({locale:t,page:c,accessToken:u}){const l={key:n,object_type:"branch,geo",preview_size:i,page:c,size:d,locale:t,access_token:u};return e(`${o}2.0/user/photo/get`,{params:l}).then(a.di).catch((0,r.No)("getUserPhotos",l,s))},getPhotosLight({objectIds:t,photosCount:c}){const d={key:n,object_ids:t.join(","),preview_size:i,size:c};return e(`${o}2.0/photo/get/light`,{params:d}).then(a.kd).catch((0,r.No)("getPhotosLight",d,s))},getEntityAlbums({objectId:t,accessToken:i}){const c={key:n};return e(`${o}3.0/objects/${t}/albums/counts`,{params:c,headers:Object.assign({},i?{"Auth-Version":"2.0","Auth-Token":i}:void 0)}).then(a.S1).catch((0,r.No)("getAlbums",c,s))}}}},45488:(e,t,s)=>{s.d(t,{$N:()=>a,Jp:()=>p,Lg:()=>c,S1:()=>l,dD:()=>d,di:()=>i,i7:()=>n,kd:()=>o,tb:()=>u});var r=s(87325);function a({data:e}){return{items:e.result,total:0,code:e.meta.code}}function i({data:e}){if(e.result&&e.result.total){const t=e.result;return{items:t.items,total:t.total,code:200}}return h(e.meta.code)}function n(e,t){var s;const r=null===(s=e.data.result)||void 0===s?void 0:s[0];return r?{items:r.items,total:Math.min(t||0,r.total),code:200}:h(e.data.meta.code)}function o({data:e}){return e.result?{items:e.result.items,code:200}:{items:{},code:(0,r.og)(e.meta.code)}}function c({data:e}){return e.result?Object.assign(Object.assign({},e.result),{code:200}):h(e.meta.code)}function d({data:e}){return e.result?Object.assign(Object.assign({},e.result),{code:200}):h(e.meta.code)}function u({data:e}){const t=e.result&&e.result.items[0];if(!t)throw{name:"Error",message:"Unexpected add photos error",code:(0,r.og)(e.meta.code)};if(t.error)throw{name:t.error.type,message:t.error.message,code:(0,r.og)(e.meta.code)};return{items:[t],total:1,code:200}}function l({data:e,status:t}){return e.albums?{albums:e.albums,code:200}:{albums:[],code:t}}function p({data:e,status:t}){return e.albums&&e.items?e:{albums:[],items:[],code:t}}function h(e){return{items:[],total:0,code:(0,r.og)(e)}}},98812:(e,t,s)=>{s.d(t,{T:()=>a});const r=window,a=()=>({location:window.location,open:(e,t,s)=>window.open(e,t,s),reload(e=!1){window.location.reload(e)},delayClose(e=0){r.setTimeout((()=>r.close()),e)},historyPush(e,t){r.history.pushState(e,"",t)},historyReplace(e,t){r.history.replaceState(e,"",t)},historyBack(){r.history.back()},setTitle(e){r.document.title=e}})},61248:(e,t,s)=>{s.d(t,{A:()=>r});const r=e=>{return t=(null==e?void 0:e.user_id)||"",e=>e.data.user.achievements[t];var t}},32034:(e,t,s)=>{s.d(t,{W:()=>a});var r=s(33558);const a=e=>{var t;return null===(t=e.data.cart[r.M])||void 0===t?void 0:t.data}},86936:(e,t,s)=>{s.d(t,{QB:()=>n,UE:()=>i,cx:()=>a});var r=s(8919);const a=({state:e,searchId:t})=>e.data.directions[t],i=e=>t=>t.data.directionsPpnotTypes[e]||r.Y,n=({state:e,searchId:t,directionId:s})=>{const r=a({state:e,searchId:t});if(r&&r.data)switch(r.data.type){case"pedestrian":case"ppna":case"ppng":case"ppnot":return r.data.items.find((e=>e.id===s));default:return}}},51665:(e,t,s)=>{s.d(t,{AE:()=>b,BD:()=>E,T3:()=>d,TB:()=>g,Te:()=>m,Tv:()=>f,XU:()=>h,f6:()=>_,kO:()=>c,nM:()=>l,u5:()=>v,ub:()=>O,wj:()=>u});var r=s(37144),a=s(8919),i=s(82603),n=s(32312),o=s(25278);const c=({state:e,entityId:t,searchId:s})=>{const r=O({id:t,searchId:s});return e.data.searchContext[r]},d=()=>(0,r.P1)([({state:e,entityId:t})=>e.data.entity.profile[t],c],((e,t)=>e?e.data&&t?{data:Object.assign(Object.assign({},e.data),t),meta:e.meta}:e:a.Y)),u=d(),l=({state:e,entityId:t})=>e.data.entity.profile[t]||a.Y,p=()=>(0,r.P1)([({state:e,entityId:t})=>e.data.entity.photos[t]],(e=>e||a.Y)),h=p(),g=()=>(0,r.P1)([p(),({state:e})=>e.data.photo],((e,t)=>e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(i.Gg)})}):{data:void 0,meta:e.meta})),m=g(),f=(0,r.P1)([({state:e,entityId:t})=>e.data.entity.video?e.data.entity.video[t]:void 0],(e=>e||a.Y)),b=({state:e,searchId:t})=>e.data.reviewSearch[t]||a.Y,_=()=>(0,r.P1)([b,({state:e})=>e.data.review],y);function y(e,t){return e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(i.Gg)})}):{data:void 0,meta:e.meta}}const E=(0,r.P1)([({state:e,entityId:t})=>e.data.entity.discounts[t]],(e=>e||a.Y));function O(e){return e.searchId?`${e.searchId}_${e.id}`:e.id}function v({state:e,searchId:t,entityId:s}){let r=s;if(!r){const s=(0,n.gQ)({state:e,searchId:t,page:1});r=s&&s.data&&s.data[0]}return r&&r!==o.k8?l({state:e,entityId:r}):a.Y}},42461:(e,t,s)=>{s.d(t,{N5:()=>f,Or:()=>p,PP:()=>m,Tb:()=>O,iL:()=>v,jV:()=>g,m9:()=>b,nA:()=>h,tV:()=>l,y7:()=>E});var r=s(97698),a=s(27087),i=s(28176),n=s(7537),o=s(85388),c=s(3965),d=s(89003),u=s(3849);const l=e=>e.data.favoritesPersonal.objects,p=(0,r.P1)(l,(e=>{const t={};return(0,a.s0)(e).forEach((e=>{e&&"favorite"===e.type&&e.collection_id&&(t[e.collection_id]=t[e.collection_id]||[]).push(e)})),t})),h=e=>t=>{const s=l(t)[e];return g(s)?s:void 0};function g(e){return!!e&&"collection"===e.type}const m=e=>t=>{const s=l(t)[e];return f(s)?s:void 0};function f(e){return!!e&&"favorite"===e.type}function b(e){return"0"!==e.data.favoritesPersonal.sync.lastSync}function _(e,t){return e||(0,o.S)(t)&&(0,i.S)(t)}const y=(0,r.P1)(l,(e=>{const t={};return(0,a.s0)(e).forEach((e=>{if(e&&"favorite"===e.type&&e.collection_id){const s=e.point||e.source_point,r=_(e.object_id,s);r&&(t[r]||(t[r]=[])).push(e)}})),t})),E=e=>t=>{const s=_("point"===e.object_type?void 0:e.object_id,e.point);if(s){return(y(t)[s]||[]).some((t=>(0,n.G)(t,e)))}return!1},O=e=>(0,r.P1)([c.eb,c.M6],((t,s)=>!(!e.point||!(0,d.w)(e.point,null==t?void 0:t.point)&&!(0,d.w)(e.point,null==s?void 0:s.point))||(e.object_id===(null==t?void 0:t.object_id)||e.object_id===(null==s?void 0:s.object_id)))),v=(0,r.P1)(l,(e=>Object.values(e).reduce(((e,t)=>{if("collection"===(null==t?void 0:t.type)&&t.collection_id){const s=(0,u._p)(t.collection_id,t.color);e.push(s)}return e}),[])))},3965:(e,t,s)=>{s.d(t,{M6:()=>o,Y4:()=>i,eb:()=>n});var r=s(37144),a=s(27087);const i=e=>e.data.favoritesPlaces.objects,n=(0,r.P1)([i],(e=>(0,a.s0)(e).find((e=>"home"===(null==e?void 0:e.place_type))))),o=(0,r.P1)([i],(e=>(0,a.s0)(e).find((e=>"work"===(null==e?void 0:e.place_type)))))},90280:(e,t,s)=>{s.d(t,{Si:()=>l,UW:()=>c,VJ:()=>u,Wv:()=>g,jM:()=>p,tb:()=>m,zL:()=>d});var r=s(97698),a=s(27087),i=s(25278),n=s(48175);const o=e=>e.data.favoritesPublic.objects,c=(0,r.P1)(o,(e=>{const t={};return(0,a.s0)(e).forEach((e=>{e&&"favorite"===e.type&&e.collection_id&&(t[e.collection_id]=t[e.collection_id]||[]).push(e)})),t})),d=e=>(0,r.P1)((t=>c(t)[e]),(e=>e?(0,n.a)(e):i.LZ)),u=(0,r.P1)(o,(e=>{const t=(0,a.s0)(e),s=[],r=[],n=[];t.forEach((e=>h("interesting",e)?s.push(e):h("guidebook",e)?r.push(e):h("awards2019",e)?n.push(e):void 0));const o=(t,s)=>{const r=s&&s.collections?s.collections.reduce(((t,s)=>{const r=e[s];return t.push(r),t}),[]):i.LZ;return t.push(...r),t};return{interestingList:s.reduce(o,[]),guidebookList:r.reduce(o,[]),awards2019:n.reduce(o,[])}})),l=e=>t=>{const s=o(t)[e];return(r=s)&&"collection"===r.type?s:void 0;var r},p=e=>t=>{const s=o(t)[e];return(r=s)&&"favorite"===r.type?s:void 0;var r};const h=(e,t)=>!!t&&"theme"===t.type&&t.code===e;function g(e){return"0"!==e.data.favoritesPublic.sync.lastSync}function m(e,t,s){return(0,a.s0)(e.data.favoritesPublic.objects).find((e=>!!e&&("theme"===e.type&&e.code===t&&(!(!s&&e.project_id)&&!(s&&e.project_id&&!e.project_id.includes(s))))))}},56805:(e,t,s)=>{s.d(t,{O:()=>r,t:()=>a});const r=({state:e,filtersId:t})=>e.data.filters[t],a=e=>t=>{const s=t.data.filters[e];return s&&s.filters&&s.filters.attributes}},13833:(e,t,s)=>{s.d(t,{k:()=>r});const r=({state:e,gtaId:t})=>e.data.gta[t]},28963:(e,t,s)=>{s.d(t,{p:()=>a});var r=s(8919);const a=e=>e.data.history||r.Y},81813:(e,t,s)=>{s.d(t,{E$:()=>p,Gt:()=>o,HO:()=>u,Mv:()=>d,O9:()=>h,PC:()=>m,Te:()=>g,Ze:()=>l,ch:()=>c,dK:()=>f,rH:()=>b});var r=s(37144),a=s(8919),i=s(56144),n=s(49918);const o=({state:e,productId:t})=>e.data.market.products[t]||a.Y,c=({state:e,id:t})=>e.data.market.categories[t]||a.Y,d=({state:e,searchId:t})=>e.data.market.offersSearch.profile[t]||a.Y,u=({state:e,searchId:t})=>e.data.market.offersSearch.pagination[t],l=(0,r.P1)([d,u],((e,t)=>e?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,i.m)(t)})}):a.Y)),p=({state:e,productId:t,branchId:s})=>e.data.market.offers[(0,n.l)(t,s)]||a.Y,h=({state:e,filtersId:t})=>e.data.market.filters[t]||a.Y,g=({state:e,searchId:t})=>e.data.market.suggestions[t]||a.Y,m=({state:e,searchId:t})=>e.data.market.offersByOrgSearch.profile[t],f=(0,r.P1)([m,({state:e,searchId:t})=>e.data.market.offersByOrgSearch.pagination[t]],((e,t)=>{if(e)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,i.m)(t)})})}));function b(e){return`project${e}`}},8919:(e,t,s)=>{s.d(t,{Y:()=>r});const r={data:void 0,meta:void 0}},38361:(e,t,s)=>{s.d(t,{h:()=>i});var r=s(37144),a=s(8919);const i=(0,r.P1)([({state:e,id:t})=>e.data.photo[t]],(e=>e||a.Y))},95908:(e,t,s)=>{s.d(t,{H:()=>r,z:()=>a});const r=e=>t=>{var s;return e&&(null===(s=t.data.realty.infrastructure[e])||void 0===s?void 0:s.data)||void 0},a=e=>e.data.walkDistance||void 0},78621:(e,t,s)=>{s.d(t,{D4:()=>n,Rg:()=>d,zQ:()=>o});var r=s(27087),a=s(37144),i=s(79207);const n=({state:e,id:t})=>e.data.region.profile[t],o=({state:e,id:t})=>e.data.region.detector[t],c=e=>o({state:e,id:"default"}),d=((0,a.P1)([e=>{var t;return null===(t=e.data.settlements.default)||void 0===t?void 0:t.data}],(e=>e?(0,r.s0)((0,i.Y)(e)):void 0)),e=>{var t,s,r,a,i;return(null===(t=(e=>{var t,s,r;return(r=(null===(s=null===(t=c(e))||void 0===t?void 0:t.data)||void 0===s?void 0:s.id)||"",e=>{var t,s;return null===(s=null===(t=e.data.settlements.default)||void 0===t?void 0:t.data)||void 0===s?void 0:s[r]})(e)})(e))||void 0===t?void 0:t.alias)||(null===(i=null===(a=n({state:e,id:(null===(r=null===(s=c(e))||void 0===s?void 0:s.data)||void 0===r?void 0:r.regionId)||""}))||void 0===a?void 0:a.data)||void 0===i?void 0:i.uri_code)||""})},42833:(e,t,s)=>{s.d(t,{F_:()=>i,Tt:()=>a,UB:()=>n});var r=s(8919);const a=({state:e,id:t})=>e.data.review[t]||r.Y,i=(e,t)=>e.data.reviewComments[t]||r.Y,n=e=>t=>t.data.factsFilters[e]||r.Y},20882:(e,t,s)=>{s.d(t,{l:()=>i});var r=s(37144),a=s(8919);const i=({state:e,dashboardId:t})=>e.data.rubric.dashboard[t]||a.Y;(0,r.P1)([({state:e,rubricatorId:t})=>e.data.rubric.rubricator[t]],(e=>e||a.Y))},68789:(e,t,s)=>{s.d(t,{c:()=>n});var r=s(37144),a=s(8919),i=s(56144);const n=(0,r.P1)([({state:e,searchId:t})=>e.data.search.profile[t],({state:e,searchId:t})=>e.data.search.pagination[t]],((e,t)=>e?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,i.m)(t)})}):a.Y))},32312:(e,t,s)=>{s.d(t,{Aw:()=>o,Dx:()=>i,bx:()=>u,gQ:()=>n,rO:()=>c,ue:()=>d});var r=s(37144),a=s(8919);const i=({state:e,searchId:t})=>t&&e.data.search.pagination[t]||void 0,n=({state:e,searchId:t,page:s})=>{const r=i({state:e,searchId:t});return r&&r[s]},o=({state:e,searchId:t})=>t&&e.data.search.markers[t]||void 0,c=({state:e,searchId:t})=>t&&e.data.search.profile[t]||a.Y,d=(0,r.P1)([({state:e,searchId:t})=>i({state:e,searchId:t})],(e=>{const t=e&&e[1];if(t)return t.data[0]})),u=({state:e,searchId:t})=>{const s=n({state:e,searchId:t,page:1});return s&&s.data[0]}},55936:(e,t,s)=>{s.d(t,{n:()=>a});var r=s(8919);const a=e=>e.data.history||r.Y},47852:(e,t,s)=>{s.d(t,{O:()=>i});var r=s(37144),a=s(8919);const i=(0,r.P1)([({state:e,url:t})=>e.data.shortonizer[t]],(e=>e||a.Y))},86993:(e,t,s)=>{s.d(t,{m:()=>r});const r=(0,s(37144).P1)([({state:e,statusId:t})=>e.status[t]],(e=>e))},39304:(e,t,s)=>{s.d(t,{mg:()=>c,$b:()=>p});var r=s(97698),a=s(42461),i=s(27087),n=s(8919);var o=s(3965);const c=({state:e,searchId:t})=>e.data.objectSuggestions[t]||n.Y;function d(e){if(!e)return;const{object_type:t,object_id:s}=e;if(!s||!t)return;return{type:"place_type"in e?e.place_type:e.type,record:{id:s,type:t}}}function u(e){const{id:t,type:s,count:r,objectType:a,timestamp:i}=e;return{type:s,count:r,last_used:i,record:{id:t,type:a}}}const l=(0,r.P1)(a.tV,(e=>(0,i.s0)(e).filter(a.N5).reduce(((e,t)=>{const s=d(t);return s?[...e,s]:e}),[]))),p=(0,r.P1)([e=>(e=>e.data.profile||n.Y)(e),e=>(0,o.eb)(e),e=>(0,o.M6)(e),e=>l(e)],((e,t,s,r)=>{const{historyObjects:a,homeWorkObjects:i,suggestLastObjects:n}=e.data,o=n.map((e=>{const{id:t,timestamp:s}=e;return{type:"personal_poi",last_used:s,record:{id:t,type:"subtype"in e?`${e.type}.${e.subtype}`:e.type}}})),c=[...a,...i].reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.type]:[...e[t.type]||[],u(t)]})),{}),{history:l=[],supposed_home:p=[],supposed_other:h=[],supposed_work:g=[]}=c,m=d(t),f=d(s);return[...l,...m?[m]:[],...o,...r,...h,...f?[f]:[],...p,...g].slice(0,200)}))},15057:(e,t,s)=>{s.d(t,{C6:()=>O,DK:()=>I,It:()=>h,J:()=>l,J2:()=>c,Mq:()=>E,PT:()=>T,PW:()=>y,Pc:()=>m,Ue:()=>S,WR:()=>j,YS:()=>u,Yv:()=>R,b1:()=>_,bG:()=>g,nu:()=>d,qR:()=>v,qv:()=>f,zP:()=>b});var r=s(37144),a=s(8919),i=s(82603),n=s(8839),o=s(11237);(0,r.P1)([({state:e,userId:t})=>e.data.user.info[t]],(e=>e||a.Y));const c=(0,r.P1)([({state:e,userId:t})=>e.data.user.photos[t]],(e=>e||a.Y)),d=(0,r.P1)([c,({state:e})=>e.data.photo],((e,t)=>e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(i.Gg)})}):{meta:e.meta})),u=(0,r.P1)([({state:e,userId:t})=>e.data.user.reviews[t]],(e=>e||a.Y)),l=(0,r.P1)([u,({state:e})=>e.data.review],(function(e,t){if(!e.data)return{data:void 0,meta:e.meta};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(i.Gg)})})}));(0,r.P1)([({state:e})=>e.data.user.anonymousUser.feedbacksCount],(e=>e||0));const p=(0,r.P1)([({state:e,userId:t})=>e.data.user.feedbacks[t]],(e=>e||a.Y)),h=(0,r.P1)([p,({state:e})=>e.data.feedback],(function(e,t){if(!e.data)return{data:void 0,meta:e.meta};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items?e.data.items.map((e=>t[e])).filter(i.Gg):[]})})}));const g=e=>e.data.user.info.default||a.Y,m=e=>(0,n.d)(g(e)),f=e=>(0,o.V)(g(e)),b=e=>!m(e)&&!f(e),_=e=>{const t=g(e);return t&&t.data&&t.data.user_id},y=e=>e.data.user.devices,E=e=>t=>t.data.user.pinnedReviews[e]||a.Y,O=e=>t=>{var s,r;return null===(r=null===(s=t.data.user.pinnedReviews[e])||void 0===s?void 0:s.data)||void 0===r?void 0:r.items[0]},v=e=>t=>{const s=O(e)(t);if(s)return t.data.review[s]},j=e=>e.data.user.friendsActivities.default||a.Y,R=e=>t=>t.data.user.broadcast[e],I=e=>{var t,s;const r=g(e);return!(!(null===(t=r.data)||void 0===t?void 0:t.phone_number)||!(null===(s=r.data)||void 0===s?void 0:s.phone_number_confirmed))},S=e=>{const t=e.data.user.activities.default||a.Y;return null==t?void 0:t.data},T=e=>e.data.user.chronologyPlaces.default||a.Y},44414:(e,t,s)=>{s.d(t,{I:()=>r});const r=(e,t)=>{var s,r;const a=null===(r=null===(s=e.data.user.info.default)||void 0===s?void 0:s.data)||void 0===r?void 0:r.public_identity_accepted,i=t?a:void 0;return!0===i||void 0===i?"agreed":null===i?"idle":"declined"}},34185:(e,t,s)=>{function r(e){return!!e&&!!e.meta&&"error"===e.meta.status}function a(e,t){if(!e||!r(e))return!1;return e.meta.code===t}s.d(t,{G:()=>a,V:()=>r})},56144:(e,t,s)=>{function r(e){return e?Object.keys(e).sort(((e,t)=>+e-+t)).reduce(((t,s)=>{const r=e[s];return r&&r.data?[...t,...r.data]:t}),[]):[]}s.d(t,{m:()=>r})},11237:(e,t,s)=>{function r(e){return!!e&&!!e.meta&&"error"===e.meta.status}s.d(t,{V:()=>r})},12460:(e,t,s)=>{function r(e){return!e||!e.data}s.d(t,{X:()=>r})},93357:(e,t,s)=>{s.d(t,{G:()=>i});var r=s(12460),a=s(93917);function i(e){return(0,r.X)(e)&&!(0,a.hg)(e)}},8996:(e,t,s)=>{function r(e){return!e||!e.data&&!e.meta}s.d(t,{W:()=>r})},8839:(e,t,s)=>{s.d(t,{d:()=>a});var r=s(8996);function a(e){return!(0,r.W)(e)&&(!!e.meta&&"success"===e.meta.status)}},93917:(e,t,s)=>{s.d(t,{hg:()=>a,k$:()=>i,wX:()=>n});var r=s(12460);function a(e){return!!e&&!!e.meta&&"loading"===e.meta.status}function i(e){return(0,r.X)(e)&&a(e)}function n(e){return!(0,r.X)(e)&&a(e)}},48175:(e,t,s)=>{s.d(t,{a:()=>a});var r=s(82603);function a(e,t){return e.slice().sort(((e,s)=>{if(t){if(e.project_id&&e.project_id.includes(t)&&(!s.project_id||!s.project_id.includes(t)))return-1;if(s.project_id&&s.project_id.includes(t)&&(!e.project_id||!e.project_id.includes(t)))return 1}return(0,r.$K)(s.order)&&(0,r.$K)(e.order)?s.order-e.order:0}))}},46287:(e,t,s)=>{s.d(t,{l:()=>Vt});var r=s(74081),a=s(83466);var i=s(82603);const n={searchEvent:{},event:{},serverEvents:[]};function o(e=n,t){switch(t.type){case"_BSS_SAVE_EVENT_ATTRS":return function(e,t){const s=function({hash:e,entityId:t}){return[e,t].join("_")}({entityId:t.entityId,hash:t.chainId});return Object.assign(Object.assign({},e),{event:Object.assign(Object.assign({},e.event),{[s]:t.eventAttrs})})}(e,t.payload);case"_BSS_SAVE_SEARCH_EVENT_ATTRS":return function(e,t){return Object.assign(Object.assign({},e),{searchEvent:Object.assign(Object.assign({},e.searchEvent),{[t.chainId]:t.eventAttrs})})}(e,t.payload);case"_BSS_SET_SERVER_EVENTS":return function(e,t){return Object.assign(Object.assign({},e),{serverEvents:t.events})}(e,t.payload);case"BSS/REPLACE_CHAIN_ID":return function(e,t){const s={};(0,i.Ed)(e.searchEvent,(e=>{const r=t[e.chainId]||e.chainId;s[r]=Object.assign(Object.assign({},e),{chainId:r})}));const r=e.serverEvents.map((e=>{if(!e.add.hash||!t[e.add.hash])return e;const s=t[e.add.hash];return Object.assign(Object.assign({},e),{add:Object.assign(Object.assign({},e.add),{hash:s})})}));return Object.assign(Object.assign({},e),{searchEvent:s,serverEvents:r})}(e,t.payload);default:return e}}function c(e,t){return(s=t,r)=>{let a=s;for(let t=0;t<e.length;t+=1)a=e[t](a,r);return a}}var d=s(14677),u=s(759);const l={};function p(e){switch(e){case"branch":return u.Qt.recovery;case"station":case"station_platform":case"station_entrance":case"route":return u.Qt.transport;default:return u.Qt.geo}}const h={};function g(e){return e.map((e=>e.id))}var m=s(83447);const f=(0,r.UY)({profile:function(e=l,t){switch(t.type){case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_PROVIDERS":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":case"SEARCH/BY_BUILDING_ID":case"SEARCH/IN_BUILDING_BY_QUERY":case"SEARCH/FETCH_MAINTAINERS":case"ENTITY/FETCH_BY_POINT":case"SEARCH/FETCH_PARKINGS_AROUND":case"ENTITY/FETCH_PROFILE_NO_TYPE":return function(e,t,s){const r=t.searchId;if(!r)return e;const a=e[r],i=t;if(i.more&&a)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{meta:d.qV})});if(a)return e;return Object.assign(Object.assign({},e),{[r]:{data:{query:i.query,rubrId:i.rubrId,buildingId:i.buildingId,filters:i.filters,orgId:i.orgId,searchSourceType:s,sender:i.sender},meta:d.qV}})}(e,t.payload,{"SEARCH/FETCH_QUERY":"query","SEARCH/FETCH_FILIALS":"filial","SEARCH/BY_BUILDING_ID":"firmsInBuilding","SEARCH/IN_BUILDING_BY_QUERY":"firmsInBuilding","SEARCH/FETCH_MAINTAINERS":"maintainers","SEARCH/FETCH_PROVIDERS":"providers","SEARCH/FETCH_RUBRIC":"rubric","SEARCH/FETCH_ATTRIBUTE":"attribute","ENTITY/FETCH_BY_POINT":"searchByPoint","ENTITY/FETCH_PROFILE_NO_TYPE":"fetchProfile","SEARCH/FETCH_PARKINGS_AROUND":"parking"}[t.type]);case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t){const{meta:s,payload:r}=t,a=s.searchId;if(!a)return e;const i=e[a];if(!i||i.data&&i.data.searchType)return e;if(!r||200!==r.code)return Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},i.data),meta:(0,d.Mq)()}});const n=r.items[0];return Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},i.data),{searchType:p(n.type),hasPagesToLoad:!1,pages:1,total:1,searchSourceType:"branch"===n.type&&"fromPoi"in r&&r.fromPoi?"searchByPoi":i.data.searchSourceType}),meta:d.YR}})}(e,t);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t,s){const r=s.searchId,a=e[r];if(!a)return e;if(!t||200!==t.code)return s.more?e:Object.assign(Object.assign({},e),{[r]:{data:Object.assign({},a.data),meta:(0,d.Mq)()}});if(a.data&&a.data.currentPage===s.page)return Object.assign(Object.assign({},e),{[r]:{data:Object.assign({},a.data),meta:d.YR}});const n=(0,i.uv)({hasPagesToLoad:t.pages>s.page,pages:t.pages,total:t.total,ads:t.ads&&t.ads.map((e=>e.id)),searchType:t.searchType,searchAttributes:t.search_attributes,contextRubrics:t.context_rubrics,broadcast:t.broadcast,currentPage:s.page});return Object.assign(Object.assign({},e),{[r]:{data:Object.assign(Object.assign({},a.data),n),meta:d.YR}})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_ERROR":case"SEARCH/FETCH_FILIALS_ERROR":case"SEARCH/FETCH_PROVIDERS_ERROR":case"SEARCH/FETCH_RUBRIC_ERROR":case"SEARCH/FETCH_ATTRIBUTE_ERROR":case"SEARCH/BY_BUILDING_ID_ERROR":case"SEARCH/IN_BUILDING_BY_QUERY_ERROR":case"SEARCH/FETCH_MAINTAINERS_ERROR":case"ENTITY/FETCH_BY_POINT_ERROR":return function(e,t,s){const r=s.searchId,a=e[r];if(!a)return e;if(s.more)return e;return Object.assign(Object.assign({},e),{[r]:{data:Object.assign({},a.data),meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);default:return e}},pagination:function(e=h,t){switch(t.type){case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_PROVIDERS":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":case"SEARCH/BY_BUILDING_ID":case"SEARCH/IN_BUILDING_BY_QUERY":case"SEARCH/FETCH_MAINTAINERS":case"SEARCH/FETCH_PARKINGS_AROUND":return function(e,t){const s=t.searchId;if(!s)return e;const r=t.page,a=e[s];return Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},a),{[r]:{data:[],meta:d.qV}})})}(e,t.payload);case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){const r=s.searchId;if(!r)return e;const a=e[r]||{},i="1";if(a[i])return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[r]:{[i]:{data:[],meta:(0,d.L3)(t.code)}}});const n=g(t.items);return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[i]:{data:n,meta:d.YR}})})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t,s){const r=s.searchId,a=e[r]||{};if(200!==t.code)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[s.page]:Object.assign(Object.assign({},a[s.page]),{meta:(0,d.L3)(t.code)})})});const i=g(t.items);return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[s.page]:{data:i,meta:d.YR}})})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_ERROR":case"SEARCH/FETCH_FILIALS_ERROR":case"SEARCH/FETCH_PROVIDERS_ERROR":case"SEARCH/FETCH_RUBRIC_ERROR":case"SEARCH/FETCH_ATTRIBUTE_ERROR":case"SEARCH/BY_BUILDING_ID_ERROR":case"SEARCH/IN_BUILDING_BY_QUERY_ERROR":case"SEARCH/FETCH_MAINTAINERS_ERROR":return function(e,t,s){const r=s.searchId,a=e[r]||{},i=(0,d.UL)(t);return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[s.page]:Object.assign(Object.assign({},a[s.page]),{meta:i})})})}(e,t.payload,t.meta);default:return e}},markers:function(e={},t){return(0,m.O)(e,t)}});var b=s(50022),_=s(64656),y=s(27087);function E(e,t){return e?e.reduce(((e,s)=>{const r=t[s.id],a={data:(0,b.Eb)(s),meta:d.YR};return e[s.id]=r?(0,b.z2)(r,a):a,e}),{}):{}}var O=s(27414);var v=s(34291);const j=(0,v.xr)("fetchApartments",{},{start:(e,{params:t})=>(0,_.Av)(e,t.id),success(e,{params:t,result:s}){const r=200===s.code?s.items[0]:void 0;return r?(0,_.Cj)(e,t.id,r):e},error:(e,{params:t,error:s})=>(0,_.VJ)(e,t.id,s)});var R=s(9889),I=s(96683);const S=(0,r.UY)({profile:c([function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t){const s=t&&200===t.code?E(t.items.concat(t.ads||[]),e):{};if(!Object.keys(s).length)return e;return Object.assign(Object.assign({},e),s)}(e,t.payload);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,t){if(!t||200!==t.code)return{};const s=E(t.items.map((e=>e.branch)),e);if(!Object.keys(s).length)return e;return Object.assign(Object.assign({},e),s)}(e,t.payload);case"ENTITY/FETCH_PROFILE_NO_TYPE":return function(e,t){const s=(0,i._J)(t.id),r=e[s];return Object.assign(Object.assign({},e),{[s]:{data:r&&r.data,meta:d.qV}})}(e,t.payload);case"ENTITY/FETCH_BY_POINT_SUCCESS":return function(e,t){const s=t.items[0];if(!s)return e;return Object.assign(Object.assign({},e),{[s.id]:{data:(0,b.Eb)(s),meta:d.YR}})}(e,t.payload);case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){const r=(0,i._J)(s.id),a=t.items[0];if(!a){const t=e[r];return Object.assign(Object.assign({},e),{[r]:{data:t&&t.data,meta:(0,d.Mq)()}})}return Object.assign(Object.assign({},e),{[r]:{data:(0,b.Eb)(a),meta:d.YR}})}(e,t.payload,t.meta);case"ENTITY/FETCH_PROFILE_NO_TYPE_ERROR":return function(e,t,s){const r=(0,i._J)(s.id),a=e[r];return Object.assign(Object.assign({},e),{[r]:{data:a&&a.data,meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);case"ENTITY/FETCH_MULTIPLE":return function(e,t){if(0===t.ids.length)return e;const s=(0,y.ei)(e,t.ids),r=t.ids.reduce(((e,t)=>(0,_.Av)(e,t)),s);return Object.assign(Object.assign({},e),r)}(e,t.payload);case"ENTITY/FETCH_MULTIPLE_SUCCESS":return function(e,t){if(0===t.items.length)return e;const s=t.items.reduce(((t,s)=>{const r=e[s.id],a=(0,b.Eb)(s),i=(0,b.eg)(r&&r.data,a);return(0,_.Cj)(t,s.id,i)}),{});return Object.assign(Object.assign({},e),s)}(e,t.payload);case"ENTITY/FETCH_MULTIPLE_ERROR":return function(e,t,s){if(0===s.ids.length)return e;const r=(0,y.ei)(e,s.ids),a=s.ids.reduce(((e,s)=>(0,_.VJ)(e,s,t)),r);return Object.assign(Object.assign({},e),a)}(e,t.payload,t.meta);default:return e}},R.zb],{}),photos:I.a,discounts:function(e={},t){return(0,O.b)(e,t)},video:function(e={},t){switch(t.type){case"ENTITY/FETCH_VIDEO_DATA":return function(e,t){const s=e[t.id],r={data:s?s.data:void 0,meta:d.qV};return Object.assign(Object.assign({},e),{[t.id]:r})}(e,t.payload);case"ENTITY/FETCH_VIDEO_DATA_SUCCESS":return function(e,t,s){const r={data:t,meta:d.YR};return Object.assign(Object.assign({},e),{[s.id]:r})}(e,t.payload,t.meta);case"ENTITY/FETCH_VIDEO_DATA_ERROR":return function(e,t,s){const r=e[s.id],a={data:r?r.data:void 0,meta:(0,d.UL)(t)};return Object.assign(Object.assign({},e),{[s.id]:a})}(e,t.payload,t.meta);default:return e}},apartments:j,entrance:R.FG}),T={};const A=(0,r.UY)({profile:function(e={},t){switch(t.type){case"REGION/FETCH":return function(e,t){return Object.assign(Object.assign({},e),{[t.id]:{meta:d.qV}})}(e,t.payload);case"REGION/FETCH_SUCCESS":return function(e,t,s){return Object.assign(Object.assign({},e),{[s.id]:{data:t.result,meta:d.YR}})}(e,t.payload,t.meta);case"REGION/FETCH_LIST_SUCCESS":return function(e,t){const s={};return Object.assign(Object.assign({},e),t.result.items.reduce(((e,t)=>(e[t.id]={data:t,meta:d.YR},e)),s))}(e,t.payload);case"REGION/CROP_LIST":return function(e,t){if(!t.ids.length)return e;const s={};return t.ids.forEach((t=>{s[t]=e[t]})),s}(e,t.payload);default:return e}},search:function(e={},t){switch(t.type){case"REGION/FETCH_LIST":return function(e,t){return Object.assign(Object.assign({},e),{[t]:{meta:d.qV}})}(e,t.payload.searchId);case"REGION/FETCH_LIST_SUCCESS":return function(e,t,s){return Object.assign(Object.assign({},e),{[s.searchId]:{data:t.result.items.map((e=>e.id)),meta:d.YR}})}(e,t.payload,t.meta);case"REGION/CROP_LIST":return{};default:return e}},detector:function(e={},t){switch(t.type){case"REGION/DETECT":{const s=t.payload.searchId,r=e[s];return Object.assign(Object.assign({},e),{[s]:{data:r&&r.data,meta:d.qV}})}case"REGION/DETECT_SUCCESS":{const r=t.meta.searchId,a=200===t.payload.code&&t.payload.items[0];if(!a)return Object.assign(Object.assign({},e),{[r]:{data:void 0,meta:(0,d.Mq)()}});const i=e[r];return i&&i.data&&i.data.id===a.id?e:Object.assign(Object.assign({},e),{[r]:{data:{regionId:(s=a,s.region_id&&"0"!==s.region_id?s.region_id:s.overlap_region_id&&"0"!==s.overlap_region_id?s.overlap_region_id:void 0),name:a.name,type:a.type,id:a.id,segmentId:a.segment_id,overlapRegionId:a.overlap_region_id,countryCode:a.country_code,allowChangeDomain:a.allow_change_domain,baseOverlapRegionId:t.payload.overlap_region_id,admDiv:a.adm_div},meta:d.YR}})}case"REGION/DETECT_ERROR":{const s=t.meta.searchId;return Object.assign(Object.assign({},e),{[s]:{data:void 0,meta:(0,d.UL)(t.payload)}})}case"REGION/CLEAR_DETECTOR":return{};case"REGION/SET_DETECTOR":return Object.assign(Object.assign({},e),{default:{data:t.payload,meta:d.YR}});default:return e}var s}});var C=s(51665),w=s(5163);function k(e){const{items:t,searchId:s}=e,r={};for(const e of t){const{id:t,ads:a,context:n,stat:o,hash:c}=e,d=(0,C.ub)({id:t,searchId:s}),u=N(a);r[d]=(0,i.uv)({ads:u,context:n,stat:o,hash:c})}return r}function U(e){const{currentContext:t,profile:s,markerStat:r}=e,a=N(s.ads),{context:i,stat:n,hash:o}=s;let c={ads:a,context:i,stat:n,hash:o};return t&&(c=Object.assign(Object.assign({},c),{stat:t.stat,hash:t.hash,context:t.context})),r&&(c.stat=Object.assign(Object.assign({},r),c.stat)),c}function N(e){var t,s;return(null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.fmcg)||(null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.fmcg_owner)?function(e){const t=function(e){if(e.options){if(e.options.fmcg){const t=e.options.fmcg.map((e=>{const{ads_id:t,logo:s,text:r,text_warning:a}=e,i=(0,w._T)(e,["ads_id","logo","text","text_warning"]);return Object.assign(Object.assign({},i),{owned_rubric_id:t,ads_id:t,is_primary:!0,logo:null==s?void 0:s[0],ads_texts:{text:r,text_warning:a}})}));return(0,i.uv)(t)}return e.options.buy_here}}(e),s=function(e){if(e.options)return e.options.fmcg_owner?e.options.fmcg_owner.map((e=>Object.assign(Object.assign({},e),{owned_rubric_id:e.ads_id}))):e.options.buy_here_owner}(e);return Object.assign(Object.assign({},e),{options:Object.assign(Object.assign({},e.options),{buy_here:t,buy_here_owner:s})})}(e):e}var P=s(49918);const L=(0,r.UY)({profile:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS":case"MARKET/FETCH_CATEGORIES_BY_BRANCH":case"MARKET/FETCH_BRANCH_PRODUCTS":return function(e,{payload:t}){return(0,_.Av)(e,t.offersSearchId)}(e,t);case"MARKET/FETCH_OFFERS_SUCCESS":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){const r=s.offersSearchId,a=e[r];if(!a)return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[r]:{data:a.data,meta:(0,d.Mq)()}});const i="branchId"in s&&"pinned_items"in t&&t.pinned_items?t.pinned_items.map((e=>(0,P.l)(e.product.id,s.branchId))):void 0,{total:n,pages:o,bss:c}=t,u={list_info:"list_info"in t?t.list_info:void 0,total:n,pages:o,bss:c,pinned_items:i};return Object.assign(Object.assign({},e),{[r]:{data:Object.assign({},u),meta:d.YR}})}(e,t);case"MARKET/FETCH_OFFERS_ERROR":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_ERROR":case"MARKET/FETCH_BRANCH_PRODUCTS_ERROR":return function(e,{payload:t,meta:s}){const r=s.offersSearchId,a=e[r];if(!a)return e;return Object.assign(Object.assign({},e),{[r]:{data:a.data,meta:(0,d.UL)(t)}})}(e,t);default:return e}},pagination:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS":return function(e,{payload:t}){return Object.assign(Object.assign({},e),{[t.offersSearchId]:Object.assign(Object.assign({},e[t.offersSearchId]),{[t.page]:{meta:d.qV,data:[]}})})}(e,t);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,{payload:t,meta:s}){const r=s.productId,a=s.offersSearchId,i=e[a]||{};if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},i),{[s.page]:Object.assign(Object.assign({},i[s.page]),{meta:(0,d.L3)(t.code)})})});const n=t.items.map((e=>(0,P.l)(r,e.branch.id)));return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},i),{[s.page]:{data:n,meta:d.YR}})})}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":return function(e,{payload:t,meta:s}){const r=s.offersSearchId,a=e[r]||{},i=1;if(200!==t.code)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[i]:Object.assign(Object.assign({},a[i]),{meta:(0,d.L3)(t.code)})})});const n=t.items.map((({product:e})=>(0,P.l)(e.id,s.branchId)));return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[i]:{data:n,meta:d.YR}})})}(e,t);case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){const r=s.offersSearchId,a=e[r]||{},i=s.page;if(200!==t.code)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[i]:Object.assign(Object.assign({},a[i]),{meta:(0,d.L3)(t.code)})})});const n=t.items.map((({product:e})=>(0,P.l)(e.id,s.branchId)));return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[i]:{data:n,meta:d.YR}})})}(e,t);case"MARKET/FETCH_OFFERS_ERROR":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_ERROR":case"MARKET/FETCH_BRANCH_PRODUCTS_ERROR":return function(e,{payload:t,meta:s}){const r=s.offersSearchId,a=e[r]||{},i="page"in s?s.page:1;return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{[i]:Object.assign(Object.assign({},a[i]),{meta:(0,d.UL)(t)})})})}(e,t);default:return e}}});const H={};function F(e){return{type:"market",subtype:e.hint.type,id:e.hint.id,name:e.hint.text,search_attributes:{suggested_text:e.hint.text,suggest_parts:e.hint.highlighted_text.map((e=>({text:e.text,is_suggested:"highlighted"!==e.style})))}}}var D=s(41560);const B={entity:{profile:{},apartments:{},photos:{},discounts:{},entrance:{},video:{}},search:{profile:{},pagination:{},markers:{}},searchContext:{},market:{products:{},offers:{},offersSearch:{profile:{},pagination:{}},offersByOrgSearch:{profile:{},pagination:{}},categories:{},filters:{},suggestions:{}},region:{profile:{},search:{},detector:{}},settlements:{},filters:{},factsFilters:{},factsInReview:{},review:{},photo:{},feedback:{},suggestion:{},objectSuggestions:{},user:{info:{},anonymousUser:{},devices:{},achievements:{},feedbacks:{},photos:{},reviews:{},chronologyPlaces:{},activities:{},friendsActivities:{},pinnedReviews:{},shortOrders:s(8919).Y,broadcast:{},phone:{}},shortonizer:{},seoStore:{meta:D.YR},reviewSearch:{},gta:{},history:{data:{searches:[],suggestLastObjects:[]}},profile:{data:{historyObjects:[],homeWorkObjects:[],suggestLastObjects:[]}},favoritesPublic:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},favoritesPersonal:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},favoritesPlaces:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},directions:{},directionsPpnotTypes:{},traffic:{},rubricator:{lists:{},items:{}},rubric:{dashboard:{},rubricator:{}},reviewComments:{},order:{},deliveryOrder:{},ordersHistory:{},cart:{},contests:{},walkDistance:{},roadAccident:{},realty:{search:{profile:{},pagination:{}},items:{},markers:{},hashmap:{},infrastructure:{}}};const $=(0,r.UY)({products:function(e={},t){switch(t.type){case"MARKET/FETCH_PRODUCT_BY_ID_SUCCESS":return function(e,{payload:t,meta:s}){const r=s.productId,a=e[r],i="items"in t&&t.items?t.items[0]:void 0;if(!i)return Object.assign(Object.assign({},e),{[r]:{data:a&&a.data,meta:(0,d.Mq)(r.length<13?410:404)}});return Object.assign(Object.assign({},e),{[r]:{data:Object.assign(Object.assign({},i),{dicts:t.dicts}),meta:d.YR}})}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t}){if(!t||200!==t.code)return e;const{items:s,pinned_items:r,dicts:a}=t,i=[...s,...r||[]],n={};return i.forEach((({product:t})=>{const s=e[t.id];n[t.id]={data:s?s.data:{product:t,dicts:a},meta:d.YR}})),Object.assign(Object.assign({},e),n)}(e,t);default:return e}},offersSearch:L,offers:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,{payload:t,meta:s}){if(!t||200!==t.code)return e;const r=s.productId,a={};return t.items.forEach((e=>{const t=(0,P.l)(r,e.branch.id),s={productId:r,branchId:e.branch.id,price:e.price,price_value:e.price_value,currency:e.currency,market_item_actions:e.market_item_actions,amount:e.amount};a[t]={data:s,meta:d.YR}})),Object.assign(Object.assign({},e),a)}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){if(!t||200!==t.code)return e;const r={};return[...t.items,...t.pinned_items||[]].forEach((({product:e,offer:t,branch:a})=>{const i=(0,P.l)(e.id,s.branchId),n={productId:e.id,branchId:s.branchId,price:t.price,price_value:t.price_value,currency:t.currency,buttons:t.buttons,sellerInfo:a&&a.name,orgId:a&&a.org.id,market_item_actions:t.market_item_actions,amount:t.amount};r[i]={data:n,meta:d.YR}})),Object.assign(Object.assign({},e),r)}(e,t);default:return e}},categories:function(e={},t){switch(t.type){case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":return function(e,{meta:t,payload:s}){if(!s||200!==s.code)return e;const r=t.offersSearchId,a=s.categories;if(!a||!a.children.length){const t=e[r];return Object.assign(Object.assign({},e),{[r]:{data:t&&t.data,meta:(0,d.Mq)()}})}return Object.assign(Object.assign({},e),{[r]:{data:a,meta:d.YR}})}(e,t);case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t},s){if(e[s])return e;if(!t||200!==t.code)return e;const{categories:r}=t;if(!r||!r.children.length)return e;return Object.assign(Object.assign({},e),{[s]:{data:r,meta:d.YR}})}(e,t,t.meta.offersSearchId);default:return e}},filters:function(e=H,t){switch(t.type){case"MARKET/FETCH_OFFERS":case"MARKET/FETCH_BRANCH_PRODUCTS":return function(e,t){const{filtersId:s}=t,r=e[s];if(r&&"success"===r.meta.status)return e;return Object.assign(Object.assign({},e),{[s]:{data:void 0,meta:d.qV}})}(e,t.payload);case"MARKET/FETCH_OFFERS_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,t,s){if(!t)return e;const{filtersId:r}=s,a=e[r];if(!a||a&&"loading"!==a.meta.status)return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[r]:{data:void 0,meta:(0,d.L3)(t.code)}});const{filters:i}=t;return Object.assign(Object.assign({},e),{[r]:{data:{filters:i},meta:d.YR}})}(e,t.payload,t.meta);default:return e}},suggestions:function(e={},t){switch(t.type){case"MARKET/FETCH_SUGGESTIONS":return function(e,{payload:t}){const{searchId:s,query:r}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:r},meta:d.qV}})}(e,t);case"MARKET/FETCH_SUGGESTIONS_SUCCESS":return function(e,{payload:t,meta:s}){const{searchId:r}=s,{code:a,items:i,bss:n}=t,o=e[r];if(!o)return e;if(200!==a||!i||!i.length)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},o),{meta:(0,d.Mq)()})});return Object.assign(Object.assign({},e),{[r]:{data:Object.assign(Object.assign({},o.data),{items:i.map(F),bss:n}),meta:d.YR}})}(e,t);case"MARKET/FETCH_SUGGESTIONS_ERROR":return function(e,{payload:t,meta:s}){const{searchId:r}=s,a=e[s.searchId];if(!a)return e;return Object.assign(Object.assign({},e),{[r]:{data:a&&a.data,meta:(0,d.UL)(t)}})}(e,t);case"MARKET/DROP_SUGGESTIONS":return{};default:return e}},offersByOrgSearch:(0,I.L)(B.market.offersByOrgSearch)});function q(e){return"user_query"===e.type?{type:"object",search_attributes:e.search_attributes}:function(e){const{search_attributes:t}=e,s=(0,w._T)(e,["search_attributes"]);return{type:"object",search_attributes:t,entity:s}}(e)}var G=s(44878);const x=(0,v.KX)("fetchUserAchievements",{start:(e,{params:t})=>({[t.userId]:Object.assign(Object.assign({},e),{meta:d.qV})}),success:(e,{result:t,params:s})=>t.items&&t.items.length?Object.assign(Object.assign({},e),{[s.userId]:{data:{groups:t.groups,items:t.items,total:t.meta.total,completed:t.meta.completed,contest_progress_weeks:t.meta.contest_progress_weeks},meta:d.YR}}):Object.assign(Object.assign({},e),{[s.userId]:{meta:(0,d.Mq)()}}),error:(e,{error:t,params:s})=>({[s.userId]:Object.assign(Object.assign({},e),{meta:(0,d.UL)(t)})})});var M=s(20194);const Y=(0,r.UY)({info:function(e={},t){switch(t.type){case"USER/UPDATE_UNSAVED_INFO":{const s=e.default;if(!s||!s.data)return e;const r=s.data,a=Object.assign(Object.assign({},r.unsaved),t.payload.unsaved),n=Object.assign(Object.assign({},r),{unsaved:null===r.public_identity_accepted&&!1===a.public_identity_accepted?(0,i.CE)(a,["public_identity_accepted"]):a});return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},s),{data:n})})}case"USER/UPDATE_EMAIL":{const t=e.default;if(!t||!t.data)return e;const s=Object.assign(Object.assign({},t.meta),{crud:"updating"});return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},t),{meta:s})})}case"USER/UPDATE_EMAIL_SUCCESS":{const s=e.default;return s&&s.data?Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},s),{data:Object.assign(Object.assign({},s.data),{new_email:t.payload.new_email||void 0,unsaved:Object.assign(Object.assign({},s.data.unsaved),{email:void 0})}),meta:Object.assign(Object.assign({},s.meta),{crud:void 0})})}):e}case"USER/UPDATE_EMAIL_ERROR":{const t=e.default;return t&&t.data?Object.assign(Object.assign({},e),{default:{data:Object.assign(Object.assign({},t.data),{unsaved:Object.assign(Object.assign({},t.data.unsaved),{email:void 0})}),meta:Object.assign(Object.assign({},t.meta),{crud:void 0})}}):e}default:return(0,G.j)(e,t)}},photos:(0,I.L)(B.user.photos),reviews:function(e={},t){switch(t.type){case"USER/FETCH_REVIEWS":return function(e,t){const s=e[t.userId];return Object.assign(Object.assign({},e),{[t.userId]:{data:s&&s.data,meta:d.qV}})}(e,t.payload);case"USER/FETCH_REVIEWS_SUCCESS":return function(e,t,s){const r=e[s.userId];if(!t.items.length)return Object.assign(Object.assign({},e),{[s.userId]:{data:r&&r.data,meta:(0,d.Mq)()}});const a=r&&r.data&&r.data.items||[],i=t.items.map((e=>e.id)),n=s.offset?[...a,...i]:i,o=t.items[t.items.length-1];return Object.assign(Object.assign({},e),{[s.userId]:{data:{items:n,total:t.total,offset:o.date_edited||o.date_created},meta:d.YR}})}(e,t.payload,t.meta);case"USER/FETCH_REVIEWS_ERROR":return function(e,t,s){const r=e[s.userId];return Object.assign(Object.assign({},e),{[s.userId]:{data:r&&r.data,meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t,s){const r=e[s.userId];if(!r||!r.data)return e;const a=r.data.items.filter((e=>e!==s.id));return Object.assign(Object.assign({},e),{[s.userId]:{data:Object.assign(Object.assign({},r.data),{items:a,total:r.data.total-1}),meta:r.meta}})}(e,t.payload,t.meta);default:return e}},feedbacks:function(e={},t){switch(t.type){case"FEEDBACK/FETCH_USER_FEEDBACKS":return function(e,t){const s=e[t.userId];return Object.assign(Object.assign({},e),{[t.userId]:{data:s&&s.data,meta:d.qV}})}(e,t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS_SUCCESS":return function(e,t,s){const r=e[s.userId];if(!t.items||!t.items.length)return Object.assign(Object.assign({},e),{[s.userId]:{data:r&&r.data,meta:(0,d.Mq)()}});const a=r&&r.data&&r.data.items||[],i=t.items.map((e=>e.id)),n=s.offset>0?[...a,...i]:i;return Object.assign(Object.assign({},e),{[s.userId]:{data:Object.assign(Object.assign({},r&&r.data),{items:n,offset:n.length}),meta:d.YR}})}(e,t.payload,t.meta);case"FEEDBACK/FETCH_USER_FEEDBACKS_ERROR":return function(e,t,s){const r=e[s.userId];return Object.assign(Object.assign({},e),{[s.userId]:{data:r&&r.data,meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);case"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT_SUCCESS":return function(e,t,s){const r=e[s.userId],a=r&&r.data;return Object.assign(Object.assign({},e),{[s.userId]:Object.assign(Object.assign({},r),{data:Object.assign(Object.assign({},a),{items:a&&a.items||[],total:t.total}),meta:r?r.meta:d.YR})})}(e,t.payload,t.meta);default:return e}},anonymousUser:function(e={},t){switch(t.type){case"FEEDBACK/GET_ANOMYMOUS_FEEDBACKS_COUNT_SUCCESS":return function(e,t){return Object.assign(Object.assign({},e),{feedbacksCount:t?parseInt(t,10):0})}(e,t.payload);case"FEEDBACK/SET_ANOMYMOUS_FEEDBACKS_COUNT":return function(e,t){return Object.assign(Object.assign({},e),{feedbacksCount:t.feedbacksCount})}(e,t.payload);default:return e}},achievements:function(e={},t){return t.type,x(e,t)},devices:function(e={},t){return"USER/CLEAR_DEVICES"===t.type?{}:e},pinnedReviews:function(e={},t){return"USER/DELETE_REVIEW_SUCCESS"===t.type&&t.meta.entityId?Object.assign(Object.assign({},e),{[t.meta.entityId]:void 0}):e},shortOrders:(0,I.L)(B.user.shortOrders),broadcast:(0,I.L)(B.user.broadcast),activities:(0,I.L)(B.user.activities),friendsActivities:function(e={},t){return(0,M.V)(e,t)},phone:(0,I.L)(B.user.phone),chronologyPlaces:(0,I.L)(B.user.chronologyPlaces)});var z=s(76448);function K(e,{sync:t,objects:s,replace:r}){return r?{sync:t,objects:s}:(0,i.xb)(s)?{sync:t,objects:e.objects}:{sync:t,objects:Object.assign(Object.assign({},e.objects),s)}}const Q=(0,v.Rs)("syncPublicFavorites","favoritesPublic",{success:(e,{result:t})=>K(e,t)}),V=(0,v.Rs)("syncPlaces","favoritesPlaces",{success:(e,{result:t})=>K(e,t)}),W=(0,v.Rs)("modifyPlaces","favoritesPlaces",{success:(e,{result:t})=>K(e,t)}),J=(0,v.Rs)("modifyPersonalFavorites","favoritesPersonal",{success:(e,{result:t})=>K(e,t)}),Z=(0,v.Rs)("syncPersonalFavorites","favoritesPersonal",{success:(e,{result:t})=>K(e,t)}),X=(0,v.Rs)("fetchTrafficScore","traffic",{start(e,{params:t}){const s=e[t.regionCode];return Object.assign(Object.assign({},e),{[t.regionCode]:{data:s&&s.data,meta:D.qV}})},success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{[t.regionCode]:{data:{score:s},meta:D.YR}}),error(e,{params:t,error:s}){const r=e[t.regionCode];return Object.assign(Object.assign({},e),{[t.regionCode]:{data:r&&r.data,meta:(0,D.UL)(s)}})}});var ee=s(44390),te=s(81813);const se=(0,v.Rs)("fetchProjecMarketCategories","market",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.rH)(t.projectId)]:{meta:d.qV}})}),success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.rH)(t.projectId)]:{meta:d.YR,data:s.categories}})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.rH)(t.projectId)]:{meta:(0,d.UL)(s)}})})}),re=(0,v.Rs)("fetchProductOffersGroupedByOrg","market",{start:(e,{params:t})=>ae({state:e,searchId:t.searchId,page:t.page,meta:d.qV}),success(e,{params:t,result:s}){if(!s.items.length)return ae({state:e,searchId:t.searchId,page:t.page,meta:(0,d.Mq)()});const{searchId:r,filtersId:a,page:i=1}=t,{filters:n,total:o,items:c,bss:u}=s,l=d.YR;return Object.assign(Object.assign({},e),{offersByOrgSearch:Object.assign(Object.assign({},e.offersByOrgSearch),{profile:Object.assign(Object.assign({},e.offersByOrgSearch.profile),{[r]:{data:{total:o,pages:(p=o,h=ee.Kt,Math.ceil(p/h)),bss:u},meta:l}}),pagination:Object.assign(Object.assign({},e.offersByOrgSearch.pagination),{[r]:Object.assign(Object.assign({},e.offersByOrgSearch.pagination[r]),{[i]:{data:c,meta:l}})})}),filters:Object.assign(Object.assign({},e.filters),a?{[a]:{data:{filters:n},meta:l}}:void 0)});var p,h},error:(e,{params:t,error:s})=>ae({state:e,searchId:t.searchId,page:t.page,meta:(0,d.UL)(s)})});function ae({state:e,searchId:t,filtersId:s,page:r=1,meta:a}){return Object.assign(Object.assign({},e),{offersByOrgSearch:Object.assign(Object.assign({},e.offersByOrgSearch),{profile:Object.assign(Object.assign({},e.offersByOrgSearch.profile),{[t]:Object.assign(Object.assign({},e.offersByOrgSearch.profile[t]),{meta:a})}),pagination:Object.assign(Object.assign({},e.offersByOrgSearch.pagination),{[t]:Object.assign(Object.assign({},e.offersByOrgSearch.pagination[t]),{[r]:{data:[],meta:a}})})}),filters:Object.assign(Object.assign({},e.filters),s?{[s]:Object.assign(Object.assign({},e.filters[s]),{meta:a})}:void 0)})}const ie=(0,v.Rs)("getAllPublicFavorites","favoritesPublic",{success:(e,{result:t})=>K(e,t)}),ne=[(0,v.Rs)("clearPersonalData","favoritesPersonal",{success:()=>({sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}})}),(0,v.Rs)("clearPersonalData","favoritesPlaces",{success:()=>({sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}})}),(0,v.Rs)("clearPersonalData","user",{success:e=>Object.assign(Object.assign({},B.user),{info:e.info,anonymousUser:e.anonymousUser})}),(0,v.Rs)("clearPersonalData","history",{success:()=>({data:{searches:[],suggestLastObjects:[],historyObjects:[],homeWorkObjects:[]}})})],oe=(0,v.Rs)("fetchReviewComments","reviewComments",{start:(e,{params:t})=>(0,_.Av)(e,t.id),success:(e,{result:t,params:s})=>(0,_.Cj)(e,s.id,t.comments),error:(e,{error:t,params:s})=>(0,_.VJ)(e,s.id,t)}),ce=(0,v.Rs)("sendReviewCommentAnswer","reviewComments",{success(e,{params:t,result:s}){const r=e[t.id];return r?Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},r),{data:r.data?[...r.data,s.comment]:[s.comment]})}):e}}),de=(0,v.Rs)("removeReviewComment","reviewComments",{success(e,{params:t}){var s;const r=e[t.reviewId];return r?Object.assign(Object.assign({},e),{[t.reviewId]:Object.assign(Object.assign({},r),{data:null===(s=r.data)||void 0===s?void 0:s.filter((e=>e.id!==t.id))})}):e}}),ue=(0,v.Rs)("fetchDevices","user",{start:e=>Object.assign(Object.assign({},e),{devices:Object.assign(Object.assign({},e.devices),{meta:d.qV})}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{devices:{data:t.items,meta:d.YR}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{devices:{meta:(0,d.UL)(t)}})}),le=(0,v.Rs)("fetchReviewsFacts","factsFilters",{start:(e,{params:t})=>(0,_.Av)(e,t.id),success:(e,{result:t,params:s})=>(0,_.Cj)(e,s.id,t.data||[]),error:(e,{error:t,params:s})=>(0,_.VJ)(e,s.id,t)});var pe=s(85581);const he=(0,v.Rs)("setReviewLike","review",{start(e,{params:t}){const{id:s,value:r}=t,a=e[s];if(!a)return e;const i=a.data;return(0,pe.d)(i)?Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},a),{data:Object.assign(Object.assign({},i),{likes_count:ge(i.likes_count,r),additional_data:Object.assign(Object.assign({},i.additional_data),{is_liked:r})})})}):e}});function ge(e,t){return t?e+1:e>0?e-1:0}var me=s(938),fe=s(1220),be=s(6135),_e=s(8196),ye=s(95683),Ee=s(32753),Oe=s(53541),ve=s(62545),je=s(50216);const Re=[Ee.Fw,Oe.y,ve.p,je.m];var Ie=s(81305),Se=s(93095),Te=s(31504),Ae=s(9335),Ce=s(47531);const we=(0,r.UY)({entity:S,search:f,filters:function(e=T,t){switch(t.type){case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":return function(e,t){const{withFilters:s,filtersId:r}=t;return s&&r?Object.assign(Object.assign({},e),{[r]:{}}):e}(e,t.payload);case"SEARCH/FETCH_FILIALS_FILTERS":case"SEARCH/FETCH_FILTERS":return function(e,t){const{filtersId:s}=t;return s?Object.assign(Object.assign({},e),{[s]:{}}):e}(e,t.payload);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":return function(e,t,s){const r=s.filtersId;return r&&e[r]&&t&&200===t.code&&t.widgets&&t.filters?Object.assign(Object.assign({},e),{[r]:{widgets:t.widgets,filters:t.filters}}):e}(e,t.payload,t.meta);case"SEARCH/FETCH_FILTERS_SUCCESS":case"SEARCH/FETCH_FILIALS_FILTERS_SUCCESS":return function(e,t,s){const{filters:r,widgets:a}=t,i=s.filtersId;return e[i]&&a&&r?Object.assign(Object.assign({},e),{[i]:{widgets:a,filters:r}}):e}(e,t.payload,t.meta);default:return e}},region:A,searchContext:function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const r=s.searchId,a=k({items:t.items.concat(t.ads||[]),searchId:r});return Object.assign(Object.assign({},e),a)}(e,t.payload,t.meta);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const r=s.offersSearchId,a=k({items:t.items.map((e=>e.branch)),searchId:r});return Object.assign(Object.assign({},e),a)}(e,t.payload,t.meta);case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){if(200!==t.code)return e;const r=t.items[0];if(!r)return e;const a=(0,C.ub)({searchId:s.searchId,id:r.id}),i=e[a],n=U({currentContext:i,profile:r,markerStat:s.markerStat});return Object.assign(Object.assign({},e),{[a]:n})}(e,t.payload,t.meta);case"ENTITY/FETCH_BY_POINT_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const r=s.searchId,a=k({items:t.items,searchId:r});return Object.assign(Object.assign({},e),a)}(e,t.payload,t.meta);case"ENTITY/FETCH_MULTIPLE_SUCCESS":return function(e,t,s){if(0===t.items.length)return e;const r=t.items.reduce(((t,r)=>{const a=(0,C.ub)({searchId:s.searchId,id:r.id}),i=U({currentContext:e[a],profile:r});return Object.assign(Object.assign({},t),{[a]:i})}),{});return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);default:return e}},suggestion:function(e={},t){switch(t.type){case"SEARCH/FETCH_SUGGESTIONS":return function(e,t){const{searchId:s,query:r}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:r},meta:d.qV}})}(e,t.payload);case"SEARCH/FETCH_SUGGESTIONS_SUCCESS":return function(e,t,s){const{searchId:r}=s,a=e[r];if(!a)return e;if(200!==t.code||!t.items||!t.items.length)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{meta:(0,d.Mq)()})});return Object.assign(Object.assign({},e),{[r]:{data:Object.assign(Object.assign({},a.data),{items:t.items}),meta:d.YR}})}(e,t.payload,t.meta);case"SEARCH/FETCH_SUGGESTIONS_ERROR":return function(e,t,s){const{searchId:r}=s,a=e[s.searchId];if(!a)return e;return Object.assign(Object.assign({},e),{[r]:{data:a&&a.data,meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);case"SEARCH/CROP_SUGGESTION":return{};default:return e}},objectSuggestions:function(e={},t){switch(t.type){case"SEARCH/FETCH_OBJECT_SUGGESTIONS":return function(e,{payload:t}){const{searchId:s,query:r}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:r},meta:d.qV}})}(e,t);case"SEARCH/FETCH_OBJECT_SUGGESTIONS_SUCCESS":return function(e,{payload:t,meta:s}){const{searchId:r}=s,a=e[r];if(!a)return e;if(200!==t.code||!t.items||!t.items.length)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},a),{meta:(0,d.Mq)()})});return Object.assign(Object.assign({},e),{[r]:{data:Object.assign(Object.assign({},a.data),{items:t.items.map(q),searchAttributes:t.search_attributes}),meta:d.YR}})}(e,t);case"SEARCH/FETCH_OBJECT_SUGGESTIONS_ERROR":return function(e,{payload:t,meta:s}){const{searchId:r}=s,a=e[s.searchId];if(!a)return e;return Object.assign(Object.assign({},e),{[r]:{data:a&&a.data,meta:(0,d.UL)(t)}})}(e,t);case"SEARCH/CROP_SUGGESTION":return{};default:return e}},review:function(e={},t){switch(t.type){case"USER/FETCH_REVIEWS_SUCCESS":case"REVIEW/FETCH_REVIEWS_SUCCESS":return function(e,t){if(!t.items.length)return e;const s=t.items.reduce(((t,s)=>{var r;const a=null===(r=e[s.id])||void 0===r?void 0:r.data;return t[s.id]={data:Object.assign(Object.assign(Object.assign({},a),s),{object:Object.assign(Object.assign({},a&&"object"in a?null==a?void 0:a.object:void 0),s.object)}),meta:d.YR},t}),{});return Object.assign(Object.assign({},e),s)}(e,t.payload);case"USER/DELETE_REVIEW":return function(e,t){const s=e[t.id];if(!s)return e;return Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},s),{meta:Object.assign(Object.assign({},s.meta),{crud:"deleting"})})})}(e,t.payload);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t,s){if(!e[s.id])return e;const r=Object.assign({},e);return delete r[s.id],r}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_ERROR":return function(e,t,s){const r=e[s.id];if(!r)return e;return Object.assign(Object.assign({},e),{[s.id]:Object.assign(Object.assign({},r),{meta:Object.assign(Object.assign({},r.meta),{crud:void 0})})})}(e,t.payload,t.meta);default:return e}},photo:I.a,user:Y,feedback:function(e={},t){return"FEEDBACK/FETCH_USER_FEEDBACKS_SUCCESS"===t.type?function(e,t){if(!t.items)return e;const s=t.items.reduce(((e,t)=>(e[t.id]={data:t,meta:d.YR},e)),{});return Object.assign(Object.assign({},e),s)}(e,t.payload):e},seoStore:function(e=B.seoStore,t){switch(t.type){case"SEO_STORE/FETCH":return function(e){return Object.assign(Object.assign({},e),{meta:d.qV})}(e);case"SEO_STORE/FETCH_SUCCESS":return function(e,t){return Object.assign(Object.assign({},e),{data:t,meta:d.YR})}(e,t.payload);case"SEO_STORE/FETCH_ERROR":return function(e,t){return Object.assign(Object.assign({},e),{meta:(0,d.UL)(t)})}(e,t.payload);case"SEO_STORE/CLEAR_MINI_TEXT":return function(e){return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{miniText:void 0})})}(e);default:return e}},reviewSearch:function(e={},t){switch(t.type){case"REVIEW/FETCH_REVIEWS":return function(e,t){const s=e[t.searchId];return Object.assign(Object.assign({},e),{[t.searchId]:{meta:d.qV,data:s?s.data:void 0}})}(e,t.payload);case"REVIEW/FETCH_REVIEWS_SUCCESS":return function(e,t,s){const r=e[s.searchId],a=r&&r.data&&r.data.items||[],i=[...a,...t.items.map((e=>e.id))],n=t.items[t.items.length-1],o=t.items[0],c=!a.length&&o&&o.additional_data&&"pinned"===o.additional_data.pin_status?o.id:void 0,u=r&&r.data&&r.data.pinnedId?r.data.pinnedId:c;return Object.assign(Object.assign({},e),{[s.searchId]:{meta:d.YR,data:{rating:t.rating,orgRating:t.orgRating,total:t.total,totalForRequest:t.totalForRequest,offset:t.hasMore&&n?n.date_edited||n.date_created:void 0,items:i,pinnedId:u}}})}(e,t.payload,t.meta);case"REVIEW/FETCH_REVIEWS_ERROR":return function(e,t,s){const r=e[s.searchId];return Object.assign(Object.assign({},e),{[s.searchId]:Object.assign(Object.assign({},r),{meta:(0,d.UL)(t)})})}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t){if(!t.searchId)return e;const s=t.searchId,r=e[s],a=r&&r.data;if(!r||!a)return e;const i=a.total-1,n=a.items.filter((e=>e!==t.id)),o=a.pinnedId===t.id?void 0:a.pinnedId;return Object.assign(Object.assign({},e),{[t.searchId]:{meta:r.meta,data:Object.assign(Object.assign({},a),{total:i,items:n,pinnedId:o})}})}(e,t.meta);default:return e}},gta:function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){var r,a;if(!t||200!==t.code)return e;const i=s.gtaId;if(!i)return e;if((null===(r=t.ad)||void 0===r?void 0:r.gta)===e[i])return e;return Object.assign(Object.assign({},e),{[i]:null===(a=t.ad)||void 0===a?void 0:a.gta})}(e,t.payload,t.meta);default:return e}},history:z.ZP,market:$,factsInReview:function(e={},t){return"REVIEW/FETCH_REVIEWS_SUCCESS"===t.type?function(e,t){const{payload:s,meta:r}=t;if(!s.items.length)return e;const a=s.items.reduce(((e,t)=>{var s;const r=(null===(s=t.additional_data)||void 0===s?void 0:s.filtered_facts)||[];return r.length?Object.assign(Object.assign({},e),{[t.id]:r}):e}),{}),i=e[r.searchId]||{};return Object.assign(Object.assign({},e),{[r.searchId]:Object.assign(Object.assign({},i),a)})}(e,t):e},favoritesPublic:c([function(e,t){return"FAVORITES/CROP_PUBLIC_SET"===t.type?function(e,t){if(!t.ids)return e;const s=t.ids.reduce(((t,s)=>(e.objects[s]&&(t[s]=e.objects[s]),t)),{});return Object.assign(Object.assign({},e),{objects:s})}(e,t.payload):e}],B.favoritesPublic),directions:I.a,directionsPpnotTypes:I.a,traffic:I.a,factsFilters:I.a,order:I.a,deliveryOrder:I.a,reviewComments:I.a,ordersHistory:I.a,cart:I.a,contests:I.a,shortonizer:I.a,favoritesPersonal:(0,I.L)(B.favoritesPersonal),favoritesPlaces:(0,I.L)(B.favoritesPlaces),rubricator:(0,I.L)(B.rubricator),rubric:(0,I.L)(B.rubric),realty:(0,I.L)(B.realty),profile:(0,I.L)(B.profile),settlements:(0,I.L)(B.settlements),walkDistance:(0,I.L)(B.walkDistance),roadAccident:(0,I.L)(B.roadAccident)}),ke=c([we,...ne,ue,X,se,re,oe,ce,de,Q,ie,Z,J,V,W,le,he,fe.R,be.D,Ae.F,Ce.r,_e.$,ye.l,Ie.O,...me.y,...Re,Se.e,Te.q],B),Ue=c([function(e,t){switch(t.type){case"USER/SET_PARAMS":case"USER/SET_SID_USER_PARAMS":return Object.assign(Object.assign({},e),t.payload);case"USER/SET_STAT_HASH":return Object.assign(Object.assign({},e),{statHash:t.payload.statHash});case"USER/ACTIVATE_MY_GEOLOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!0,following:!0,error:void 0})});case"USER/DEACTIVATE_MY_GEOLOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!1,following:!1,error:void 0})});case"USER/ALLOW_LOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:t.payload.allow,following:!1,error:void 0})});case"USER/FOLLOW_LOCATION":return t.payload.follow===e.geolocation.following?e:Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{following:t.payload.follow})});case"USER/SET_LOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{error:void 0,position:{lon:t.payload.lonLat.lon,lat:t.payload.lonLat.lat},accuracy:t.payload.accuracy})});case"USER/LOCATION_ERROR":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!1,error:!0})});case"USER/UPDATE_ONLINE_STATUS":return t.payload.isOffline===e.isOffline?e:Object.assign(Object.assign({},e),{isOffline:t.payload.isOffline});case"USER/SET_WINDOW_SIZE":return Object.assign(Object.assign({},e),{screen:t.payload});case"USER/SET_UTM":return Object.assign(Object.assign({},e),{utm:t.payload});case"TIME/SET_DELTA":return function(e,t){const s=e.time-t.time;if(Math.abs(s)<6e4)return e;return Object.assign(Object.assign({},e),{timeDelta:s})}(e,t.payload);case"TIME/SET":return Object.assign(Object.assign({},e),{time:t.payload.time});case"TIME/SET_TIMEZONE":return function(e,t){const s=t.timezone/60,r=e.timeDelta/Ne,a=s+r;return Object.assign(Object.assign({},e),{timezone:a})}(e,t.payload);case"USER/SET_3D_MAP_ENABLED_STATUS":return Object.assign(Object.assign({},e),{is3dEnabled:t.payload.is3dEnabled});default:return e}},(0,v.KX)("setFlag",{success:(e,{result:t})=>Object.assign(Object.assign({},e),{flags:t})})],{tabId:"",sessionId:"",userId:"",platform:"online",ip:"",hostname:"",userAgent:"void",startURL:"",isIE:!1,isWindows:!1,flags:{},geolocation:{allowed:!1,following:!1},screen:{width:1200,height:600},isOffline:!1,isSearchBot:!1,isMuseum:!1,browserLang:"ru",browserLocale:void 0,time:0,timeDelta:0,is3dEnabled:!0,isMobilePromoClosed:!1,mobileAppPromoBannerShowCount:0});const Ne=36e5;function Pe(e={},t){if("async"in t&&t.async){const s=t.payload&&t.payload.statusId;return s?Object.assign(Object.assign({},e),{[s]:Le(s,t.type)}):e}if("success"in t&&t.success){const s=t.meta&&t.meta.statusId;if(!s)return e;const r=e[s];return r?Object.assign(Object.assign({},e),{[s]:He(r,d.YR)}):e}if("error"in t&&t.error){const s=t.meta&&t.meta.statusId;if(!s)return e;const r=e[s];return r?Object.assign(Object.assign({},e),{[s]:He(r,(0,d.UL)(t.payload))}):e}if("effect"in t&&t.effect){const s=t.payload.params.statusId||t.payload.uuid;if("start"===t.payload.phase)return Object.assign(Object.assign({},e),{[s]:Le(s,t.type)});const r=e[s];if(!r)return e;const a="success"===t.payload.phase?d.YR:(0,d.UL)(t.payload.error);return Object.assign(Object.assign({},e),{[s]:He(r,a)})}return e}function Le(e,t){return{id:e,type:t,meta:d.qV,__timing:{start:Date.now()}}}function He(e,t){return{id:e.id,type:e.type,meta:t,__timing:{start:e.__timing.start,end:Date.now()}}}const Fe=e=>{const t=(0,r.UY)(Object.assign({bss:o,data:ke,session:Ue,status:Pe},e));return(e,s)=>(s.reducers&&s.reducers.length&&(e=s.reducers.reduce(((e,t)=>t(e,s)),e)),"HISTORY/REPLACE_STATE"===s.type?Object.assign(Object.assign({},e),s.payload):t(e,s))};var De=s(92095),Be=s(45537);function $e(e){return t=>s=>r=>{let a=t.dispatch;const i=r[Be.ev.NAME];switch(r.type){case"INTERNAL/SIGNAL":return a(qe(r.payload.action,i));case"INTERNAL/ACTION_SEQUENCE":return function(e,t,s){return e.reduce(((e,r)=>e.then((()=>{if(r)return t(qe(r,s))}))),Promise.resolve())}(r.payload,a,i);case"INTERNAL/ACTION_PARALLEL":return function(e,t,s){return Promise.all(e.map((e=>{if(e)return t(qe(e,s))})))}(r.payload,a,i);case"INTERNAL/ACTION_WITH_STATE":return(0,De.Z)(t.getState,r.payload,(e=>e&&a(qe(e,i))))();case"INTERNAL/ACTION_WITH_CONFIG":const n=(0,r.payload)(e);return n&&a(qe(n,i));case"INTERNAL/NOOP":return;case"INTERNAL/DEFER":const o=r.payload.fn();return o?o instanceof Promise?o:a(qe(o,i)):void 0;default:return s(r)}}}function qe(e,t){return t?(e[Be.ev.NAME]=e[Be.ev.NAME]?`${t}.${e[Be.ev.NAME]}`:t,e):e}class Ge{constructor(e){this.webApi=e.webApi,this.photoApi=e.photoApi,this.reviewsApi=e.reviewsApi,this.shortonizerApi=e.shortonizerApi,this.profileApi=e.profileApi,this.videoApi=e.videoApi,this.marketApi=e.marketApi,this.feedbackApi=e.feedbackApi,this.cookieApi=e.cookieApi,this.authApi=e.authApi,this.windowApi=e.windowApi,this.aggregatorApi=e.aggregatorApi,this.dataFeedbackApi=e.dataFeedbackApi,this.feedbackStorageApi=e.feedbackStorageApi,this.seoStoreApi=e.seoStoreApi,this.credentialsApi=e.credentialsApi}}var xe=s(87325),Me=s(64301),Ye=s(25278);function ze(e){if("coordinates"===e.type){const{lon:t,lat:s}=e;return{type:"point",point:{lon:t,lat:s},id:Ye.k8,hash:(0,i._G)(Ye.k8),region_id:"0",segment_id:"0"}}const t=(0,i._J)(e.id),s=(0,i._G)(e.id);if("kilometer_road_sign"===e.type)return Object.assign(Object.assign({},e),{id:t,hash:s,segment_id:"0"});if("branch"===e.type){const r=function(e){const t=e.stop_factors;if(!t)return e.context;return Object.assign(Object.assign({},e.context),{stop_factors:t})}(e);return Object.assign(Object.assign({},e),{context:r,id:t,hash:s})}if("point"===e.type||"route"===e.type)return Object.assign(Object.assign({},e),{id:t,hash:s});if("station"===e.type&&e.platforms){const r=[];e.platforms.forEach((e=>{const t=e.geometry.centroid&&(0,Me.rx)(e.geometry.centroid);t&&r.push(t)}));const a=function(e){if(!e.length)return;const{lon:t,lat:s}=e.reduce(((e,t)=>(e.lon+=t.lon,e.lat+=t.lat,e)),{lon:0,lat:0});return{lon:(0,i.DB)(t/e.length),lat:(0,i.DB)(s/e.length)}}(r);if(a)return Object.assign(Object.assign({},e),{id:t,hash:s,point:a})}const r=e.geometry&&e.geometry.centroid;return Object.assign(Object.assign({},e),{id:t,hash:s,point:r?(0,Me.rx)(r):void 0})}function Ke(e){if(e instanceof xe.F7)return{code:500};if(200!==e.code){return{code:(0,xe.og)(e.code)}}const t=Math.ceil(e.total/ee.Cz),s=e.request_type||"recovery",r=e.search_type?e.search_type:u.Qt[s];return{code:200,items:Ve(e.items),pages:t,total:e.total,widgets:e.widgets,filters:e.filters,search_attributes:e.search_attributes,context_rubrics:e.context_rubrics,ad:e.ad,broadcast:e.broadcast,searchType:r}}function Qe(e){const{search:t,ads:s}=e,r=Ke(t);return s&&200===s.code&&s.items.length&&200===r.code?Object.assign(Object.assign({},r),{ads:Ve(s.items)}):r}function Ve(e){return e.map((e=>ze(e)))}class We extends Ge{constructor(e){super(e)}searchByQuery(e){return(0,w.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchByQuery(Object.assign(Object.assign({},e),{accessToken:t})).then((t=>{if(!t||200!==t.code)return{search:t};if(t.ads&&t.ads.length>0&&1===e.page){const s=t.ads.map((e=>e.branch_id||""));return this.webApi.getProfiles({ids:s,viewpoint:e.viewpoint,locale:e.locale}).then((e=>({search:t,ads:e}))).catch((()=>({search:t})))}return{search:t}})).then(Qe)}))}searchByRubric(e){return(0,w.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFirmByRubric(Object.assign(Object.assign({},e),{accessToken:t})).then(Ke)}))}searchByAttribute(e){return(0,w.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFirmByAttribute(Object.assign(Object.assign({},e),{accessToken:t})).then(Ke)}))}getSearchFilters(e){return this.webApi.getSearchFilters(e)}getSearchFilialsFilters(e){return this.webApi.getSearchFilialsFilters(e)}searchByBuildingId(e){return this.webApi.searchByBuildingId(e).then(Ke)}searchInBuildingByQuery(e){return this.webApi.searchInBuildingByQuery(e).then(Ke)}searchMaintainers(e){return this.webApi.searchMaintainers(e).then(Ke)}searchProviders(e){return this.webApi.searchProviders(e).then(Ke)}searchFilials(e){return(0,w.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFilials(Object.assign(Object.assign({},e),{accessToken:t})).then(Ke)}))}searchSuggestionsByQuery(e){return this.webApi.searchSuggestionsByQuery(e)}searchObjectSuggestions(e){return this.webApi.searchObjectSuggestions(e)}searchProfiles({query:e,page:t=1,viewpoint:s,locale:r}){const a=e.split(","),i=a.slice(ee.Cz*(t-1),ee.Cz*t);return this.webApi.getProfiles({ids:i,viewpoint:s,locale:r}).then((e=>(200===e.code&&(e.total=a.length),e))).then(Ke)}searchParkingsAround(e){return this.webApi.searchParkingsAround(e).then(Ke)}}function Je(e){const t={code:e.code};if(200!==e.code)return Object.assign(Object.assign({},t),{items:[]});const s=e.items[0],r=Object.assign(Object.assign({},t),{items:[ze(s)]});return"ad"in e&&(r.ad=e.ad),r}class Ze extends Ge{constructor(e){super(e),this.updateDeletedBranchInfo=(e,t)=>s=>{if(!s.items.length)return s;const r=s.items[0];if("branch"!==r.type)return s;return r.dates&&r.dates.deleted_at&&r.org&&e?this.webApi.searchFilials({viewpoint:e,orgId:r.org.id,locale:t}).then((e=>200===e.code&&e&&r.org?Object.assign(Object.assign({},s),{items:[Object.assign(Object.assign({},r),{org:Object.assign(Object.assign({},r.org),{branch_count:e.total})})]}):s)):s}}getEntityByIdNoType({id:e,hash:t,clickPoint:s,viewpoint:r,locale:a,contextRubrics:i,adsId:n}){return this.webApi.getItem({id:t?`${e}_${t}`:e,clickPoint:s,viewpoint:r,locale:a,contextRubrics:i,adsId:n}).then(Je).then(this.updateDeletedBranchInfo(r,a))}getMultipleEntities({ids:e,hash:t,viewpoint:s,locale:r}){return this.webApi.getItems({ids:t?e.map((e=>`${e}_${t}`)):e,viewpoint:s,locale:r}).then((e=>200!==e.code?{code:e.code,items:[]}:{code:200,items:e.items.map(ze)}))}getEntityByPoint(e){return this.webApi.searchByPoint(e).then((t=>{var s;if(200!==t.code)return{code:200,items:[{id:Ye.k8,region_id:e.regionId,locale:void 0,segment_id:"0",point:e.point,type:"point"}],fromPoi:!1};const r=t.items&&t.items[0],a="poi"!==r.type?null===(s=r.group)||void 0===s?void 0:s.find((e=>!!e.is_main_in_group)):void 0,i="poi"===r.type?r.reference.id:a&&a.id||r.id;return this.getEntityByIdNoType({id:i,clickPoint:e.point,viewpoint:e.viewpoint,locale:e.locale,contextRubrics:[]}).then((e=>Object.assign(Object.assign({},e),{fromPoi:"poi"===r.type})))}))}}class Xe extends Ge{constructor(e){super(e)}uploadPhoto(e){return(0,w.mG)(this,void 0,void 0,(function*(){const{objectId:t,objectType:s,temporaryId:r,file:a,locale:i,regionId:n,albumCode:o,isReplaced:c,isMenuPhoto:d}=e,u=yield this.credentialsApi.getToken();if(!u)throw new Error("User is not authorized");const l=(yield this.photoApi.addPhoto({uid:r,objectId:t,objectType:s,albumCode:o,locale:i,regionId:n,accessToken:u,isReplaced:c,isMenuPhoto:d})).items[0];if(!l.hash||!l.id||l.error)throw{name:l.error&&l.error.type,message:l.error&&l.error.message};return this.photoApi.uploadPhoto({id:l.id,hash:l.hash,file:a,accessToken:u,objectType:s})}))}}class et extends Ge{constructor(e){super(e)}getEntityReviews(e){return(0,w.mG)(this,void 0,void 0,(function*(){const{id:t,type:s,isAdvertiser:r,offset:a,withAnswer:i,ratings:n,unconfirmed:o,facts:c,newtworkTimeout:d,locale:u}=e,l=yield this.credentialsApi.getToken();switch(s){case"branch":return this.reviewsApi.getBranchReviews({id:t,type:s,isAdvertiser:r,offset:a,withAnswer:i,ratings:n,accessToken:l,unconfirmed:o,facts:c,newtworkTimeout:d,locale:u||""});case"geo":if(o)throw new Error("no unconfirmed reviews on geo");return this.reviewsApi.getGeoReviews({id:t,type:s,offset:a,ratings:n,accessToken:l,newtworkTimeout:d,locale:u||""});case"org":return this.reviewsApi.getOrgReviews({id:t,type:s,offset:a,withAnswer:i,ratings:n,accessToken:l,unconfirmed:o,facts:c,newtworkTimeout:d,locale:u||""})}}))}getUserReviews(e){return(0,w.mG)(this,void 0,void 0,(function*(){const{userId:t,locale:s,offset:r}=e,a=yield this.credentialsApi.getToken();if(!a)throw new Error("User is not authorized");return this.reviewsApi.getUserReviews({userId:t,accessToken:a,locale:s,offset:r})}))}deleteReview(e){return(0,w.mG)(this,void 0,void 0,(function*(){const{id:t,locale:s}=e,r=yield this.credentialsApi.getToken();if(!r)throw new Error("User is not authorized");return this.reviewsApi.deleteReview({id:t,accessToken:r,locale:s||""})}))}}class tt extends Ge{constructor(e){super(e)}getRegionById(e){return this.webApi.getRegionById(e)}getRegionsList(e){return this.webApi.getRegionsList(e)}detectRegion(e){return this.webApi.detectRegion(e)}}class st extends Ge{constructor(e){super(e)}clearSearchHistory(e){return this.profileApi.clearSearchHistory(e)}}class rt extends Ge{constructor(e){super(e)}getVideoData(e){return this.videoApi.getVideoData(e.videoUrl)}}class at extends Ge{constructor(e){super(e)}confirmRegistration({email:e,clientId:t}){return(0,w.mG)(this,void 0,void 0,(function*(){const s=yield this.credentialsApi.getToken();if(!s)throw new Error("User is not authorized");return this.authApi.updateEmail({accessToken:s,email:e,authClientId:t}).then((()=>{}))}))}}class it extends Ge{constructor(e){super(e)}sendFeedback(e){return(0,w.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return yield this.feedbackApi.sendFeedback(Object.assign(Object.assign({},e),{accessToken:t}))}))}sendReviewFeedback(e){return(0,w.mG)(this,void 0,void 0,(function*(){const{reviewId:t,text:s,locale:r}=e,a=yield this.credentialsApi.getToken();if(!a)throw new Error("User is not authorized");return yield this.reviewsApi.sendReviewComplaint({id:t,text:s,accessToken:a,locale:r||""})}))}getUserFeedbacks(e){return(0,w.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();if(!t)throw new Error("User is not authorized");return yield this.dataFeedbackApi.getUserFeedbacks(Object.assign(Object.assign({},e),{accessToken:t}))}))}getUserFeedbacksCount(){return(0,w.mG)(this,void 0,void 0,(function*(){const e=yield this.credentialsApi.getToken();if(!e)throw new Error("User is not authorized");return yield this.dataFeedbackApi.getUserFeedbacksCount({accessToken:e})}))}sendTypedFeedback(e){return(0,w.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.dataFeedbackApi.sendFeedback(Object.assign(Object.assign({},e),{userToken:t}))}))}getAnonymousFeedbacksCount(){return(0,w.mG)(this,void 0,void 0,(function*(){return this.feedbackStorageApi.get("count")}))}setAnonymousFeedbacksCount(e){return(0,w.mG)(this,void 0,void 0,(function*(){return this.feedbackStorageApi.set("count",e.toString())}))}}class nt extends Ge{constructor(e){super(e)}createShortLink(e){return this.shortonizerApi.createShortLink(e.url)}}class ot extends Ge{constructor(e){super(e)}updateEmail(e){return(0,w.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();if(!t)throw new Error("No access token");return this.aggregatorApi.updateEmail(Object.assign(Object.assign({},e),{accessToken:t}))}))}}function ct(e){const t=Math.ceil(e.total/ee.LF);return Object.assign(Object.assign({},e),{pages:t})}function dt(e){const t=Math.ceil(e.total/ee.Kt);return Object.assign(Object.assign({},e),{pages:t})}function ut(e){const t=Math.ceil(e.total/ee.Kt);return Object.assign(Object.assign({},e),{pages:t})}class lt extends Ge{constructor(e){super(e)}searchProductsById(e){return this.marketApi.searchProductsById(e).then(ct)}searchBranchProducts(e){return this.marketApi.searchBranchProducts(e).then(dt)}getBranchCategoriesAndProducts(e){return this.marketApi.getBranchCategoriesAndProducts(e).then(dt)}getOffers(e){return this.marketApi.getOffers(e).then(ut)}getSuggestions(e){return this.marketApi.getSuggestions(e)}}class pt extends Ge{constructor(e){super(e)}getSeoParams(e){return this.seoStoreApi?this.seoStoreApi.getSeoParams(e):Promise.resolve({})}}var ht=s(25310);class gt extends Ge{constructor(e){super(e),this.localStorage=new ht.r("history","history")}saveSearchHistory(e){return this.localStorage.set(e.userId,e.history)}loadSearchHistory(e){return this.localStorage.get(e.userId)}clearSearchHistory(){return this.localStorage.clear()}}function mt(e){return{search:new We(e),market:new lt(e),entity:new Ze(e),photos:new Xe(e),reviews:new et(e),region:new tt(e),profile:new st(e),video:new rt(e),auth:new at(e),feedback:new it(e),shortonizer:new nt(e),aggregator:new ot(e),seoStore:new pt(e),history:new gt(e)}}function ft({entity:e,reviews:t,video:s}){return r=>{switch(r.type){case"ENTITY/FETCH_PROFILE_NO_TYPE":return e.getEntityByIdNoType(r.payload);case"ENTITY/FETCH_MULTIPLE":return e.getMultipleEntities(r.payload);case"ENTITY/FETCH_BY_POINT":return e.getEntityByPoint(r.payload);case"USER/DELETE_REVIEW":return t.deleteReview(r.payload);case"ENTITY/FETCH_VIDEO_DATA":return s.getVideoData(r.payload);default:return}}}function bt({search:e}){return t=>{switch(t.type){case"SEARCH/FETCH_FILIALS":return e.searchFilials(t.payload);case"SEARCH/FETCH_FILIALS_FILTERS":return e.getSearchFilialsFilters(t.payload);default:return}}}function _t({search:e}){return t=>{switch(t.type){case"SEARCH/FETCH_QUERY":return e.searchByQuery(t.payload);case"SEARCH/FETCH_RUBRIC":return e.searchByRubric(t.payload);case"SEARCH/FETCH_ATTRIBUTE":return e.searchByAttribute(t.payload);case"SEARCH/FETCH_FILTERS":return e.getSearchFilters(t.payload);default:return}}}function yt({search:e}){return t=>{if("SEARCH/FETCH_SUGGESTIONS"===t.type)return e.searchSuggestionsByQuery(t.payload)}}function Et({search:e}){return t=>{if("SEARCH/FETCH_OBJECT_SUGGESTIONS"===t.type)return e.searchObjectSuggestions(t.payload)}}function Ot({search:e}){return t=>{switch(t.type){case"SEARCH/BY_BUILDING_ID":return e.searchByBuildingId(t.payload);case"SEARCH/IN_BUILDING_BY_QUERY":return e.searchInBuildingByQuery(t.payload);case"SEARCH/FETCH_MAINTAINERS":return e.searchMaintainers(t.payload);case"SEARCH/FETCH_PROVIDERS":return e.searchProviders(t.payload);default:return}}}function vt({search:e}){return t=>{if("SEARCH/FETCH_PARKINGS_AROUND"===t.type)return e.searchParkingsAround(t.payload)}}function jt(e){const t=[bt,_t,Ot,yt,Et,vt].map((t=>t(e)));return e=>{for(const s of t){const t=s(e);if(t)return t}}}function Rt({market:e}){return t=>{switch(t.type){case"MARKET/FETCH_PRODUCT_BY_ID":return e.searchProductsById(t.payload);case"MARKET/FETCH_CATEGORIES_BY_BRANCH":return e.getBranchCategoriesAndProducts(t.payload);case"MARKET/FETCH_BRANCH_PRODUCTS":return e.searchBranchProducts(t.payload);case"MARKET/FETCH_OFFERS":return e.getOffers(t.payload);case"MARKET/FETCH_SUGGESTIONS":return e.getSuggestions(t.payload);default:return}}}function It({region:e}){return t=>{switch(t.type){case"REGION/FETCH_LIST":return e.getRegionsList(t.payload);case"REGION/FETCH":return e.getRegionById(t.payload);case"REGION/DETECT":return e.detectRegion(t.payload);default:return}}}function St({profile:e}){return t=>{if("SEARCH_HISTORY/CLEAR_SEARCH_HISTORY"===t.type)return e.clearSearchHistory(t.payload)}}function Tt({auth:e,reviews:t,history:s}){return r=>{switch(r.type){case"USER/CONFIRM_REGISTRATION":return e.confirmRegistration(r.payload);case"USER/FETCH_REVIEWS":return t.getUserReviews(r.payload);case"USER/DELETE_REVIEW":return t.deleteReview(r.payload);case"USER/SAVE_HISTORY":return s.saveSearchHistory(r.payload);case"USER/LOAD_HISTORY":return s.loadSearchHistory(r.payload);case"USER/CLEAR_HISTORY":return s.clearSearchHistory();default:return}}}function At({feedback:e}){return t=>{switch(t.type){case"FEEDBACK/SEND":case"FEEDBACK/PHOTO_COMPLAINT":return e.sendFeedback(t.payload.data);case"FEEDBACK/REVIEW_COMPLAINT":return e.sendReviewFeedback(t.payload);case"FEEDBACK/SEND_TYPED":return e.sendTypedFeedback(t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS":return e.getUserFeedbacks(t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT":return e.getUserFeedbacksCount();case"FEEDBACK/GET_ANOMYMOUS_FEEDBACKS_COUNT":return e.getAnonymousFeedbacksCount();case"FEEDBACK/SET_ANOMYMOUS_FEEDBACKS_COUNT":return e.setAnonymousFeedbacksCount(t.payload.feedbacksCount);default:return}}}function Ct({aggregator:e}){return t=>{if("USER/UPDATE_EMAIL"===t.type)return e.updateEmail(t.payload)}}function wt({seoStore:e}){return t=>{if("SEO_STORE/FETCH"===t.type)return e.getSeoParams(t.payload)}}function kt({reviews:e}){return t=>{if("REVIEW/FETCH_REVIEWS"===t.type)return e.getEntityReviews(t.payload)}}function Ut(e){const t=[Tt,ft,jt,Rt,It,St,At,Ct,wt,kt].map((t=>t(e)));return e=>{for(const s of t){const t=s(e);if(t)return t}return(0,a.H)({message:`service cannot be defined for action - ${e.type}`,id:"os136",level:"error",payload:{type:"debug",subtype:"NoAsyncActionHandler"}}),Promise.reject(new Error(`Handler for "${e.type}" is undefined`))}}var Nt=s(68671),Pt=s(60068);function Lt(e,t,s){const r=(0,De.Z)(mt,Ut)(e);return e=>a=>n=>{if(!n.async)return a(n);let o="object"==typeof n.payload?Object.assign(Object.assign({},n),{payload:Ht(n.payload)}):n;s&&(o=Ft(o,s(e.getState()))),a(o);const c=e.getState(),{payload:d,type:u}=o;return c.session.isOffline?e.dispatch({payload:{name:"OfflineError",message:"No network"},type:`${u}_ERROR`,meta:d,error:!0}):r(o).then((s=>{if(!Nt.sk&&t.captchaUrl&&(r=s,(0,i.Kn)(r)&&"code"in r&&307===r.code)){const s=`${t.captchaUrl}form?return_url=${window.location.href}`;return e.dispatch((0,Pt.k)({url:s,name:"_self"}))}var r;return e.dispatch({payload:s,meta:d,type:`${u}_SUCCESS`,success:!0})}),(t=>e.dispatch({payload:t,meta:d,type:`${u}_ERROR`,error:!0})))}}function Ht(e){return e.statusId?e:Object.assign({},e,{statusId:(0,i.by)()})}function Ft(e,t){if(!t||!(0,i.Kn)(t))return e;const s="payload"in e&&e.payload,r={};return(0,i.Ed)(t,((e,t)=>{s&&t in s||void 0===e||(r[t]=e)})),0===Object.keys(r).length?e:Object.assign(Object.assign({},e),{payload:Object.assign(Object.assign({},e.payload),r)})}var Dt=s(27144);function Bt({windowApi:e}){return()=>t=>s=>{switch(s.type){case"HISTORY/PUSH":return e.historyPush(s.payload.state,s.payload.url),t(s);case"HISTORY/REPLACE":return void e.historyReplace(s.payload.state,s.payload.url);case"HISTORY/BACK":return void e.historyBack();default:return t(s)}}}function $t({windowApi:e}){return()=>t=>s=>{switch(s.type){case"APP/OPEN_URL":if(e.location&&s.payload.name&&"_self"===s.payload.name){const t="/"===s.payload.url?e.location.host:s.payload.url;if(t.startsWith("/")&&-1===t.indexOf("//"))return void(window.location.href=t);e.location.href=t.startsWith("http")?t:`${e.location.protocol}//${t}`}else e.open(s.payload.url,s.payload.name,s.payload.specs);return;case"APP/RELOAD":return void e.reload(s.payload.forcedReload);default:return t(s)}}}var qt,Gt=s(64841),xt=s(30774);qt||(qt={});const{emitEvent:Mt}=(0,xt.U)();function Yt(){let e;return t=>s=>r=>{switch(r.type){case"USER/ACTIVATE_MY_GEOLOCATION":return function({onUpdate:t,onError:s}){if(e)return;if("undefined"==typeof window||!window.navigator||!window.navigator.geolocation)return s("API_UNAVAILABLE");Gt.tO.local.setItem("geolocationAllowed","true"),e=window.navigator.geolocation.watchPosition((e=>t(e)),(e=>s(function(e){switch(e.code){case e.PERMISSION_DENIED:return"PERMISSION_DENIED";case e.POSITION_UNAVAILABLE:return"POSITION_UNAVAILABLE";case e.TIMEOUT:return"TIMEOUT";default:return}}(e))),{enableHighAccuracy:!0})}({onUpdate(e){t.dispatch(Mt({type:"myGeolocation:update",event:e}))},onError(e){t.dispatch(Mt({type:"myGeolocation:error",event:e}))}}),s(r);case"USER/DEACTIVATE_MY_GEOLOCATION":return function(){e&&(window.navigator.geolocation.clearWatch(e),e=void 0);Gt.tO.local.removeItem("geolocationAllowed")}(),s(r);default:return s(r)}}}function zt({analyticsApi:e}){return()=>t=>s=>{switch(s.type){case"ANALYTICS/TRACK_GOOGLE":return void e.trackGoogleEvent(...s.payload);case"ANALYTICS/PAGEVIEW":return void e.trackPageview();case"ANALYTICS/SET_CONSENT_GRANTED":return void e.setGoogleConsentGranted();case"ANALYTICS/CHANGE_PROJECT_ID":return void e.changeGoogleProjectId(s.payload.projectId);default:return t(s)}}}new class{constructor(){this.actions=[],this.signals=[],this.allRawActions=[]}setAction(e){this.actions.push(e)}setSignal(e){this.signals.push(e)}getSignals(){return this.signals}getAll(){return this.actions}getAllRaw(){return this.allRawActions}findAction(e){return this.actions.find((t=>t.type===e))}findSignal(e){return this.signals.find((t=>t.payload.name===e))}findSignalIntree(e){return this.signals.find((t=>t[Be.ev.NAME]===e))}getTree(){return this.actions.reduce(((e,t)=>{let s=e;if(t[Be.ev.NAME]){const e=t[Be.ev.NAME],r=e.split(".");for(const t of r){let r=s.find((e=>e.type===t));if(!r){const a=this.findSignalIntree(e);r=a?{type:t,children:[],payload:a.payload}:{type:t,children:[]},s.push(r)}s=r.children}}return s.push({type:t.type,payload:t.payload}),e}),[])}reset(){this.actions=[],this.allRawActions=[],this.signals=[]}trackAction(e){this.allRawActions.push(e)}};var Kt=s(53806);function Qt(e){const{services:t,asyncExtraPayload:s}=e;return e=>{const r=function(e){const{asyncExtraPayload:t,getState:s}=e;return{get:e=>{if(!t)return;const r=t(s());return r?r[e]:void 0}}}({asyncExtraPayload:s,getState:e.getState});let a=e.dispatch;return e=>s=>(0,Kt.ly)(s)?(e(s),s.payload.handler(s.payload.params)(Object.assign(Object.assign({},t),{contextApi:r})).then((e=>{a((0,Kt.go)(s,e))})).catch((e=>{a((0,Kt.Co)(s,e))}))):e(s)}}function Vt(e){const{extraReducers:t,enhancers:s,initialState:a,config:i,uiMiddlewares:n,mwWithServices:o,asyncExtraPayload:c,apiServices:d}=e;return function({initialState:e,beforeMiddlewares:t=[],extraMiddlewares:s,enhancers:a,extraReducers:i,apiServices:n,config:o,mwWithServices:c=[],asyncExtraPayload:d}){const u=[...t,(0,Dt.n)(),$e(o),Qt({services:n,asyncExtraPayload:d}),Lt(n,o,d),Yt(),Bt(n),$t(n),zt(n),...s].concat(c.map((e=>e(n)))),l=(0,r.md)(...u);"godmode"in o&&o.godmode&&"object"==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&a.push(window.__REDUX_DEVTOOLS_EXTENSION__());const p=(0,r.qC)(l,...a),h=Fe(i);return e?(0,r.MT)(h,e,p):(0,r.MT)(h,p)}({extraMiddlewares:[...n],extraReducers:t,enhancers:s,initialState:a,apiServices:d,config:i,mwWithServices:o,asyncExtraPayload:c})}},35367:(e,t,s)=>{s.d(t,{vT:()=>a,NY:()=>r});const r={read_only:"boolean",system_is_deleted:"boolean",is_owned:"boolean",is_deleted:"boolean",is_shared:"boolean",is_visible_on_map:"boolean",is_default:"boolean",order:"number",project_id:"array",collections:"array",point:"lonlat",source_point:"lonlat",user_info:"object"},a=["adm_div","parking","gate","street","road","point"]},85388:(e,t,s)=>{function r(e){return e&&"number"==typeof e.lon&&"number"==typeof e.lat}s.d(t,{S:()=>r})},35006:(e,t,s)=>{s.d(t,{m:()=>r});const r=["camera","camera-20","camera-30","camera-40","camera-50","camera-60","camera-70","camera-80","camera-90","camera-100","camera-110","camera-120","camera-130","camera-140","camera-tl","camera-bus","camera-line","camera-parking"]},71372:(e,t,s)=>{s.d(t,{R:()=>a});var r=s(34291);const a=(e,t,s)=>function(e,t){return(s,r)=>{const a=s[e],i=t(a,r);return a===i?s:Object.assign(Object.assign({},s),{[e]:i})}}(t,(0,r.KX)(e,s))},56264:(e,t,s)=>{s.d(t,{q:()=>r});const r=e=>{const t=null==e?void 0:e.reduce(((e,t)=>"rubric"===t.table_name?[...e,t.record_id]:t.dgis_rubrics.length?[...e,...t.dgis_rubrics]:e),[]);return(null==t?void 0:t.length)?[...new Set(t)]:void 0}},3849:(e,t,s)=>{s.d(t,{_p:()=>n,gU:()=>i,qr:()=>a});var r=s(83466);const a=["#E2658B","#198700","#4F92F8","#E7750B","#738AB3","#7435D2","#DBAF00","#00B305","#00A989","#9E578A","#BA6612","#1D66EE","#F83A3A"],i="#E7750B";function n(e,t){try{if(!e)throw new Error;if(t&&a.includes(t))return t;const s=e.replace(/-/g,"").split("").reduce(((e,t,s,r)=>(s%2!=0&&e.push(`${r[s-1]}${t}`),e)),[]).reverse(),r=Number((BigInt("0x"+s.slice(0,8).join(""))^BigInt("0x"+s.slice(8).join("")))%BigInt(a.length));return a[r]}catch(e){return(0,r.H)({message:"Пришел неизвестный цвет или нет uuid!",level:"warn",id:"v3gh3",payload:{type:"exception",subtype:"getFavoriteColorError",stack:e instanceof Error?e.stack:void 0}}),i}}},8211:(e,t,s)=>{s.d(t,{A:()=>r});const r=e=>{const t=[];return null==e||e.forEach((({table_name:e,group:s,record_id:r,dgis_rubrics:a})=>{"rubric"!==e||void 0!==s&&0!==s||t.push(r),!a.length||void 0!==s&&0!==s||a.forEach((e=>{t.push(e)}))})),(null==t?void 0:t.length)?t:void 0}},55123:(e,t,s)=>{function r(e){return!(!e||!e.options)&&!!e.options.fmcg_owner}s.d(t,{G:()=>r})},96683:(e,t,s)=>{s.d(t,{L:()=>a,a:()=>r});const r=(e={})=>e,a=e=>(t=e)=>t}}]);